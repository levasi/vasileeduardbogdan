import{s as Sr,T as ko,S as bt,P as De,R as Do,W as Bt,N as jr,t as No,n as kr,q as Bo,C as Ee,u as He,O as Uo,v as pt,w as zo,x as Dr,y as Fo,h as ve,V as Z,z as Lo,M as Nr,J as Ht,a as Ze,K as Vt,Q as Vo,k as Yo,U as Go,X as Br,i as Mt,Y as Ho,Z as Rn,_ as $o,$ as Wo,a0 as Ur,a1 as wt,a2 as zr,a3 as $e,a4 as qo,a5 as Ko,a6 as Fr,B as Zo,a7 as Xo,a8 as Jo,a9 as gt,aa as Qt,ab as Lr,ac as vn,ad as Qo,ae as Hn,af as dt,ag as ht,ah as en,j as ea,ai as ta,aj as na,ak as ra,al as oa,am as aa,an as ia,ao as Fe,ap as Ye,aq as sa,ar as $n,as as Wn,at as la,au as ua,av as ca,aw as fa,ax as pa,ay as da,az as ha,aA as Vr}from"./DdUGlUBh.js";import{E as Yr,G as Gr,H as me,r as ge,I as be,J as ne,K as $t,k as Cn,n as ma,L as Tt,M as ga,N as xt,h as Hr,i as $r,l as ye,O as _t,P as Qe,p as q,Q as va,R as Xe,U as Sn,c as Se,V as We,o as Ie,W as ya,X as ba,Y as wa,Z as qn,$ as Ut,F as xa,a0 as Wr,a1 as _a,q as Yt,B as qr,a as jn,a2 as Kr,b as Rt,a3 as Ma,w as Ta,d as Ea}from"./CIZhVwNQ.js";function qe(t){return Yr()?(Gr(t),!0):!1}function Re(){const t=new Set,e=a=>{t.delete(a)};return{on:a=>{t.add(a);const s=()=>e(a);return qe(s),{off:s}},off:e,trigger:(...a)=>Promise.all(Array.from(t).map(s=>s(...a))),clear:()=>{t.clear()}}}const tn=new WeakMap,Aa=(...t)=>{var e;const r=t[0],n=(e=xt())==null?void 0:e.proxy;if(n==null&&!Hr())throw new Error("injectLocal must be called in setup");return n&&tn.has(n)&&r in tn.get(n)?tn.get(n)[r]:$r(...t)},yn=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Ia=t=>t!=null,Pa=Object.prototype.toString,Oa=t=>Pa.call(t)==="[object Object]",bn=()=>{};function Ra(t,e){function r(...n){return new Promise((o,a)=>{Promise.resolve(t(()=>e.apply(this,n),{fn:e,thisArg:this,args:n})).then(o).catch(a)})}return r}function Ca(t,e={}){let r,n,o=bn;const a=d=>{clearTimeout(d),o(),o=bn};let s;return d=>{const f=me(t),v=me(e.maxWait);return r&&a(r),f<=0||v!==void 0&&v<=0?(n&&(a(n),n=null),Promise.resolve(d())):new Promise((x,w)=>{o=e.rejectOnCancel?w:x,s=d,v&&!n&&(n=setTimeout(()=>{r&&a(r),n=null,x(s())},v)),r=setTimeout(()=>{n&&a(n),n=null,x(d())},f)})}}function Kn(t){return t.endsWith("rem")?Number.parseFloat(t)*16:Number.parseFloat(t)}function Sa(t,e,r=!1){return e.reduce((n,o)=>(o in t&&(!r||t[o]!==void 0)&&(n[o]=t[o]),n),{})}function ja(t){return xt()}function vt(t){return Array.isArray(t)?t:[t]}function ka(t,e=200,r={}){return Ra(Ca(e,r),t)}function Zn(t,e=200,r={}){const n=ge(t.value),o=ka(()=>{n.value=t.value},e,r);return be(t,()=>o()),n}function Da(t,e={}){if(!$t(t))return Tt(t);const r=Array.isArray(t.value)?Array.from({length:t.value.length}):{};for(const n in t.value)r[n]=ga(()=>({get(){return t.value[n]},set(o){var a;if((a=me(e.replaceRef))!=null?a:!0)if(Array.isArray(t.value)){const i=[...t.value];i[n]=o,t.value=i}else{const i={...t.value,[n]:o};Object.setPrototypeOf(i,Object.getPrototypeOf(t.value)),t.value=i}else t.value[n]=o}}));return r}const xe=me;function kn(t,e=!0,r){ja()?Cn(t,r):e?t():ma(t)}function Na(t,e=1e3,r={}){const{immediate:n=!0,immediateCallback:o=!1}=r;let a=null;const s=ne(!1);function i(){a&&(clearInterval(a),a=null)}function d(){s.value=!1,i()}function f(){const v=me(e);v<=0||(s.value=!0,o&&t(),i(),s.value&&(a=setInterval(t,v)))}if(n&&yn&&f(),$t(e)||typeof e=="function"){const v=be(e,()=>{s.value&&yn&&f()});qe(v)}return qe(d),{isActive:s,pause:d,resume:f}}function Zr(t,e,r){return be(t,e,{...r,immediate:!0})}const Le=yn?window:void 0;function je(t){var e;const r=me(t);return(e=r?.$el)!=null?e:r}function Je(...t){const e=[],r=()=>{e.forEach(i=>i()),e.length=0},n=(i,d,f,v)=>(i.addEventListener(d,f,v),()=>i.removeEventListener(d,f,v)),o=ye(()=>{const i=vt(me(t[0])).filter(d=>d!=null);return i.every(d=>typeof d!="string")?i:void 0}),a=Zr(()=>{var i,d;return[(d=(i=o.value)==null?void 0:i.map(f=>je(f)))!=null?d:[Le].filter(f=>f!=null),vt(me(o.value?t[1]:t[0])),vt(q(o.value?t[2]:t[1])),me(o.value?t[3]:t[2])]},([i,d,f,v])=>{if(r(),!i?.length||!d?.length||!f?.length)return;const x=Oa(v)?{...v}:v;e.push(...i.flatMap(w=>d.flatMap(E=>f.map(g=>n(w,E,g,x)))))},{flush:"post"}),s=()=>{a(),r()};return qe(r),s}function Ba(){const t=ne(!1),e=xt();return e&&Cn(()=>{t.value=!0},e),t}function Wt(t){const e=Ba();return ye(()=>(e.value,!!t()))}function Ua(t,e,r={}){const{window:n=Le,...o}=r;let a;const s=Wt(()=>n&&"MutationObserver"in n),i=()=>{a&&(a.disconnect(),a=void 0)},d=ye(()=>{const w=me(t),E=vt(w).map(je).filter(Ia);return new Set(E)}),f=be(()=>d.value,w=>{i(),s.value&&w.size&&(a=new MutationObserver(e),w.forEach(E=>a.observe(E,o)))},{immediate:!0,flush:"post"}),v=()=>a?.takeRecords(),x=()=>{f(),i()};return qe(x),{isSupported:s,stop:x,takeRecords:v}}function Dn(t,e={}){const{immediate:r=!0,fpsLimit:n=void 0,window:o=Le,once:a=!1}=e,s=ne(!1),i=ye(()=>n?1e3/me(n):null);let d=0,f=null;function v(E){if(!s.value||!o)return;d||(d=E);const g=E-d;if(i.value&&g<i.value){f=o.requestAnimationFrame(v);return}if(d=E,t({delta:g,timestamp:E}),a){s.value=!1,f=null;return}f=o.requestAnimationFrame(v)}function x(){!s.value&&o&&(s.value=!0,d=0,f=o.requestAnimationFrame(v))}function w(){s.value=!1,f!=null&&o&&(o.cancelAnimationFrame(f),f=null)}return r&&x(),qe(w),{isActive:_t(s),pause:w,resume:x}}const za=Symbol("vueuse-ssr-width");function Fa(){const t=Hr()?Aa(za,null):null;return typeof t=="number"?t:void 0}function Xr(t,e={}){const{window:r=Le,ssrWidth:n=Fa()}=e,o=Wt(()=>r&&"matchMedia"in r&&typeof r.matchMedia=="function"),a=ne(typeof n=="number"),s=ne(),i=ne(!1),d=f=>{i.value=f.matches};return Qe(()=>{if(a.value){a.value=!o.value;const f=me(t).split(",");i.value=f.some(v=>{const x=v.includes("not all"),w=v.match(/\(\s*min-width:\s*(-?\d+(?:\.\d*)?[a-z]+\s*)\)/),E=v.match(/\(\s*max-width:\s*(-?\d+(?:\.\d*)?[a-z]+\s*)\)/);let g=!!(w||E);return w&&g&&(g=n>=Kn(w[1])),E&&g&&(g=n<=Kn(E[1])),x?!g:g});return}o.value&&(s.value=r.matchMedia(me(t)),i.value=s.value.matches)}),Je(s,"change",d,{passive:!0}),ye(()=>i.value)}function La(t={}){const{window:e=Le}=t,r=ne(1),n=Xr(()=>`(resolution: ${r.value}dppx)`,t);let o=bn;return e&&(o=Zr(n,()=>r.value=e.devicePixelRatio)),{pixelRatio:_t(r),stop:o}}function Jr(t,e,r={}){const{window:n=Le,...o}=r;let a;const s=Wt(()=>n&&"ResizeObserver"in n),i=()=>{a&&(a.disconnect(),a=void 0)},d=ye(()=>{const x=me(t);return Array.isArray(x)?x.map(w=>je(w)):[je(x)]}),f=be(d,x=>{if(i(),s.value&&n){a=new ResizeObserver(e);for(const w of x)w&&a.observe(w,o)}},{immediate:!0,flush:"post"}),v=()=>{i(),f()};return qe(v),{isSupported:s,stop:v}}function Va(t,e={}){const{reset:r=!0,windowResize:n=!0,windowScroll:o=!0,immediate:a=!0,updateTiming:s="sync"}=e,i=ne(0),d=ne(0),f=ne(0),v=ne(0),x=ne(0),w=ne(0),E=ne(0),g=ne(0);function M(){const R=je(t);if(!R){r&&(i.value=0,d.value=0,f.value=0,v.value=0,x.value=0,w.value=0,E.value=0,g.value=0);return}const P=R.getBoundingClientRect();i.value=P.height,d.value=P.bottom,f.value=P.left,v.value=P.right,x.value=P.top,w.value=P.width,E.value=P.x,g.value=P.y}function m(){s==="sync"?M():s==="next-frame"&&requestAnimationFrame(()=>M())}return Jr(t,m),be(()=>je(t),R=>!R&&m()),Ua(t,m,{attributeFilter:["style","class"]}),o&&Je("scroll",m,{capture:!0,passive:!0}),n&&Je("resize",m,{passive:!0}),kn(()=>{a&&m()}),{height:i,bottom:d,left:f,right:v,top:x,width:w,x:E,y:g,update:m}}function Ya(t,e={width:0,height:0},r={}){const{window:n=Le,box:o="content-box"}=r,a=ye(()=>{var x,w;return(w=(x=je(t))==null?void 0:x.namespaceURI)==null?void 0:w.includes("svg")}),s=ne(e.width),i=ne(e.height),{stop:d}=Jr(t,([x])=>{const w=o==="border-box"?x.borderBoxSize:o==="content-box"?x.contentBoxSize:x.devicePixelContentBoxSize;if(n&&a.value){const E=je(t);if(E){const g=E.getBoundingClientRect();s.value=g.width,i.value=g.height}}else if(w){const E=vt(w);s.value=E.reduce((g,{inlineSize:M})=>g+M,0),i.value=E.reduce((g,{blockSize:M})=>g+M,0)}else s.value=x.contentRect.width,i.value=x.contentRect.height},r);kn(()=>{const x=je(t);x&&(s.value="offsetWidth"in x?x.offsetWidth:e.width,i.value="offsetHeight"in x?x.offsetHeight:e.height)});const f=be(()=>je(t),x=>{s.value=x?e.width:0,i.value=x?e.height:0});function v(){d(),f()}return{width:s,height:i,stop:v}}function Ga(t){var e;const r=ne(0);if(typeof performance>"u")return r;const n=(e=t?.every)!=null?e:10;let o=performance.now(),a=0;return Dn(()=>{if(a+=1,a>=n){const s=performance.now(),i=s-o;r.value=Math.round(1e3/(i/a)),o=s,a=0}}),r}function Ha(t={}){const e=ge(),r=Wt(()=>typeof performance<"u"&&"memory"in performance);if(r.value){const{interval:n=1e3}=t;Na(()=>{e.value=performance.memory},n,{immediate:t.immediate,immediateCallback:t.immediateCallback})}return{isSupported:r,memory:e}}const Qr={x:0,y:0,pointerId:0,pressure:0,tiltX:0,tiltY:0,width:0,height:0,twist:0,pointerType:null},$a=Object.keys(Qr);function Wa(t={}){const{target:e=Le}=t,r=ne(!1),n=ge(t.initialValue||{});Object.assign(n.value,Qr,n.value);const o=a=>{r.value=!0,!(t.pointerTypes&&!t.pointerTypes.includes(a.pointerType))&&(n.value=Sa(a,$a,!1))};if(e){const a={passive:!0};Je(e,["pointerdown","pointermove","pointerup"],o,a),Je(e,"pointerleave",()=>r.value=!1,a)}return{...Da(n),isInside:r}}function qa(t={}){const{window:e=Le,initialWidth:r=Number.POSITIVE_INFINITY,initialHeight:n=Number.POSITIVE_INFINITY,listenOrientation:o=!0,includeScrollbar:a=!0,type:s="inner"}=t,i=ne(r),d=ne(n),f=()=>{if(e)if(s==="outer")i.value=e.outerWidth,d.value=e.outerHeight;else if(s==="visual"&&e.visualViewport){const{width:x,height:w,scale:E}=e.visualViewport;i.value=Math.round(x*E),d.value=Math.round(w*E)}else a?(i.value=e.innerWidth,d.value=e.innerHeight):(i.value=e.document.documentElement.clientWidth,d.value=e.document.documentElement.clientHeight)};f(),kn(f);const v={passive:!0};if(Je("resize",f,v),e&&s==="visual"&&e.visualViewport&&Je(e.visualViewport,"resize",f,v),o){const x=Xr("(orientation: portrait)");be(x,()=>f())}return{width:i,height:d}}var Ka=Object.defineProperty,Za=(t,e,r)=>e in t?Ka(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Xn=(t,e,r)=>Za(t,typeof e!="symbol"?e+"":e,r);const Xa="@tresjs/core",Ja="module",Qa="4.3.5",ei="pnpm@10.6.3",ti="Declarative ThreeJS using Vue Components",ni="Alvaro Saburido <hola@alvarosaburido.dev> (https://github.com/alvarosabu/)",ri="MIT",oi={type:"git",url:"git+https://github.com/Tresjs/tres.git"},ai=["vue","3d","threejs","three","threejs-vue"],ii=!1,si={".":{types:"./dist/index.d.ts",import:"./dist/tres.js",require:"./dist/tres.umd.cjs"},"./components":{types:"./dist/src/components/index.d.ts"},"./composables":{types:"./dist/src/composables/index.d.ts"},"./types":{types:"./dist/src/types/index.d.ts"},"./utils":{types:"./dist/src/utils/index.d.ts"},"./*":"./*"},li="./dist/tres.js",ui="./dist/tres.js",ci="./dist/index.d.ts",fi=["*.d.ts","dist"],pi={access:"public"},di={dev:"pnpm --filter='./playground/vue' dev","dev:nuxt":"pnpm --filter='./playground/nuxt' dev",build:"vite build",test:"vitest","test:ci":"vitest run","test:ui":"vitest --ui --coverage.enabled=true",release:"release-it",coverage:"vitest run --coverage",lint:"eslint .","lint:fix":"eslint . --fix","docs:dev":"vitepress dev docs","docs:build":"vitepress build docs","docs:serve":"vitepress serve docs","docs:preview":"vitepress preview docs","docs:contributors":"esno scripts/update-contributors.ts"},hi={three:">=0.133",vue:">=3.4"},mi={"@alvarosabu/utils":"^3.2.0","@vue/devtools-api":"^6.6.3","@vueuse/core":"^12.5.0"},gi={"@release-it/conventional-changelog":"^10.0.0","@stackblitz/sdk":"^1.11.0","@tresjs/cientos":"4.1.0","@tresjs/eslint-config":"^1.4.0","@types/three":"^0.173.0","@typescript-eslint/eslint-plugin":"^8.23.0","@typescript-eslint/parser":"^8.23.0","@vitejs/plugin-vue":"^5.2.1","@vitest/coverage-c8":"^0.33.0","@vitest/coverage-v8":"^3.0.5","@vitest/ui":"^3.0.5","@vue/test-utils":"^2.4.6",eslint:"^9.19.0","eslint-plugin-vue":"^9.32.0",esno:"^4.8.0",gsap:"^3.12.7",jsdom:"^26.0.0",kolorist:"^1.8.0",ohmyfetch:"^0.4.21",pathe:"^2.0.2","release-it":"^18.1.2","rollup-plugin-analyzer":"^4.0.0","rollup-plugin-copy":"^3.5.0","rollup-plugin-visualizer":"^5.14.0",sponsorkit:"^16.3.0",three:"^0.173.0",unocss:"^65.4.3",unplugin:"^2.1.2","unplugin-vue-components":"^28.0.0",vite:"^6.1.0","vite-plugin-banner":"^0.8.0","vite-plugin-dts":"4.5.0","vite-plugin-inspect":"^10.1.0","vite-plugin-require-transform":"^1.0.21","vite-svg-loader":"^5.1.0",vitepress:"1.6.3",vitest:"3.0.5",vue:"3.5.13","vue-demi":"^0.14.10"},vi={name:Xa,type:Ja,version:Qa,packageManager:ei,description:ti,author:ni,license:ri,repository:oi,keywords:ai,sideEffects:ii,exports:si,main:li,module:ui,types:ci,files:fi,publishConfig:pi,scripts:di,peerDependencies:hi,dependencies:mi,devDependencies:gi};let yi=class extends Ze{constructor(...e){super(...e),Xn(this,"type","HightlightMesh"),Xn(this,"createTime"),this.createTime=Date.now()}onBeforeRender(){const e=(Date.now()-this.createTime)/1e3,r=1+.07*Math.sin(2.5*e);this.scale.set(r,r,r)}};function wn(t){return typeof t>"u"}function Nn(t){return Array.isArray(t)}function bi(t){return typeof t=="number"}function eo(t){return typeof t=="string"}function nt(t){return typeof t=="function"}function Ne(t){return t===Object(t)&&!Nn(t)&&!nt(t)}function Ge(t){return Ne(t)&&!!t.isObject3D}function to(t){return Ne(t)&&!!t.isColor}function wi(t){return t!=null&&(typeof t=="string"||typeof t=="number"||to(t))}function xn(t){return t!==null&&typeof t=="object"&&"set"in t&&typeof t.set=="function"}function xi(t){return xn(t)&&"copy"in t&&typeof t.copy=="function"}function _i(t){return!!(t!=null&&t.constructor)}function Jn(t){return t instanceof Fo}function Qn(t){return Ne(t)&&!!t.isCamera}function Mi(t){return Ne(t)&&!!t.isBufferGeometry}function Ti(t){return Ne(t)&&!!t.isMaterial}function Ei(t){return Ne(t)&&!!t.isLight}function Ai(t){return Ne(t)&&!!t.isFog}function Ii(t){return Ne(t)&&!!t.isScene}function Ct(t){return Ge(t)||Mi(t)||Ti(t)||Ai(t)}function Pi(t){return Ne(t)&&!!t.isPrimitive}const no=(t,e)=>{for(const r of Object.keys(e))e[r]instanceof Object&&Object.assign(e[r],no(t[r],e[r]));return Object.assign(t||{},e),t},Oi="html,body,base,head,link,meta,style,title,address,article,aside,footer,header,hgroup,h1,h2,h3,h4,h5,h6,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,summary,template,blockquote,iframe,tfoot",Ri=ji(Oi);function er(t){return t&&t.nodeType===1}function nn(t){return t.replace(/-([a-z])/g,(e,r)=>r.toUpperCase())}const Ci=/\B([A-Z])/g;function Si(t){return t.replace(Ci,"-$1").toLowerCase()}function ji(t,e){const r=Object.create(null),n=t.split(",");for(let o=0;o<n.length;o++)r[n[o]]=!0;return o=>!!r[o]}const tr=(t,e)=>{if(!e)return;const r=Array.isArray(e)?e:e.match(/([^[.\]])+/g);return r?.reduce((n,o)=>n&&n[o],t)},ki=(t,e,r)=>{const n=Array.isArray(e)?e:e.match(/([^[.\]])+/g);n&&n.reduce((o,a,s)=>(o[a]===void 0&&(o[a]={}),s===n.length-1&&(o[a]=r),o[a]),t)};function ro(t,e){if(er(t)&&er(e)){const o=t.attributes,a=e.attributes;return o.length!==a.length?!1:Array.from(o).every(({name:s,value:i})=>e.getAttribute(s)===i)}if(t===e)return!0;if(t===null||typeof t!="object"||e===null||typeof e!="object")return!1;const r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(const o of r)if(!n.includes(o)||!ro(t[o],e[o]))return!1;return!0}function Di(t,e){if(!Array.isArray(t)||!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!ro(t[r],e[r]))return!1;return!0}const Ni=Array.isArray;function Bi(t,e,r,n){const o=d=>{if(d.uuid===e)return d;for(const f of d.children){const v=o(f);if(v)return v}},a=o(t);if(!a){console.warn("Object with UUID not found in the scene.");return}let s=a;for(let d=0;d<r.length-1;d++)if(s[r[d]]!==void 0)s=s[r[d]];else{console.warn(`Property path is not valid: ${r.join(".")}`);return}const i=r[r.length-1];s[i]!==void 0?s[i]=n:console.warn(`Property path is not valid: ${r.join(".")}`)}function Ui(t){const e=new Nr({color:11003607,transparent:!0,opacity:.2,depthTest:!1,side:Ht});return new yi(t.geometry.clone(),e)}function zi(t){return"map"in t}function nr(t){zi(t)&&t.map&&t.map.dispose(),t.dispose()}function oo(t){var e,r;if(t.parent&&((e=t.removeFromParent)==null||e.call(t)),delete t.__tres,[...t.children].forEach(n=>oo(n)),!(t instanceof bt)){const n=t;t&&((r=t.dispose)==null||r.call(t)),n.geometry&&n.geometry.dispose(),Array.isArray(n.material)?n.material.forEach(o=>nr(o)):n.material&&nr(n.material)}}function Fi(t,e){let r=0;for(let n=0;n<t.length;n++)e(t[n],n)&&(t[r]=t[n],r++);return t.length=r,t}function _n(t,e){let r=t;if(e.includes("-")){const n=e.split("-");let o=n.shift();for(;r&&n.length;)o in r?(r=r[o],o=n.shift()):o=rr(o,n.shift());return{target:r,key:rr(o,...n)}}else return{target:r,key:e}}function rr(...t){return t.map((e,r)=>r===0?e:e.charAt(0).toUpperCase()+e.slice(1)).join("")}const or=/-\d+$/;function Li(t,e,r){if(eo(r)){if(or.test(r)){const a=r.replace(or,""),{target:s,key:i}=_n(t,a);if(!Array.isArray(s[i])){const d=s[i],f=[];f.__tresDetach=()=>{f.every(v=>wn(v))&&(s[i]=d)},s[i]=f}}const{target:n,key:o}=_n(t,r);e.__tres.previousAttach=n[o],n[o]=rt(e)}else e.__tres.previousAttach=r(t,e)}function Vi(t,e,r){var n,o,a;if(eo(r)){const{target:s,key:i}=_n(t,r),d=e.__tres.previousAttach;d===void 0?delete s[i]:s[i]=d,"__tresDetach"in s&&s.__tresDetach()}else(o=(n=e.__tres)==null?void 0:n.previousAttach)==null||o.call(n,t,e);(a=e.__tres)==null||delete a.previousAttach}function Ke(t,e,r){const n=t;return n.__tres={type:"unknown",eventCount:0,root:r,handlers:{},memoizedProps:{},objects:[],parent:null,previousAttach:null,...e},n.__tres.attach||(n.isMaterial?n.__tres.attach="material":n.isBufferGeometry?n.__tres.attach="geometry":n.isFog&&(n.__tres.attach="fog")),n}function ao(t){var e;const r=(e=t?.__tres)==null?void 0:e.root;r&&r.render&&r.render.canBeInvalidated.value&&r.invalidate()}function Yi(t,e,r){var n;if(!nt(t.setPixelRatio))return;let o=0;if(r&&Nn(r)&&r.length>=2){const[a,s]=r;o=He.clamp(e,a,s)}else bi(r)?o=r:o=e;o!==((n=t.getPixelRatio)==null?void 0:n.call(t))&&t.setPixelRatio(o)}function Gi(t,e,r,n,o){const a=[...e.__tres.objects],s=rt(e);if(t=rt(t),s===t)return!0;const i=Ke(t,e.__tres??{},o),d=e.parent??e.__tres.parent??null,f={...e.__tres.memoizedProps};delete f.object;for(const v of a)io(v,o),so(v,o);s.__tres.objects=[],n.remove(e);for(const[v,x]of Object.entries(f))n.patchProp(i,v,i[v],x);r(t),n.insert(e,d);for(const v of a)n.insert(v,e);return!0}function rt(t){return Pi(t)?(t.object.__tres=t.__tres,t.object):t}function io(t,e){var r,n,o,a;const s=((r=t.__tres)==null?void 0:r.parent)||e.scene.value;t.__tres&&(t.__tres.parent=null),s&&s.__tres&&"objects"in s.__tres&&Fi(s.__tres.objects,i=>i!==t),(n=t.__tres)!=null&&n.attach?Vi(s,t,t.__tres.attach):((a=(o=t.parent)==null?void 0:o.remove)==null||a.call(o,rt(t)),t.parent=null)}function so(t,e){var r;(r=t.traverse)==null||r.call(t,n=>{var o;e.deregisterCamera(n),(o=e.eventManager)==null||o.deregisterPointerMissedObject(n)}),e.deregisterCamera(t),ao(t)}async function Hi(t,e){const r=new ko(e),n=o=>new Promise((a,s)=>{r.load(o,i=>a(i),()=>null,()=>{s(new Error("[useTextures] - Failed to load texture"))})});if(Ni(t)){const o=await Promise.all(t.map(a=>n(a)));return t.length>1?o:o[0]}else{const{map:o,displacementMap:a,normalMap:s,roughnessMap:i,metalnessMap:d,aoMap:f,alphaMap:v,matcap:x}=t;return{map:o?await n(o):null,displacementMap:a?await n(a):null,normalMap:s?await n(s):null,roughnessMap:i?await n(i):null,metalnessMap:d?await n(d):null,aoMap:f?await n(f):null,alphaMap:v?await n(v):null,matcap:x?await n(x):null}}}const $i=({sizes:t})=>{const e=ge([]),r=ye(()=>e.value[0]),n=s=>{const i=s instanceof zo?s:e.value.find(f=>f.uuid===s);if(!i)return;const d=e.value.filter(({uuid:f})=>f!==i.uuid);e.value=[i,...d]},o=(s,i=!1)=>{if(Qn(s)){const d=s;if(e.value.some(({uuid:f})=>f===d.uuid))return;i?n(d):e.value.push(d)}},a=s=>{if(Qn(s)){const i=s;e.value=e.value.filter(({uuid:d})=>d!==i.uuid)}};return Qe(()=>{t.aspectRatio.value&&e.value.forEach(s=>{!s.manual&&(s instanceof De||Wi(s))&&(s instanceof De?s.aspect=t.aspectRatio.value:(s.left=t.width.value*-.5,s.right=t.width.value*.5,s.top=t.height.value*.5,s.bottom=t.height.value*-.5),s.updateProjectionMatrix())})}),We(()=>{e.value=[]}),{camera:r,cameras:e,registerCamera:o,deregisterCamera:a,setCameraActive:n}};function Wi(t){return t.hasOwnProperty("isOrthographicCamera")&&t.isOrthographicCamera}const Gt="[TresJS ▲ ■ ●] ";function qi(...t){typeof t[0]=="string"?t[0]=Gt+t[0]:t.unshift(Gt),console.error(...t)}function Ki(...t){typeof t[0]=="string"?t[0]=Gt+t[0]:t.unshift(Gt),console.warn(...t)}function Zi(t,e){}function lo(){return{logError:qi,logWarning:Ki,logMessage:Zi}}const Mn=ge({}),Tn=t=>Object.assign(Mn.value,t);function rn(){const t=new Map,e=new Set;let r=0,n=!1;const o=()=>{const s=Array.from(t.entries()).sort((i,d)=>{const f=i[1].priority-d[1].priority;return f===0?i[1].addI-d[1].addI:f});e.clear(),s.forEach(i=>e.add(i[0]))},a=s=>{t.delete(s),e.delete(s)};return{on:(s,i=0)=>{t.set(s,{priority:i,addI:r++});const d=()=>a(s);return qe(d),n=!0,{off:d}},off:a,trigger:(...s)=>{n&&(o(),n=!1),e.forEach(i=>i(...s))},dispose:()=>{t.clear(),e.clear()},get count(){return t.size}}}function Xi(){let t=!0,e=!0,r=!1;const n=new Sr(!1),o=ge(n.running),a=ge(!1);let s;const i=He.generateUUID();let d=null;const f=rn(),v=rn(),x=rn();h();let w={};function E(_){w=_}function g(_,p,u=0){switch(p){case"before":return f.on(_,u);case"render":return d||(d=_),v.dispose(),v.on(_);case"after":return x.on(_,u)}}function M(){e&&(e=!1,h(),S())}function m(){e=!0,h(),cancelAnimationFrame(s)}function R(){r=!1,h()}function P(){r=!0,h()}function T(){a.value=!0}function O(){a.value=!1}function S(){if(!t){s=requestAnimationFrame(S);return}const _=n.getDelta(),p=n.getElapsedTime(),u={camera:q(w.camera),scene:q(w.scene),renderer:q(w.renderer),raycaster:q(w.raycaster),controls:q(w.controls),invalidate:w.invalidate,advance:w.advance},l={delta:_,elapsed:p,clock:n,...u};o.value&&f.trigger(l),a.value||(v.count?v.trigger(l):d&&d(l)),o.value&&x.trigger(l),s=requestAnimationFrame(S)}function h(){const _=!e&&!r;n.running!==_&&(n.running?n.stop():n.start()),o.value=n.running}return{loopId:i,register:(_,p,u)=>g(_,p,u),start:M,stop:m,pause:P,resume:R,pauseRender:T,resumeRender:O,isRenderPaused:a,isActive:o,setContext:E,setReady:_=>t=_}}function Bn(t){let e=0;return t.traverse(r=>{if(r.isMesh&&r.geometry&&r.type!=="HightlightMesh"){const n=r.geometry,o=n.attributes.position.count*3*Float32Array.BYTES_PER_ELEMENT,a=n.index?n.index.count*Uint32Array.BYTES_PER_ELEMENT:0,s=n.attributes.normal?n.attributes.normal.count*3*Float32Array.BYTES_PER_ELEMENT:0,i=n.attributes.uv?n.attributes.uv.count*2*Float32Array.BYTES_PER_ELEMENT:0,d=o+a+s+i;e+=d}}),e}function Ji(t){return(t/1024).toFixed(2)}const Qi=Number.parseInt(Dr.replace("dev",""));function es(t){return t instanceof Ee?t:Array.isArray(t)?new Ee(...t):new Ee(t)}const St={realistic:{shadows:!0,physicallyCorrectLights:!0,outputColorSpace:Bo,toneMapping:kr,toneMappingExposure:3,shadowMap:{enabled:!0,type:No}},flat:{toneMapping:jr,toneMappingExposure:1}};function ts({canvas:t,options:e,contextParts:{sizes:r,render:n,invalidate:o,advance:a}}){const s=ye(()=>({alpha:xe(e.alpha)??!0,depth:xe(e.depth),canvas:je(t),context:xe(e.context),stencil:xe(e.stencil),antialias:xe(e.antialias)??!0,precision:xe(e.precision),powerPreference:xe(e.powerPreference),premultipliedAlpha:xe(e.premultipliedAlpha),preserveDrawingBuffer:xe(e.preserveDrawingBuffer),logarithmicDepthBuffer:xe(e.logarithmicDepthBuffer),failIfMajorPerformanceCaveat:xe(e.failIfMajorPerformanceCaveat)})),i=ne(new Bt(s.value));function d(){e.renderMode==="on-demand"&&o()}be(s,()=>{i.value.dispose(),i.value=new Bt(s.value),d()}),be([r.width,r.height],()=>{i.value.setSize(r.width.value,r.height.value),d()},{immediate:!0}),be(()=>e.clearColor,d);const{pixelRatio:f}=La(),{logError:v}=lo(),x=(()=>{const E=new Bt,g={shadowMap:{enabled:E.shadowMap.enabled,type:E.shadowMap.type},toneMapping:E.toneMapping,toneMappingExposure:E.toneMappingExposure,outputColorSpace:E.outputColorSpace};return E.dispose(),g})(),w=xe(e.renderMode);return w==="on-demand"&&o(),w==="manual"&&setTimeout(()=>{a()},100),Qe(()=>{const E=xe(e.preset);E&&(E in St||v(`Renderer Preset must be one of these: ${Object.keys(St).join(", ")}`),no(i.value,St[E])),Yi(i.value,f.value,xe(e.dpr)),w==="always"&&(n.frames.value=Math.max(1,n.frames.value));const g=(R,P)=>{const T=xe(R),O=()=>{if(E)return tr(St[E],P)};if(T!==void 0)return T;const S=O();return S!==void 0?S:tr(x,P)},M=(R,P)=>ki(i.value,P,g(R,P));M(e.shadows,"shadowMap.enabled"),M(e.toneMapping??kr,"toneMapping"),M(e.shadowMapType,"shadowMap.type"),Qi<150&&M(!e.useLegacyLights,"physicallyCorrectLights"),M(e.outputColorSpace,"outputColorSpace"),M(e.toneMappingExposure,"toneMappingExposure");const m=g(e.clearColor,"clearColor");m&&i.value.setClearColor(m?es(m):new Ee(0))}),We(()=>{i.value.dispose(),i.value.forceContextLoss()}),{renderer:i}}function ns(t,e,r=10){const n=xe(t)?qa():Ya(ye(()=>xe(e).parentElement)),o=_t(Zn(n.width,r)),a=_t(Zn(n.height,r)),s=ye(()=>o.value/a.value);return{height:a,width:o,aspectRatio:s}}const rs=(t,e)=>{const r=ye(()=>e.renderer.value.domElement),n=ne([]),{x:o,y:a}=Wa({target:r});let s=0;const{width:i,height:d,top:f,left:v}=Va(r),x=({x:F,y:te})=>{if(r.value)return{x:(F-v.value)/i.value*2-1,y:-((te-f.value)/d.value)*2+1}},w=({x:F,y:te})=>{if(e.camera.value)return e.raycaster.value.setFromCamera(new ve(F,te),e.camera.value),n.value=e.raycaster.value.intersectObjects(t.value,!0),n.value},E=F=>{const te=x({x:F?.clientX??o.value,y:F?.clientY??a.value});return te?w(te)||[]:[]},g=Re(),M=Re(),m=Re(),R=Re(),P=Re(),T=Re(),O=Re(),S=Re();function h(F){const te={};for(const de in F)typeof de!="function"&&(te[de]=F[de]);return te}const _=(F,te)=>{var de,ue,pe;const we=h(te),_e=new Z(te?.clientX,te?.clientY,0).unproject((de=e.camera)==null?void 0:de.value);F.trigger({...we,intersections:n.value,unprojectedPoint:_e,ray:(ue=e.raycaster)==null?void 0:ue.value.ray,camera:(pe=e.camera)==null?void 0:pe.value,sourceEvent:te,delta:s,stopPropagating:!1})};let p;const u=F=>{E(F),_(m,F),p=F},l=()=>{p&&u(p)};let b,A,N;const B=F=>{var te;b=(te=n.value[0])==null?void 0:te.object,s=0,A=new ve(F?.clientX??o.value,F?.clientY??a.value),_(P,F)};let U,D=!1;const J=F=>{var te,de,ue;F instanceof PointerEvent&&(n.value.length===0&&_(T,F),b===((te=n.value[0])==null?void 0:te.object)&&(N=new ve(F?.clientX??o.value,F?.clientY??a.value),s=A?.distanceTo(N),F.button===0?(_(g,F),U===((de=n.value[0])==null?void 0:de.object)?D=!0:(U=(ue=n.value[0])==null?void 0:ue.object,D=!1)):F.button===2&&_(O,F)),_(R,F))},Q=F=>{D&&(_(M,F),U=void 0,D=!1)},H=F=>_(m,F),K=F=>_(S,F);return r.value.addEventListener("pointerup",J),r.value.addEventListener("pointerdown",B),r.value.addEventListener("pointermove",u),r.value.addEventListener("pointerleave",H),r.value.addEventListener("dblclick",Q),r.value.addEventListener("wheel",K),We(()=>{r!=null&&r.value&&(r.value.removeEventListener("pointerup",J),r.value.removeEventListener("pointerdown",B),r.value.removeEventListener("pointermove",u),r.value.removeEventListener("pointerleave",H),r.value.removeEventListener("dblclick",Q),r.value.removeEventListener("wheel",K))}),{intersects:n,onClick:F=>g.on(F).off,onDblClick:F=>M.on(F).off,onContextMenu:F=>O.on(F).off,onPointerMove:F=>m.on(F).off,onPointerUp:F=>R.on(F).off,onPointerDown:F=>P.on(F).off,onPointerMissed:F=>T.on(F).off,onWheel:F=>S.on(F).off,forceUpdate:l}};function on(t,e){if(Array.isArray(t))for(const r of t)r(e);typeof t=="function"&&t(e)}function os(t,e,r){var n;const o=ne(),a=ne();t&&(o.value=t),e&&(a.value=e);const s=u=>{var l;return((l=u.__tres)==null?void 0:l.eventCount)>0},i=u=>{var l;return((l=u.children)==null?void 0:l.some(b=>i(b)))||s(u)},d=ne(((n=o.value)==null?void 0:n.children).filter(i)||[]);function f(u,l){const b=[],A=()=>l.stopPropagating=!0;l.stopPropagation=A;for(const N of l?.intersections){if(l.stopPropagating)return;l={...l,...N};const{object:B}=N;l.eventObject=B,on(B[u],l),b.push(B);let U=B.parent;for(;U!==null&&!l.stopPropagating&&!b.includes(U);)l.eventObject=U,on(U[u],l),b.push(U),U=U.parent;const D=Si(u.slice(2));r(D,{intersection:N,event:l})}}const{onClick:v,onDblClick:x,onContextMenu:w,onPointerMove:E,onPointerDown:g,onPointerUp:M,onPointerMissed:m,onWheel:R,forceUpdate:P}=rs(d,e);M(u=>f("onPointerUp",u)),g(u=>f("onPointerDown",u)),v(u=>f("onClick",u)),x(u=>f("onDoubleClick",u)),w(u=>f("onContextMenu",u)),R(u=>f("onWheel",u));let T=[];E(u=>{const l=u.intersections.map(({object:A})=>A),b=u.intersections;T.forEach(({object:A})=>{l.includes(A)||(u.intersections=T,f("onPointerLeave",u),f("onPointerOut",u))}),u.intersections=b,u.intersections.forEach(({object:A})=>{T.includes(A)||(f("onPointerEnter",u),f("onPointerOver",u))}),f("onPointerMove",u),T=u.intersections});const O=[];m(u=>{const l=()=>u.stopPropagating=!0;u.stopPropagation=l,O.forEach(b=>{u.stopPropagating||(u.eventObject=b,on(b.onPointerMissed,u))}),r("pointer-missed",{event:u})});function S(u){Ct(u)&&Ge(u)&&d.value.push(u)}function h(u){if(Ct(u)&&Ge(u)){const l=d.value.indexOf(u);l>-1&&d.value.splice(l,1)}}function _(u){Ct(u)&&Ge(u)&&u.onPointerMissed&&O.push(u)}function p(u){if(Ct(u)&&Ge(u)){const l=O.indexOf(u);l>-1&&O.splice(l,1)}}return e.eventManager={forceUpdate:P,registerObject:S,deregisterObject:h,registerPointerMissedObject:_,deregisterPointerMissedObject:p},{forceUpdate:P,registerObject:S,deregisterObject:h,registerPointerMissedObject:_,deregisterPointerMissedObject:p}}function as(t,e,r=100){r=r<=0?100:r;const n=Re(),o=new Set;let a=!1,s=!1,i=null;function d(){i&&clearTimeout(i),!s&&!a&&t()?(n.trigger(e),o.forEach(x=>x()),o.clear(),a=!0):!s&&!a&&(i=setTimeout(d,r))}function f(){s=!0,i&&clearTimeout(i)}d();const v=(x,...w)=>{x(...w)};return{on:x=>{if(a)return v(x,e),{off:()=>{}};{const w=n.on(x);return o.add(w.off),n.on(x)}},off:n.off,trigger:n.trigger,clear:n.clear,cancel:f}}const an=new WeakMap;function is(t){if(t=t||ot(),an.has(t))return an.get(t);const e=100,r=Date.now(),n=as(()=>{if(Date.now()-r>=e)return!0;{const o=t.renderer.value,a=o?.domElement||{width:0,height:0};return!!(o&&a.width>0&&a.height>0)}},t);return an.set(t,n),n}function ss({scene:t,canvas:e,windowSize:r,rendererOptions:n,emit:o}){const a=ne(t),s=ns(r,e),{camera:i,cameras:d,registerCamera:f,deregisterCamera:v,setCameraActive:x}=$i({sizes:s}),w={mode:ge(n.renderMode||"always"),priority:ge(0),frames:ge(0),maxFrames:60,canBeInvalidated:ye(()=>w.mode.value==="on-demand"&&w.frames.value===0)};function E(N=1){n.renderMode==="on-demand"&&(w.frames.value=Math.min(w.maxFrames,w.frames.value+N))}function g(){n.renderMode==="manual"&&(w.frames.value=1)}const{renderer:M}=ts({canvas:e,options:n,contextParts:{sizes:s,render:w,invalidate:E,advance:g}}),m={sizes:s,scene:a,camera:i,cameras:_t(d),renderer:M,raycaster:ne(new Do),controls:ge(null),perf:{maxFrames:160,fps:{value:0,accumulator:[]},memory:{currentMem:0,allocatedMem:0,accumulator:[]}},render:w,advance:g,extend:Tn,invalidate:E,registerCamera:f,setCameraActive:x,deregisterCamera:v,loop:Xi()};Ut("useTres",m),m.scene.value.__tres={root:m},m.loop.register(()=>{i.value&&w.frames.value>0&&(M.value.render(t,i.value),o("render",m.renderer.value)),w.priority.value=0,w.mode.value==="always"?w.frames.value=1:w.frames.value=Math.max(0,w.frames.value-1)},"render");const{on:R,cancel:P}=is(m);m.loop.setReady(!1),m.loop.start(),R(()=>{o("ready",m),m.loop.setReady(!0),os(t,m,o)}),We(()=>{P(),m.loop.stop()});const T=100,O=Ga({every:T}),{isSupported:S,memory:h}=Ha({interval:T}),_=160;let p=performance.now();const u=({timestamp:N})=>{m.scene.value&&(m.perf.memory.allocatedMem=Bn(m.scene.value)),N-p>=T&&(p=N,m.perf.fps.accumulator.push(O.value),m.perf.fps.accumulator.length>_&&m.perf.fps.accumulator.shift(),m.perf.fps.value=O.value,S.value&&h.value&&(m.perf.memory.accumulator.push(h.value.usedJSHeapSize/1024/1024),m.perf.memory.accumulator.length>_&&m.perf.memory.accumulator.shift(),m.perf.memory.currentMem=m.perf.memory.accumulator.reduce((B,U)=>B+U,0)/m.perf.memory.accumulator.length))};let l=0;const b=1,{pause:A}=Dn(({delta:N})=>{window.__TRES__DEVTOOLS__&&(u({timestamp:performance.now()}),l+=N,l>=b&&(window.__TRES__DEVTOOLS__.cb(m),l=0))},{immediate:!0});return We(()=>{A()}),m}function ot(){const t=$r("useTres");if(!t)throw new Error("useTresContext must be used together with useTresContextProvider");return t}function uo(){const{camera:t,scene:e,renderer:r,loop:n,raycaster:o,controls:a,invalidate:s,advance:i}=ot();n.setContext({camera:t,scene:e,renderer:r,raycaster:o,controls:a,invalidate:s,advance:i});function d(x,w=0){return n.register(x,"before",w)}function f(x){return n.register(x,"render")}function v(x,w=0){return n.register(x,"after",w)}return{pause:n.pause,resume:n.resume,pauseRender:n.pauseRender,resumeRender:n.resumeRender,isActive:n.isActive,onBeforeRender:d,render:f,onAfterRender:v}}const ls=Re(),us=Re(),co=Re(),yt=new Sr;let zt=0,Ft=0;Dn(()=>{ls.trigger({delta:zt,elapsed:Ft,clock:yt}),us.trigger({delta:zt,elapsed:Ft,clock:yt}),co.trigger({delta:zt,elapsed:Ft,clock:yt})},{immediate:!1});co.on(()=>{zt=yt.getDelta(),Ft=yt.getElapsedTime()});function cs(t,e={},r={}){let n=t;const o=i=>{n=i};let a=new Proxy({},{});const s={has(i,d){return d in e||d in n},get(i,d,f){return d in e?e[d](n):n[d]},set(i,d,f){return r[d]?r[d](f,n,a,o):n[d]=f,!0}};return a=new Proxy({},s),a}const{logError:ar}=lo(),ir=["onClick","onContextMenu","onPointerMove","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut","onDoubleClick","onPointerDown","onPointerUp","onPointerCancel","onPointerMissed","onLostPointerCapture","onWheel"],fs=t=>{const e=t.scene.value;function r(f,v,x,w){if(w||(w={}),w.args||(w.args=[]),f==="template"||Ri(f))return null;let E=f.replace("Tres",""),g;if(f==="primitive"){(!Ne(w.object)||$t(w.object))&&ar("Tres primitives need an 'object' prop, whose value is an object or shallowRef<object>"),E=w.object.type;const M={};g=cs(w.object,{object:m=>m,isPrimitive:()=>!0,__tres:()=>M},{object:(m,R,P,T)=>{Gi(m,P,T,{patchProp:a,remove:o,insert:n},t)},__tres:m=>{Object.assign(M,m)}})}else{const M=Mn.value[E];M||ar(`${E} is not defined on the THREE namespace. Use extend to add it to the catalog.`),g=new M(...w.args)}return g?(g.isCamera&&(w!=null&&w.position||g.position.set(3,3,3),w!=null&&w.lookAt||g.lookAt(0,0,0)),g=Ke(g,{...g.__tres,type:E,memoizedProps:w,eventCount:0,primitive:f==="primitive",attach:w.attach},t),g):null}function n(f,v){var x,w,E;if(!f)return;v=v||e;const g=f.__tres?f:Ke(f,{},t),M=v.__tres?v:Ke(v,{},t);f=rt(g),v=rt(M),f.__tres&&((x=f.__tres)==null?void 0:x.eventCount)>0&&((w=t.eventManager)==null||w.registerObject(f)),t.registerCamera(f),(E=t.eventManager)==null||E.registerPointerMissedObject(f),g.__tres.attach?Li(M,g,g.__tres.attach):Ge(f)&&Ge(M)&&(M.add(f),f.dispatchEvent({type:"added"})),g.__tres.parent=M,M.__tres.objects&&!M.__tres.objects.includes(g)&&M.__tres.objects.push(g)}function o(f,v){var x,w,E,g;if(!f)return;f!=null&&f.__tres&&((x=f.__tres)==null?void 0:x.eventCount)>0&&((w=t.eventManager)==null||w.deregisterObject(f)),v=wn(v)?"default":v;const M=(E=f.__tres)==null?void 0:E.dispose;wn(M)||(M===null?v=!1:v=M);const m=(g=f.__tres)==null?void 0:g.primitive,R=v==="default"?!m:!!v;if(f.__tres&&"objects"in f.__tres&&[...f.__tres.objects].forEach(P=>o(P,v)),R&&f.children&&[...f.children].forEach(P=>o(P,v)),io(f,t),so(f,t),R&&!Ii(f)){if(nt(v))v(f);else if(nt(f.dispose))try{f.dispose()}catch{}}"__tres"in f&&delete f.__tres}function a(f,v,x,w){var E,g;if(!f)return;let M=f,m=v;if(f.__tres&&(f.__tres.memoizedProps[v]=w),v==="attach"){const O=((E=f.__tres)==null?void 0:E.parent)||f.parent;o(f),Ke(f,{attach:w},t),O&&n(f,O);return}if(v==="dispose"){f.__tres||(f=Ke(f,{},t)),f.__tres.dispose=w;return}if(Ge(f)&&m==="blocks-pointer-events"){w||w===""?f[m]=w:delete f[m];return}ir.includes(v)&&f.__tres&&(f.__tres.eventCount+=1);let R=nn(m),P=M?.[R];if(m==="args"){const O=f,S=x??[],h=w??[],_=((g=f.__tres)==null?void 0:g.type)||f.type;_&&S.length&&!Di(S,h)&&(M=Object.assign(O,new Mn.value[_](...w)));return}if(M.type==="BufferGeometry"){if(m==="args")return;M.setAttribute(nn(m),new pt(...w));return}if(m.includes("-")&&P===void 0){P=M;for(const O of m.split("-"))R=m=nn(O),M=P,P=P?.[m]}let T=w;if(T===""&&(T=!0),nt(P)){ir.includes(v)||(Nn(T)?f[R](...T):f[R](T)),R.startsWith("on")&&nt(T)&&(M[R]=T);return}Jn(P)&&Jn(T)?P.mask=T.mask:to(P)&&wi(T)?P.set(T):xi(P)&&_i(T)&&P.constructor===T.constructor?P.copy(T):xn(P)&&Array.isArray(T)?"fromArray"in P&&typeof P.fromArray=="function"?P.fromArray(T):P.set(...T):xn(P)&&typeof T=="number"?"setScalar"in P&&typeof P.setScalar=="function"?P.setScalar(T):P.set(T):M[R]=T,ao(f)}function s(f){var v;return((v=f?.__tres)==null?void 0:v.parent)||null}function i(f){const v=Ke(new Uo,{type:"Comment"},t);return v.name=f,v}function d(f){var v;const x=s(f),w=((v=x?.__tres)==null?void 0:v.objects)||[],E=w.indexOf(f);return E<0||E>=w.length-1?null:w[E+1]}return{insert:n,remove:o,createElement:r,patchProp:a,parentNode:s,createText:()=>{},createComment:i,setText:()=>{},setElementText:()=>{},nextSibling:d,querySelector:()=>{},setScopeId:()=>{},cloneNode:()=>{},insertStaticContent:()=>{}}};function ps(){return fo().__VUE_DEVTOOLS_GLOBAL_HOOK__}function fo(){return typeof navigator<"u"&&typeof window<"u"?window:typeof globalThis<"u"?globalThis:{}}const ds=typeof Proxy=="function",hs="devtools-plugin:setup",ms="plugin:settings:set";let ct,En;function gs(){var t;return ct!==void 0||(typeof window<"u"&&window.performance?(ct=!0,En=window.performance):typeof globalThis<"u"&&!((t=globalThis.perf_hooks)===null||t===void 0)&&t.performance?(ct=!0,En=globalThis.perf_hooks.performance):ct=!1),ct}function vs(){return gs()?En.now():Date.now()}class ys{constructor(e,r){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=e,this.hook=r;const n={};if(e.settings)for(const s in e.settings){const i=e.settings[s];n[s]=i.defaultValue}const o=`__vue-devtools-plugin-settings__${e.id}`;let a=Object.assign({},n);try{const s=localStorage.getItem(o),i=JSON.parse(s);Object.assign(a,i)}catch{}this.fallbacks={getSettings(){return a},setSettings(s){try{localStorage.setItem(o,JSON.stringify(s))}catch{}a=s},now(){return vs()}},r&&r.on(ms,(s,i)=>{s===this.plugin.id&&this.fallbacks.setSettings(i)}),this.proxiedOn=new Proxy({},{get:(s,i)=>this.target?this.target.on[i]:(...d)=>{this.onQueue.push({method:i,args:d})}}),this.proxiedTarget=new Proxy({},{get:(s,i)=>this.target?this.target[i]:i==="on"?this.proxiedOn:Object.keys(this.fallbacks).includes(i)?(...d)=>(this.targetQueue.push({method:i,args:d,resolve:()=>{}}),this.fallbacks[i](...d)):(...d)=>new Promise(f=>{this.targetQueue.push({method:i,args:d,resolve:f})})})}async setRealTarget(e){this.target=e;for(const r of this.onQueue)this.target.on[r.method](...r.args);for(const r of this.targetQueue)r.resolve(await this.target[r.method](...r.args))}}function bs(t,e){const r=t,n=fo(),o=ps(),a=ds&&r.enableEarlyProxy;if(o&&(n.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__||!a))o.emit(hs,t,e);else{const s=a?new ys(r,o):null;(n.__VUE_DEVTOOLS_PLUGINS__=n.__VUE_DEVTOOLS_PLUGINS__||[]).push({pluginDescriptor:r,setupFn:e,proxy:s}),s&&e(s.proxiedTarget)}}function ws(t,e){const r=`▲ ■ ●${t}`;typeof sr=="function"?sr(r,e):console.log(r)}function sr(t,e){throw new Error(t+e)}const po=t=>{const e={id:t.uuid,label:t.type,children:[],tags:[]};t.name!==""&&e.tags.push({label:t.name,textColor:5750629,backgroundColor:15793395});const r=Bn(t);return r>0&&e.tags.push({label:`${Ji(r)} KB`,textColor:15707189,backgroundColor:16775644,tooltip:"Memory usage"}),t.type.includes("Light")&&(Ei(t)&&e.tags.push({label:`${t.intensity}`,textColor:9738662,backgroundColor:16316922,tooltip:"Intensity"}),e.tags.push({label:`#${new Ee(t.color).getHexString()}`,textColor:9738662,backgroundColor:16316922,tooltip:"Color"})),t.type.includes("Camera")&&(e.tags.push({label:`${t.fov}°`,textColor:9738662,backgroundColor:16316922,tooltip:"Field of view"}),e.tags.push({label:`x: ${Math.round(t.position.x)} y: ${Math.round(t.position.y)} z: ${Math.round(t.position.z)}`,textColor:9738662,backgroundColor:16316922,tooltip:"Position"})),e};function ho(t,e,r=""){t.children.forEach(n=>{if(n.type==="HightlightMesh"||r&&!n.type.includes(r)&&!n.name.includes(r))return;const o=po(n);e.children.push(o),ho(n,o,r)})}const xs=[],ft="tres:inspector",_s=va({sceneGraph:null});function Ms(t,e){bs({id:"dev.esm.tres",label:"TresJS 🪐",logo:"https://raw.githubusercontent.com/Tresjs/tres/main/public/favicon.svg",packageName:"tresjs",homepage:"https://tresjs.org",componentStateTypes:xs,app:t},r=>{typeof r.now!="function"&&ws("You seem to be using an outdated version of Vue Devtools. Are you still using the Beta release instead of the stable one? You can find the links at https://devtools.vuejs.org/guide/installation.html."),r.addInspector({id:ft,label:"TresJS 🪐",icon:"account_tree",treeFilterPlaceholder:"Search instances"}),setInterval(()=>{r.sendInspectorTree(ft)},1e3),setInterval(()=>{r.notifyComponentUpdate()},5e3),r.on.getInspectorTree(a=>{if(a.inspectorId===ft){const s=po(e.scene.value);ho(e.scene.value,s,a.filter),_s.sceneGraph=s,a.rootNodes=[s]}});let n=null,o=null;r.on.getInspectorState(a=>{var s;if(a.inspectorId===ft){const[i]=e.scene.value.getObjectsByProperty("uuid",a.nodeId);if(!i)return;if(o&&n&&n.parent&&o.remove(n),i.isMesh){const d=Ui(i);i.add(d),n=d,o=i}a.state={object:Object.entries(i).map(([d,f])=>d==="children"?{key:d,value:f.filter(v=>v.type!=="HightlightMesh")}:{key:d,value:f,editable:!0}).filter(({key:d})=>d!=="parent")},i.isScene&&(a.state={...a.state,state:[{key:"Scene Info",value:{objects:i.children.length,memory:Bn(i),calls:e.renderer.value.info.render.calls,triangles:e.renderer.value.info.render.triangles,points:e.renderer.value.info.render.points,lines:e.renderer.value.info.render.lines}},{key:"Programs",value:((s=e.renderer.value.info.programs)==null?void 0:s.map(d=>({...d,programName:d.name})))||[]}]})}}),r.on.editInspectorState(a=>{a.inspectorId===ft&&Bi(e.scene.value,a.nodeId,a.path,a.state.value)})})}const Ts=["data-scene","data-tres"],fu=Xe({__name:"TresCanvas",props:{shadows:{type:Boolean,default:void 0},clearColor:{},toneMapping:{},shadowMapType:{},useLegacyLights:{type:Boolean,default:void 0},outputColorSpace:{},toneMappingExposure:{},renderMode:{default:"always"},dpr:{},camera:{},preset:{},windowSize:{type:Boolean,default:void 0},enableProvideBridge:{type:Boolean,default:!0},context:{},alpha:{type:Boolean,default:void 0},premultipliedAlpha:{type:Boolean},antialias:{type:Boolean,default:void 0},stencil:{type:Boolean,default:void 0},preserveDrawingBuffer:{type:Boolean,default:void 0},powerPreference:{},depth:{type:Boolean,default:void 0},failIfMajorPerformanceCaveat:{type:Boolean,default:void 0},precision:{},logarithmicDepthBuffer:{type:Boolean,default:void 0},reverseDepthBuffer:{type:Boolean}},emits:["render","click","double-click","context-menu","pointer-move","pointer-up","pointer-down","pointer-enter","pointer-leave","pointer-over","pointer-out","pointer-missed","wheel","ready"],setup(t,{expose:e,emit:r}){const n=t,o=r,a=Sn(),s=ge(),i=ne(new bt),d=xt();Tn(Lo);const f=(g,M=!1)=>Xe({setup(){var m;const R=(m=xt())==null?void 0:m.appContext;R&&(R.app=d?.appContext.app);const P={};function T(O){O&&(O.parent&&T(O.parent),O.provides&&Object.assign(P,O.provides))}return d!=null&&d.parent&&n.enableProvideBridge&&(T(d.parent),Reflect.ownKeys(P).forEach(O=>{Ut(O,P[O])})),Ut("useTres",g),Ut("extend",Tn),typeof window<"u"&&Ms(R?.app,g),()=>qn(xa,null,M?[]:a.default())}}),v=(g,M=!1)=>{const m=f(g,M),{render:R}=wa(fs(g));R(qn(m),i.value)},x=(g,M=!1)=>{oo(g.scene.value),M&&(g.renderer.value.dispose(),g.renderer.value.renderLists.dispose(),g.renderer.value.forceContextLoss()),i.value.__tres={root:g}},w=ne(null);e({context:w,dispose:()=>x(w.value,!0)});const E=()=>{x(w.value),v(w.value,!0)};return Cn(()=>{const g=s;w.value=ss({scene:i.value,canvas:g,windowSize:n.windowSize??!1,rendererOptions:n,emit:o});const{registerCamera:M,camera:m,cameras:R,deregisterCamera:P}=w.value;v(w.value);const T=()=>{const O=new De(45,window.innerWidth/window.innerHeight,.1,1e3);O.position.set(3,3,3),O.lookAt(0,0,0),M(O);const S=Qe(()=>{R.value.length>=2&&(O.removeFromParent(),P(O),S?.())})};be(()=>n.camera,(O,S)=>{O&&M(O),S&&(S.removeFromParent(),P(S))},{immediate:!0}),m.value||T()}),We(E),(g,M)=>(Ie(),Se("canvas",{ref_key:"canvas",ref:s,"data-scene":i.value.uuid,class:ba(g.$attrs.class),"data-tres":`tresjs ${q(vi).version}`,style:ya({display:"block",width:"100%",height:"100%",position:g.windowSize?"fixed":"relative",top:0,left:0,pointerEvents:"auto",touchAction:"none",...g.$attrs.style})},null,14,Ts))}});var Es=Object.defineProperty,As=(t,e,r)=>e in t?Es(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Is=(t,e,r)=>As(t,e+"",r);function Ps(t){return Yr()?(Gr(t),!0):!1}function mo(t){return typeof t=="function"?t():q(t)}const Os=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Rs=Object.prototype.toString,Cs=t=>Rs.call(t)==="[object Object]",Ss=()=>{},js=Os?window:void 0;function ks(t){var e;const r=mo(t);return(e=r?.$el)!=null?e:r}function sn(...t){let e,r,n,o;if(typeof t[0]=="string"||Array.isArray(t[0])?([r,n,o]=t,e=js):[e,r,n,o]=t,!e)return Ss;Array.isArray(r)||(r=[r]),Array.isArray(n)||(n=[n]);const a=[],s=()=>{a.forEach(v=>v()),a.length=0},i=(v,x,w,E)=>(v.addEventListener(x,w,E),()=>v.removeEventListener(x,w,E)),d=be(()=>[ks(e),mo(o)],([v,x])=>{if(s(),!v)return;const w=Cs(x)?{...x}:x;a.push(...r.flatMap(E=>n.map(g=>i(v,E,g,w))))},{immediate:!0,flush:"post"}),f=()=>{d(),s()};return Ps(f),f}function go(t,e,r,n){const o=class extends Mt{constructor(a={}){const s=Object.entries(t);super({uniforms:s.reduce((i,[d,f])=>{const v=Rn.clone({[d]:{value:f}});return{...i,...v}},{}),vertexShader:e,fragmentShader:r}),Is(this,"key",""),s.forEach(([i])=>Object.defineProperty(this,i,{get:()=>this.uniforms[i].value,set:d=>this.uniforms[i].value=d})),Object.assign(this,a)}};return o.key=He.generateUUID(),o}go({color:new Ee("white"),scale:new ve(1,1),imageBounds:new ve(1,1),resolution:1024,map:null,zoom:1,radius:0,grayscale:0,opacity:1},`
    varying vec2 vUv;
    varying vec2 vPos;
    void main() {
      gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.);
      vUv = uv;
      vPos = position.xy;
    }
  `,`
    // mostly from https://gist.github.com/statico/df64c5d167362ecf7b34fca0b1459a44
    varying vec2 vUv;
    varying vec2 vPos;
    uniform vec2 scale;
    uniform vec2 imageBounds;
    uniform float resolution;
    uniform vec3 color;
    uniform sampler2D map;
    uniform float radius;
    uniform float zoom;
    uniform float grayscale;
    uniform float opacity;
    const vec3 luma = vec3(.299, 0.587, 0.114);
    vec4 toGrayscale(vec4 color, float intensity) {
      return vec4(mix(color.rgb, vec3(dot(color.rgb, luma)), intensity), color.a);
    }
    vec2 aspect(vec2 size) {
      return size / min(size.x, size.y);
    }
    
    const float PI = 3.14159265;
      
    // from https://iquilezles.org/articles/distfunctions
    float udRoundBox( vec2 p, vec2 b, float r ) {
      return length(max(abs(p)-b+r,0.0))-r;
    }
  
    void main() {
      vec2 s = aspect(scale);
      vec2 i = aspect(imageBounds);
      float rs = s.x / s.y;
      float ri = i.x / i.y;
      vec2 new = rs < ri ? vec2(i.x * s.y / i.y, s.y) : vec2(s.x, i.y * s.x / i.x);
      vec2 offset = (rs < ri ? vec2((new.x - s.x) / 2.0, 0.0) : vec2(0.0, (new.y - s.y) / 2.0)) / new;
      vec2 uv = vUv * s / new + offset;
      vec2 zUv = (uv - vec2(0.5, 0.5)) / zoom + vec2(0.5, 0.5);
  
      vec2 res = vec2(scale * resolution);
      vec2 halfRes = 0.5 * res;
      float b = udRoundBox(vUv.xy * res - halfRes, halfRes, resolution * radius);    
        vec3 a = mix(vec3(1.0,0.0,0.0), vec3(0.0,0.0,0.0), smoothstep(0.0, 1.0, b));
      gl_FragColor = toGrayscale(texture2D(map, zUv) * vec4(color, opacity * a), grayscale);
      
      #include <tonemapping_fragment>
      #include <colorspace_fragment>
    }
  `);const Un=parseInt(Dr.replace(/\D+/g,""));var Ds=Object.defineProperty,Ns=(t,e,r)=>e in t?Ds(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Bs=(t,e,r)=>(Ns(t,e+"",r),r);async function lr(t){const e=await t.arrayBuffer(),r=btoa(String.fromCharCode(...new Uint8Array(e)));return`data:${t.type||""};base64,${r}`}let jt,ln,et,kt;function un(t,e=1/0,r=null){ln||(ln=new Fr(2,2,1,1)),et||(et=new Mt({uniforms:{blitTexture:new na(t)},vertexShader:`
        varying vec2 vUv;
        void main(){
            vUv = uv;
            gl_Position = vec4(position.xy * 1.0,0.,.999999);
        }
      `,fragmentShader:`
          uniform sampler2D blitTexture; 
          varying vec2 vUv;

          void main(){ 
              gl_FragColor = vec4(vUv.xy, 0, 1);
              
              #ifdef IS_SRGB
              gl_FragColor = LinearTosRGB( texture2D( blitTexture, vUv) );
              #else
              gl_FragColor = texture2D( blitTexture, vUv);
              #endif
          }
      `})),et.uniforms.blitTexture.value=t,et.defines.IS_SRGB="colorSpace"in t?t.colorSpace==="srgb":t.encoding===3001,et.needsUpdate=!0,kt||(kt=new Ze(ln,et),kt.frustrumCulled=!1);const n=new De,o=new bt;o.add(kt),r||(r=jt=new Bt({antialias:!1})),r.setSize(Math.min(t.image.width,e),Math.min(t.image.height,e)),r.clear(),r.render(o,n);const a=new Lr(r.domElement);return a.minFilter=t.minFilter,a.magFilter=t.magFilter,a.wrapS=t.wrapS,a.wrapT=t.wrapT,a.name=t.name,jt&&(jt.dispose(),jt=null),a}const ur={POSITION:["byte","byte normalized","unsigned byte","unsigned byte normalized","short","short normalized","unsigned short","unsigned short normalized"],NORMAL:["byte normalized","short normalized"],TANGENT:["byte normalized","short normalized"],TEXCOORD:["byte","byte normalized","unsigned byte","short","short normalized","unsigned short"]};class vo{constructor(){this.pluginCallbacks=[],this.register(function(e){return new Ws(e)}),this.register(function(e){return new qs(e)}),this.register(function(e){return new Xs(e)}),this.register(function(e){return new Js(e)}),this.register(function(e){return new Qs(e)}),this.register(function(e){return new el(e)}),this.register(function(e){return new Ks(e)}),this.register(function(e){return new Zs(e)}),this.register(function(e){return new tl(e)}),this.register(function(e){return new nl(e)}),this.register(function(e){return new rl(e)})}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,r,n,o){const a=new $s,s=[];for(let i=0,d=this.pluginCallbacks.length;i<d;i++)s.push(this.pluginCallbacks[i](a));a.setPlugins(s),a.write(e,r,o).catch(n)}parseAsync(e,r){const n=this;return new Promise(function(o,a){n.parse(e,o,a,r)})}}Bs(vo,"Utils",{insertKeyframe:function(t,e){const r=t.getValueSize(),n=new t.TimeBufferType(t.times.length+1),o=new t.ValueBufferType(t.values.length+r),a=t.createInterpolant(new t.ValueBufferType(r));let s;if(t.times.length===0){n[0]=e;for(let i=0;i<r;i++)o[i]=0;s=0}else if(e<t.times[0]){if(Math.abs(t.times[0]-e)<.001)return 0;n[0]=e,n.set(t.times,1),o.set(a.evaluate(e),0),o.set(t.values,r),s=0}else if(e>t.times[t.times.length-1]){if(Math.abs(t.times[t.times.length-1]-e)<.001)return t.times.length-1;n[n.length-1]=e,n.set(t.times,0),o.set(t.values,0),o.set(a.evaluate(e),t.values.length),s=n.length-1}else for(let i=0;i<t.times.length;i++){if(Math.abs(t.times[i]-e)<.001)return i;if(t.times[i]<e&&t.times[i+1]>e){n.set(t.times.slice(0,i+1),0),n[i+1]=e,n.set(t.times.slice(i+1),i+2),o.set(t.values.slice(0,(i+1)*r),0),o.set(a.evaluate(e),(i+1)*r),o.set(t.values.slice((i+1)*r),(i+2)*r),s=i+1;break}}return t.times=n,t.values=o,s},mergeMorphTargetTracks:function(t,e){const r=[],n={},o=t.tracks;for(let a=0;a<o.length;++a){let s=o[a];const i=Vt.parseTrackName(s.name),d=Vt.findNode(e,i.nodeName);if(i.propertyName!=="morphTargetInfluences"||i.propertyIndex===void 0){r.push(s);continue}if(s.createInterpolant!==s.InterpolantFactoryMethodDiscrete&&s.createInterpolant!==s.InterpolantFactoryMethodLinear){if(s.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),s=s.clone(),s.setInterpolation(Vo)}const f=d.morphTargetInfluences.length,v=d.morphTargetDictionary[i.propertyIndex];if(v===void 0)throw new Error("THREE.GLTFExporter: Morph target name not found: "+i.propertyIndex);let x;if(n[d.uuid]===void 0){x=s.clone();const E=new x.ValueBufferType(f*x.times.length);for(let g=0;g<x.times.length;g++)E[g*f+v]=x.values[g];x.name=(i.nodeName||"")+".morphTargetInfluences",x.values=E,n[d.uuid]=x,r.push(x);continue}const w=s.createInterpolant(new s.ValueBufferType(1));x=n[d.uuid];for(let E=0;E<x.times.length;E++)x.values[E*f+v]=w.evaluate(x.times[E]);for(let E=0;E<s.times.length;E++){const g=this.insertKeyframe(x,s.times[E]);x.values[g*f+v]=s.values[E]}}return t.tracks=r,t}});const ee={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,REPEAT:10497},cn="KHR_mesh_quantization",Pe={};Pe[dt]=ee.NEAREST;Pe[la]=ee.NEAREST_MIPMAP_NEAREST;Pe[ua]=ee.NEAREST_MIPMAP_LINEAR;Pe[ca]=ee.LINEAR;Pe[fa]=ee.LINEAR_MIPMAP_NEAREST;Pe[pa]=ee.LINEAR_MIPMAP_LINEAR;Pe[ht]=ee.CLAMP_TO_EDGE;Pe[da]=ee.REPEAT;Pe[ha]=ee.MIRRORED_REPEAT;const cr={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},Us=new Ee,fr=12,zs=1179937895,Fs=2,pr=8,Ls=1313821514,Vs=5130562;function mt(t,e){return t.length===e.length&&t.every(function(r,n){return r===e[n]})}function Ys(t){return new TextEncoder().encode(t).buffer}function Gs(t){return mt(t.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}function Hs(t,e,r){const n={min:new Array(t.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(t.itemSize).fill(Number.NEGATIVE_INFINITY)};for(let o=e;o<e+r;o++)for(let a=0;a<t.itemSize;a++){let s;t.itemSize>4?s=t.array[o*t.itemSize+a]:(a===0?s=t.getX(o):a===1?s=t.getY(o):a===2?s=t.getZ(o):a===3&&(s=t.getW(o)),t.normalized===!0&&(s=He.normalize(s,t.array))),n.min[a]=Math.min(n.min[a],s),n.max[a]=Math.max(n.max[a],s)}return n}function yo(t){return Math.ceil(t/4)*4}function fn(t,e=0){const r=yo(t.byteLength);if(r!==t.byteLength){const n=new Uint8Array(r);if(n.set(new Uint8Array(t)),e!==0)for(let o=t.byteLength;o<r;o++)n[o]=e;return n.buffer}return t}function dr(){return typeof document>"u"&&typeof OffscreenCanvas<"u"?new OffscreenCanvas(1,1):document.createElement("canvas")}function hr(t,e){if(t.toBlob!==void 0)return new Promise(n=>t.toBlob(n,e));let r;return e==="image/jpeg"?r=.92:e==="image/webp"&&(r=.8),t.convertToBlob({type:e,quality:r})}class $s{constructor(){this.plugins=[],this.options={},this.pending=[],this.buffers=[],this.byteOffset=0,this.buffers=[],this.nodeMap=new Map,this.skins=[],this.extensionsUsed={},this.extensionsRequired={},this.uids=new Map,this.uid=0,this.json={asset:{version:"2.0",generator:"THREE.GLTFExporter"}},this.cache={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map}}setPlugins(e){this.plugins=e}async write(e,r,n={}){this.options=Object.assign({binary:!1,trs:!1,onlyVisible:!0,maxTextureSize:1/0,animations:[],includeCustomExtensions:!1},n),this.options.animations.length>0&&(this.options.trs=!0),this.processInput(e),await Promise.all(this.pending);const o=this,a=o.buffers,s=o.json;n=o.options;const i=o.extensionsUsed,d=o.extensionsRequired,f=new Blob(a,{type:"application/octet-stream"}),v=Object.keys(i),x=Object.keys(d);v.length>0&&(s.extensionsUsed=v),x.length>0&&(s.extensionsRequired=x),s.buffers&&s.buffers.length>0&&(s.buffers[0].byteLength=f.size),n.binary===!0?f.arrayBuffer().then(w=>{const E=fn(w),g=new DataView(new ArrayBuffer(pr));g.setUint32(0,E.byteLength,!0),g.setUint32(4,Vs,!0);const M=fn(Ys(JSON.stringify(s)),32),m=new DataView(new ArrayBuffer(pr));m.setUint32(0,M.byteLength,!0),m.setUint32(4,Ls,!0);const R=new ArrayBuffer(fr),P=new DataView(R);P.setUint32(0,zs,!0),P.setUint32(4,Fs,!0);const T=fr+m.byteLength+M.byteLength+g.byteLength+E.byteLength;P.setUint32(8,T,!0),new Blob([R,m,M,g,E],{type:"application/octet-stream"}).arrayBuffer().then(r)}):s.buffers&&s.buffers.length>0?lr(f).then(w=>{s.buffers[0].uri=w,r(s)}):r(s)}serializeUserData(e,r){if(Object.keys(e.userData).length===0)return;const n=this.options,o=this.extensionsUsed;try{const a=JSON.parse(JSON.stringify(e.userData));if(n.includeCustomExtensions&&a.gltfExtensions){r.extensions===void 0&&(r.extensions={});for(const s in a.gltfExtensions)r.extensions[s]=a.gltfExtensions[s],o[s]=!0;delete a.gltfExtensions}Object.keys(a).length>0&&(r.extras=a)}catch(a){console.warn("THREE.GLTFExporter: userData of '"+e.name+"' won't be serialized because of JSON.stringify error - "+a.message)}}getUID(e,r=!1){if(this.uids.has(e)===!1){const n=new Map;n.set(!0,this.uid++),n.set(!1,this.uid++),this.uids.set(e,n)}return this.uids.get(e).get(r)}isNormalizedNormalAttribute(e){if(this.cache.attributesNormalized.has(e))return!1;const r=new Z;for(let n=0,o=e.count;n<o;n++)if(Math.abs(r.fromBufferAttribute(e,n).length()-1)>5e-4)return!1;return!0}createNormalizedNormalAttribute(e){const r=this.cache;if(r.attributesNormalized.has(e))return r.attributesNormalized.get(e);const n=e.clone(),o=new Z;for(let a=0,s=n.count;a<s;a++)o.fromBufferAttribute(n,a),o.x===0&&o.y===0&&o.z===0?o.setX(1):o.normalize(),n.setXYZ(a,o.x,o.y,o.z);return r.attributesNormalized.set(e,n),n}applyTextureTransform(e,r){let n=!1;const o={};(r.offset.x!==0||r.offset.y!==0)&&(o.offset=r.offset.toArray(),n=!0),r.rotation!==0&&(o.rotation=r.rotation,n=!0),(r.repeat.x!==1||r.repeat.y!==1)&&(o.scale=r.repeat.toArray(),n=!0),n&&(e.extensions=e.extensions||{},e.extensions.KHR_texture_transform=o,this.extensionsUsed.KHR_texture_transform=!0)}buildMetalRoughTexture(e,r){if(e===r)return e;function n(w){return("colorSpace"in w?w.colorSpace==="srgb":w.encoding===3001)?function(E){return E<.04045?E*.0773993808:Math.pow(E*.9478672986+.0521327014,2.4)}:function(E){return E}}console.warn("THREE.GLTFExporter: Merged metalnessMap and roughnessMap textures."),e instanceof Qt&&(e=un(e)),r instanceof Qt&&(r=un(r));const o=e?e.image:null,a=r?r.image:null,s=Math.max(o?o.width:0,a?a.width:0),i=Math.max(o?o.height:0,a?a.height:0),d=dr();d.width=s,d.height=i;const f=d.getContext("2d");f.fillStyle="#00ffff",f.fillRect(0,0,s,i);const v=f.getImageData(0,0,s,i);if(o){f.drawImage(o,0,0,s,i);const w=n(e),E=f.getImageData(0,0,s,i).data;for(let g=2;g<E.length;g+=4)v.data[g]=w(E[g]/256)*256}if(a){f.drawImage(a,0,0,s,i);const w=n(r),E=f.getImageData(0,0,s,i).data;for(let g=1;g<E.length;g+=4)v.data[g]=w(E[g]/256)*256}f.putImageData(v,0,0);const x=(e||r).clone();return x.source=new Lr(d).source,"colorSpace"in x?x.colorSpace="":x.encoding=3e3,x.channel=(e||r).channel,e&&r&&e.channel!==r.channel&&console.warn("THREE.GLTFExporter: UV channels for metalnessMap and roughnessMap textures must match."),x}processBuffer(e){const r=this.json,n=this.buffers;return r.buffers||(r.buffers=[{byteLength:0}]),n.push(e),0}processBufferView(e,r,n,o,a){const s=this.json;s.bufferViews||(s.bufferViews=[]);let i;switch(r){case ee.BYTE:case ee.UNSIGNED_BYTE:i=1;break;case ee.SHORT:case ee.UNSIGNED_SHORT:i=2;break;default:i=4}const d=yo(o*e.itemSize*i),f=new DataView(new ArrayBuffer(d));let v=0;for(let w=n;w<n+o;w++)for(let E=0;E<e.itemSize;E++){let g;e.itemSize>4?g=e.array[w*e.itemSize+E]:(E===0?g=e.getX(w):E===1?g=e.getY(w):E===2?g=e.getZ(w):E===3&&(g=e.getW(w)),e.normalized===!0&&(g=He.normalize(g,e.array))),r===ee.FLOAT?f.setFloat32(v,g,!0):r===ee.INT?f.setInt32(v,g,!0):r===ee.UNSIGNED_INT?f.setUint32(v,g,!0):r===ee.SHORT?f.setInt16(v,g,!0):r===ee.UNSIGNED_SHORT?f.setUint16(v,g,!0):r===ee.BYTE?f.setInt8(v,g):r===ee.UNSIGNED_BYTE&&f.setUint8(v,g),v+=i}const x={buffer:this.processBuffer(f.buffer),byteOffset:this.byteOffset,byteLength:d};return a!==void 0&&(x.target=a),a===ee.ARRAY_BUFFER&&(x.byteStride=e.itemSize*i),this.byteOffset+=d,s.bufferViews.push(x),{id:s.bufferViews.length-1,byteLength:0}}processBufferViewImage(e){const r=this,n=r.json;return n.bufferViews||(n.bufferViews=[]),e.arrayBuffer().then(o=>{const a=fn(o),s={buffer:r.processBuffer(a),byteOffset:r.byteOffset,byteLength:a.byteLength};return r.byteOffset+=a.byteLength,n.bufferViews.push(s)-1})}processAccessor(e,r,n,o){const a=this.json,s={1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",9:"MAT3",16:"MAT4"};let i;if(e.array.constructor===Float32Array)i=ee.FLOAT;else if(e.array.constructor===Int32Array)i=ee.INT;else if(e.array.constructor===Uint32Array)i=ee.UNSIGNED_INT;else if(e.array.constructor===Int16Array)i=ee.SHORT;else if(e.array.constructor===Uint16Array)i=ee.UNSIGNED_SHORT;else if(e.array.constructor===Int8Array)i=ee.BYTE;else if(e.array.constructor===Uint8Array)i=ee.UNSIGNED_BYTE;else throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type: "+e.array.constructor.name);if(n===void 0&&(n=0),o===void 0&&(o=e.count),o===0)return null;const d=Hs(e,n,o);let f;r!==void 0&&(f=e===r.index?ee.ELEMENT_ARRAY_BUFFER:ee.ARRAY_BUFFER);const v=this.processBufferView(e,i,n,o,f),x={bufferView:v.id,byteOffset:v.byteOffset,componentType:i,count:o,max:d.max,min:d.min,type:s[e.itemSize]};return e.normalized===!0&&(x.normalized=!0),a.accessors||(a.accessors=[]),a.accessors.push(x)-1}processImage(e,r,n,o="image/png"){if(e!==null){const a=this,s=a.cache,i=a.json,d=a.options,f=a.pending;s.images.has(e)||s.images.set(e,{});const v=s.images.get(e),x=o+":flipY/"+n.toString();if(v[x]!==void 0)return v[x];i.images||(i.images=[]);const w={mimeType:o},E=dr();E.width=Math.min(e.width,d.maxTextureSize),E.height=Math.min(e.height,d.maxTextureSize);const g=E.getContext("2d");if(n===!0&&(g.translate(0,E.height),g.scale(1,-1)),e.data!==void 0){r!==vn&&console.error("GLTFExporter: Only RGBAFormat is supported.",r),(e.width>d.maxTextureSize||e.height>d.maxTextureSize)&&console.warn("GLTFExporter: Image size is bigger than maxTextureSize",e);const m=new Uint8ClampedArray(e.height*e.width*4);for(let R=0;R<m.length;R+=4)m[R+0]=e.data[R+0],m[R+1]=e.data[R+1],m[R+2]=e.data[R+2],m[R+3]=e.data[R+3];g.putImageData(new ImageData(m,e.width,e.height),0,0)}else g.drawImage(e,0,0,E.width,E.height);d.binary===!0?f.push(hr(E,o).then(m=>a.processBufferViewImage(m)).then(m=>{w.bufferView=m})):E.toDataURL!==void 0?w.uri=E.toDataURL(o):f.push(hr(E,o).then(lr).then(m=>{w.uri=m}));const M=i.images.push(w)-1;return v[x]=M,M}else throw new Error("THREE.GLTFExporter: No valid image data found. Unable to process texture.")}processSampler(e){const r=this.json;r.samplers||(r.samplers=[]);const n={magFilter:Pe[e.magFilter],minFilter:Pe[e.minFilter],wrapS:Pe[e.wrapS],wrapT:Pe[e.wrapT]};return r.samplers.push(n)-1}processTexture(e){const r=this.options,n=this.cache,o=this.json;if(n.textures.has(e))return n.textures.get(e);o.textures||(o.textures=[]),e instanceof Qt&&(e=un(e,r.maxTextureSize));let a=e.userData.mimeType;a==="image/webp"&&(a="image/png");const s={sampler:this.processSampler(e),source:this.processImage(e.image,e.format,e.flipY,a)};e.name&&(s.name=e.name),this._invokeAll(function(d){d.writeTexture&&d.writeTexture(e,s)});const i=o.textures.push(s)-1;return n.textures.set(e,i),i}processMaterial(e){const r=this.cache,n=this.json;if(r.materials.has(e))return r.materials.get(e);if(e.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;n.materials||(n.materials=[]);const o={pbrMetallicRoughness:{}};e.isMeshStandardMaterial!==!0&&e.isMeshBasicMaterial!==!0&&console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");const a=e.color.toArray().concat([e.opacity]);if(mt(a,[1,1,1,1])||(o.pbrMetallicRoughness.baseColorFactor=a),e.isMeshStandardMaterial?(o.pbrMetallicRoughness.metallicFactor=e.metalness,o.pbrMetallicRoughness.roughnessFactor=e.roughness):(o.pbrMetallicRoughness.metallicFactor=.5,o.pbrMetallicRoughness.roughnessFactor=.5),e.metalnessMap||e.roughnessMap){const i=this.buildMetalRoughTexture(e.metalnessMap,e.roughnessMap),d={index:this.processTexture(i),channel:i.channel};this.applyTextureTransform(d,i),o.pbrMetallicRoughness.metallicRoughnessTexture=d}if(e.map){const i={index:this.processTexture(e.map),texCoord:e.map.channel};this.applyTextureTransform(i,e.map),o.pbrMetallicRoughness.baseColorTexture=i}if(e.emissive){const i=e.emissive;if(Math.max(i.r,i.g,i.b)>0&&(o.emissiveFactor=e.emissive.toArray()),e.emissiveMap){const d={index:this.processTexture(e.emissiveMap),texCoord:e.emissiveMap.channel};this.applyTextureTransform(d,e.emissiveMap),o.emissiveTexture=d}}if(e.normalMap){const i={index:this.processTexture(e.normalMap),texCoord:e.normalMap.channel};e.normalScale&&e.normalScale.x!==1&&(i.scale=e.normalScale.x),this.applyTextureTransform(i,e.normalMap),o.normalTexture=i}if(e.aoMap){const i={index:this.processTexture(e.aoMap),texCoord:e.aoMap.channel};e.aoMapIntensity!==1&&(i.strength=e.aoMapIntensity),this.applyTextureTransform(i,e.aoMap),o.occlusionTexture=i}e.transparent?o.alphaMode="BLEND":e.alphaTest>0&&(o.alphaMode="MASK",o.alphaCutoff=e.alphaTest),e.side===Ht&&(o.doubleSided=!0),e.name!==""&&(o.name=e.name),this.serializeUserData(e,o),this._invokeAll(function(i){i.writeMaterial&&i.writeMaterial(e,o)});const s=n.materials.push(o)-1;return r.materials.set(e,s),s}processMesh(e){const r=this.cache,n=this.json,o=[e.geometry.uuid];if(Array.isArray(e.material))for(let T=0,O=e.material.length;T<O;T++)o.push(e.material[T].uuid);else o.push(e.material.uuid);const a=o.join(":");if(r.meshes.has(a))return r.meshes.get(a);const s=e.geometry;let i;e.isLineSegments?i=ee.LINES:e.isLineLoop?i=ee.LINE_LOOP:e.isLine?i=ee.LINE_STRIP:e.isPoints?i=ee.POINTS:i=e.material.wireframe?ee.LINES:ee.TRIANGLES;const d={},f={},v=[],x=[],w={...Un>=152?{uv:"TEXCOORD_0",uv1:"TEXCOORD_1",uv2:"TEXCOORD_2",uv3:"TEXCOORD_3"}:{uv:"TEXCOORD_0",uv2:"TEXCOORD_1"},color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},E=s.getAttribute("normal");E!==void 0&&!this.isNormalizedNormalAttribute(E)&&(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),s.setAttribute("normal",this.createNormalizedNormalAttribute(E)));let g=null;for(let T in s.attributes){if(T.slice(0,5)==="morph")continue;const O=s.attributes[T];if(T=w[T]||T.toUpperCase(),/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(T)||(T="_"+T),r.attributes.has(this.getUID(O))){f[T]=r.attributes.get(this.getUID(O));continue}g=null;const S=O.array;T==="JOINTS_0"&&!(S instanceof Uint16Array)&&!(S instanceof Uint8Array)&&(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),g=new pt(new Uint16Array(S),O.itemSize,O.normalized));const h=this.processAccessor(g||O,s);h!==null&&(T.startsWith("_")||this.detectMeshQuantization(T,O),f[T]=h,r.attributes.set(this.getUID(O),h))}if(E!==void 0&&s.setAttribute("normal",E),Object.keys(f).length===0)return null;if(e.morphTargetInfluences!==void 0&&e.morphTargetInfluences.length>0){const T=[],O=[],S={};if(e.morphTargetDictionary!==void 0)for(const h in e.morphTargetDictionary)S[e.morphTargetDictionary[h]]=h;for(let h=0;h<e.morphTargetInfluences.length;++h){const _={};let p=!1;for(const u in s.morphAttributes){if(u!=="position"&&u!=="normal"){p||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),p=!0);continue}const l=s.morphAttributes[u][h],b=u.toUpperCase(),A=s.attributes[u];if(r.attributes.has(this.getUID(l,!0))){_[b]=r.attributes.get(this.getUID(l,!0));continue}const N=l.clone();if(!s.morphTargetsRelative)for(let B=0,U=l.count;B<U;B++)for(let D=0;D<l.itemSize;D++)D===0&&N.setX(B,l.getX(B)-A.getX(B)),D===1&&N.setY(B,l.getY(B)-A.getY(B)),D===2&&N.setZ(B,l.getZ(B)-A.getZ(B)),D===3&&N.setW(B,l.getW(B)-A.getW(B));_[b]=this.processAccessor(N,s),r.attributes.set(this.getUID(A,!0),_[b])}x.push(_),T.push(e.morphTargetInfluences[h]),e.morphTargetDictionary!==void 0&&O.push(S[h])}d.weights=T,O.length>0&&(d.extras={},d.extras.targetNames=O)}const M=Array.isArray(e.material);if(M&&s.groups.length===0)return null;const m=M?e.material:[e.material],R=M?s.groups:[{materialIndex:0,start:void 0,count:void 0}];for(let T=0,O=R.length;T<O;T++){const S={mode:i,attributes:f};if(this.serializeUserData(s,S),x.length>0&&(S.targets=x),s.index!==null){let _=this.getUID(s.index);(R[T].start!==void 0||R[T].count!==void 0)&&(_+=":"+R[T].start+":"+R[T].count),r.attributes.has(_)?S.indices=r.attributes.get(_):(S.indices=this.processAccessor(s.index,s,R[T].start,R[T].count),r.attributes.set(_,S.indices)),S.indices===null&&delete S.indices}const h=this.processMaterial(m[R[T].materialIndex]);h!==null&&(S.material=h),v.push(S)}d.primitives=v,n.meshes||(n.meshes=[]),this._invokeAll(function(T){T.writeMesh&&T.writeMesh(e,d)});const P=n.meshes.push(d)-1;return r.meshes.set(a,P),P}detectMeshQuantization(e,r){if(this.extensionsUsed[cn])return;let n;switch(r.array.constructor){case Int8Array:n="byte";break;case Uint8Array:n="unsigned byte";break;case Int16Array:n="short";break;case Uint16Array:n="unsigned short";break;default:return}r.normalized&&(n+=" normalized");const o=e.split("_",1)[0];ur[o]&&ur[o].includes(n)&&(this.extensionsUsed[cn]=!0,this.extensionsRequired[cn]=!0)}processCamera(e){const r=this.json;r.cameras||(r.cameras=[]);const n=e.isOrthographicCamera,o={type:n?"orthographic":"perspective"};return n?o.orthographic={xmag:e.right*2,ymag:e.top*2,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near}:o.perspective={aspectRatio:e.aspect,yfov:He.degToRad(e.fov),zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near},e.name!==""&&(o.name=e.type),r.cameras.push(o)-1}processAnimation(e,r){const n=this.json,o=this.nodeMap;n.animations||(n.animations=[]),e=vo.Utils.mergeMorphTargetTracks(e.clone(),r);const a=e.tracks,s=[],i=[];for(let d=0;d<a.length;++d){const f=a[d],v=Vt.parseTrackName(f.name);let x=Vt.findNode(r,v.nodeName);const w=cr[v.propertyName];if(v.objectName==="bones"&&(x.isSkinnedMesh===!0?x=x.skeleton.getBoneByName(v.objectIndex):x=void 0),!x||!w)return console.warn('THREE.GLTFExporter: Could not export animation track "%s".',f.name),null;const E=1;let g=f.values.length/f.times.length;w===cr.morphTargetInfluences&&(g/=x.morphTargetInfluences.length);let M;f.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline===!0?(M="CUBICSPLINE",g/=3):f.getInterpolation()===Qo?M="STEP":M="LINEAR",i.push({input:this.processAccessor(new pt(f.times,E)),output:this.processAccessor(new pt(f.values,g)),interpolation:M}),s.push({sampler:i.length-1,target:{node:o.get(x),path:w}})}return n.animations.push({name:e.name||"clip_"+n.animations.length,samplers:i,channels:s}),n.animations.length-1}processSkin(e){const r=this.json,n=this.nodeMap,o=r.nodes[n.get(e)],a=e.skeleton;if(a===void 0)return null;const s=e.skeleton.bones[0];if(s===void 0)return null;const i=[],d=new Float32Array(a.bones.length*16),f=new wt;for(let v=0;v<a.bones.length;++v)i.push(n.get(a.bones[v])),f.copy(a.boneInverses[v]),f.multiply(e.bindMatrix).toArray(d,v*16);return r.skins===void 0&&(r.skins=[]),r.skins.push({inverseBindMatrices:this.processAccessor(new pt(d,16)),joints:i,skeleton:n.get(s)}),o.skin=r.skins.length-1}processNode(e){const r=this.json,n=this.options,o=this.nodeMap;r.nodes||(r.nodes=[]);const a={};if(n.trs){const i=e.quaternion.toArray(),d=e.position.toArray(),f=e.scale.toArray();mt(i,[0,0,0,1])||(a.rotation=i),mt(d,[0,0,0])||(a.translation=d),mt(f,[1,1,1])||(a.scale=f)}else e.matrixAutoUpdate&&e.updateMatrix(),Gs(e.matrix)===!1&&(a.matrix=e.matrix.elements);if(e.name!==""&&(a.name=String(e.name)),this.serializeUserData(e,a),e.isMesh||e.isLine||e.isPoints){const i=this.processMesh(e);i!==null&&(a.mesh=i)}else e.isCamera&&(a.camera=this.processCamera(e));if(e.isSkinnedMesh&&this.skins.push(e),e.children.length>0){const i=[];for(let d=0,f=e.children.length;d<f;d++){const v=e.children[d];if(v.visible||n.onlyVisible===!1){const x=this.processNode(v);x!==null&&i.push(x)}}i.length>0&&(a.children=i)}this._invokeAll(function(i){i.writeNode&&i.writeNode(e,a)});const s=r.nodes.push(a)-1;return o.set(e,s),s}processScene(e){const r=this.json,n=this.options;r.scenes||(r.scenes=[],r.scene=0);const o={};e.name!==""&&(o.name=e.name),r.scenes.push(o);const a=[];for(let s=0,i=e.children.length;s<i;s++){const d=e.children[s];if(d.visible||n.onlyVisible===!1){const f=this.processNode(d);f!==null&&a.push(f)}}a.length>0&&(o.nodes=a),this.serializeUserData(e,o)}processObjects(e){const r=new bt;r.name="AuxScene";for(let n=0;n<e.length;n++)r.children.push(e[n]);this.processScene(r)}processInput(e){const r=this.options;e=e instanceof Array?e:[e],this._invokeAll(function(o){o.beforeParse&&o.beforeParse(e)});const n=[];for(let o=0;o<e.length;o++)e[o]instanceof bt?this.processScene(e[o]):n.push(e[o]);n.length>0&&this.processObjects(n);for(let o=0;o<this.skins.length;++o)this.processSkin(this.skins[o]);for(let o=0;o<r.animations.length;++o)this.processAnimation(r.animations[o],e[0]);this._invokeAll(function(o){o.afterParse&&o.afterParse(e)})}_invokeAll(e){for(let r=0,n=this.plugins.length;r<n;r++)e(this.plugins[r])}}class Ws{constructor(e){this.writer=e,this.name="KHR_lights_punctual"}writeNode(e,r){if(!e.isLight)return;if(!e.isDirectionalLight&&!e.isPointLight&&!e.isSpotLight){console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",e);return}const n=this.writer,o=n.json,a=n.extensionsUsed,s={};e.name&&(s.name=e.name),s.color=e.color.toArray(),s.intensity=e.intensity,e.isDirectionalLight?s.type="directional":e.isPointLight?(s.type="point",e.distance>0&&(s.range=e.distance)):e.isSpotLight&&(s.type="spot",e.distance>0&&(s.range=e.distance),s.spot={},s.spot.innerConeAngle=(e.penumbra-1)*e.angle*-1,s.spot.outerConeAngle=e.angle),e.decay!==void 0&&e.decay!==2&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),e.target&&(e.target.parent!==e||e.target.position.x!==0||e.target.position.y!==0||e.target.position.z!==-1)&&console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1."),a[this.name]||(o.extensions=o.extensions||{},o.extensions[this.name]={lights:[]},a[this.name]=!0);const i=o.extensions[this.name].lights;i.push(s),r.extensions=r.extensions||{},r.extensions[this.name]={light:i.length-1}}}let qs=class{constructor(t){this.writer=t,this.name="KHR_materials_unlit"}writeMaterial(t,e){if(!t.isMeshBasicMaterial)return;const r=this.writer.extensionsUsed;e.extensions=e.extensions||{},e.extensions[this.name]={},r[this.name]=!0,e.pbrMetallicRoughness.metallicFactor=0,e.pbrMetallicRoughness.roughnessFactor=.9}},Ks=class{constructor(t){this.writer=t,this.name="KHR_materials_clearcoat"}writeMaterial(t,e){if(!t.isMeshPhysicalMaterial||t.clearcoat===0)return;const r=this.writer,n=r.extensionsUsed,o={};if(o.clearcoatFactor=t.clearcoat,t.clearcoatMap){const a={index:r.processTexture(t.clearcoatMap),texCoord:t.clearcoatMap.channel};r.applyTextureTransform(a,t.clearcoatMap),o.clearcoatTexture=a}if(o.clearcoatRoughnessFactor=t.clearcoatRoughness,t.clearcoatRoughnessMap){const a={index:r.processTexture(t.clearcoatRoughnessMap),texCoord:t.clearcoatRoughnessMap.channel};r.applyTextureTransform(a,t.clearcoatRoughnessMap),o.clearcoatRoughnessTexture=a}if(t.clearcoatNormalMap){const a={index:r.processTexture(t.clearcoatNormalMap),texCoord:t.clearcoatNormalMap.channel};r.applyTextureTransform(a,t.clearcoatNormalMap),o.clearcoatNormalTexture=a}e.extensions=e.extensions||{},e.extensions[this.name]=o,n[this.name]=!0}},Zs=class{constructor(t){this.writer=t,this.name="KHR_materials_iridescence"}writeMaterial(t,e){if(!t.isMeshPhysicalMaterial||t.iridescence===0)return;const r=this.writer,n=r.extensionsUsed,o={};if(o.iridescenceFactor=t.iridescence,t.iridescenceMap){const a={index:r.processTexture(t.iridescenceMap),texCoord:t.iridescenceMap.channel};r.applyTextureTransform(a,t.iridescenceMap),o.iridescenceTexture=a}if(o.iridescenceIor=t.iridescenceIOR,o.iridescenceThicknessMinimum=t.iridescenceThicknessRange[0],o.iridescenceThicknessMaximum=t.iridescenceThicknessRange[1],t.iridescenceThicknessMap){const a={index:r.processTexture(t.iridescenceThicknessMap),texCoord:t.iridescenceThicknessMap.channel};r.applyTextureTransform(a,t.iridescenceThicknessMap),o.iridescenceThicknessTexture=a}e.extensions=e.extensions||{},e.extensions[this.name]=o,n[this.name]=!0}},Xs=class{constructor(t){this.writer=t,this.name="KHR_materials_transmission"}writeMaterial(t,e){if(!t.isMeshPhysicalMaterial||t.transmission===0)return;const r=this.writer,n=r.extensionsUsed,o={};if(o.transmissionFactor=t.transmission,t.transmissionMap){const a={index:r.processTexture(t.transmissionMap),texCoord:t.transmissionMap.channel};r.applyTextureTransform(a,t.transmissionMap),o.transmissionTexture=a}e.extensions=e.extensions||{},e.extensions[this.name]=o,n[this.name]=!0}},Js=class{constructor(t){this.writer=t,this.name="KHR_materials_volume"}writeMaterial(t,e){if(!t.isMeshPhysicalMaterial||t.transmission===0)return;const r=this.writer,n=r.extensionsUsed,o={};if(o.thicknessFactor=t.thickness,t.thicknessMap){const a={index:r.processTexture(t.thicknessMap),texCoord:t.thicknessMap.channel};r.applyTextureTransform(a,t.thicknessMap),o.thicknessTexture=a}o.attenuationDistance=t.attenuationDistance,o.attenuationColor=t.attenuationColor.toArray(),e.extensions=e.extensions||{},e.extensions[this.name]=o,n[this.name]=!0}},Qs=class{constructor(t){this.writer=t,this.name="KHR_materials_ior"}writeMaterial(t,e){if(!t.isMeshPhysicalMaterial||t.ior===1.5)return;const r=this.writer.extensionsUsed,n={};n.ior=t.ior,e.extensions=e.extensions||{},e.extensions[this.name]=n,r[this.name]=!0}},el=class{constructor(t){this.writer=t,this.name="KHR_materials_specular"}writeMaterial(t,e){if(!t.isMeshPhysicalMaterial||t.specularIntensity===1&&t.specularColor.equals(Us)&&!t.specularIntensityMap&&!t.specularColorTexture)return;const r=this.writer,n=r.extensionsUsed,o={};if(t.specularIntensityMap){const a={index:r.processTexture(t.specularIntensityMap),texCoord:t.specularIntensityMap.channel};r.applyTextureTransform(a,t.specularIntensityMap),o.specularTexture=a}if(t.specularColorMap){const a={index:r.processTexture(t.specularColorMap),texCoord:t.specularColorMap.channel};r.applyTextureTransform(a,t.specularColorMap),o.specularColorTexture=a}o.specularFactor=t.specularIntensity,o.specularColorFactor=t.specularColor.toArray(),e.extensions=e.extensions||{},e.extensions[this.name]=o,n[this.name]=!0}},tl=class{constructor(t){this.writer=t,this.name="KHR_materials_sheen"}writeMaterial(t,e){if(!t.isMeshPhysicalMaterial||t.sheen==0)return;const r=this.writer,n=r.extensionsUsed,o={};if(t.sheenRoughnessMap){const a={index:r.processTexture(t.sheenRoughnessMap),texCoord:t.sheenRoughnessMap.channel};r.applyTextureTransform(a,t.sheenRoughnessMap),o.sheenRoughnessTexture=a}if(t.sheenColorMap){const a={index:r.processTexture(t.sheenColorMap),texCoord:t.sheenColorMap.channel};r.applyTextureTransform(a,t.sheenColorMap),o.sheenColorTexture=a}o.sheenRoughnessFactor=t.sheenRoughness,o.sheenColorFactor=t.sheenColor.toArray(),e.extensions=e.extensions||{},e.extensions[this.name]=o,n[this.name]=!0}},nl=class{constructor(t){this.writer=t,this.name="KHR_materials_anisotropy"}writeMaterial(t,e){if(!t.isMeshPhysicalMaterial||t.anisotropy==0)return;const r=this.writer,n=r.extensionsUsed,o={};if(t.anisotropyMap){const a={index:r.processTexture(t.anisotropyMap)};r.applyTextureTransform(a,t.anisotropyMap),o.anisotropyTexture=a}o.anisotropyStrength=t.anisotropy,o.anisotropyRotation=t.anisotropyRotation,e.extensions=e.extensions||{},e.extensions[this.name]=o,n[this.name]=!0}},rl=class{constructor(t){this.writer=t,this.name="KHR_materials_emissive_strength"}writeMaterial(t,e){if(!t.isMeshStandardMaterial||t.emissiveIntensity===1)return;const r=this.writer.extensionsUsed,n={};n.emissiveStrength=t.emissiveIntensity,e.extensions=e.extensions||{},e.extensions[this.name]=n,r[this.name]=!0}};var Et=Uint8Array,bo=Uint16Array,ol=Uint32Array,al=new Et([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),il=new Et([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),wo=function(t,e){for(var r=new bo(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var o=new ol(r[30]),n=1;n<30;++n)for(var a=r[n];a<r[n+1];++a)o[a]=a-r[n]<<5|n;return[r,o]},xo=wo(al,2),sl=xo[0],ll=xo[1];sl[28]=258,ll[258]=28;wo(il,0);var ul=new bo(32768);for(var fe=0;fe<32768;++fe){var Ve=(fe&43690)>>>1|(fe&21845)<<1;Ve=(Ve&52428)>>>2|(Ve&13107)<<2,Ve=(Ve&61680)>>>4|(Ve&3855)<<4,ul[fe]=((Ve&65280)>>>8|(Ve&255)<<8)>>>1}var qt=new Et(288);for(var fe=0;fe<144;++fe)qt[fe]=8;for(var fe=144;fe<256;++fe)qt[fe]=9;for(var fe=256;fe<280;++fe)qt[fe]=7;for(var fe=280;fe<288;++fe)qt[fe]=8;var cl=new Et(32);for(var fe=0;fe<32;++fe)cl[fe]=5;var fl=new Et(0),pl=typeof TextDecoder<"u"&&new TextDecoder,dl=0;try{pl.decode(fl,{stream:!0}),dl=1}catch{}var hl=Object.defineProperty,ml=(t,e,r)=>e in t?hl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,gl=(t,e,r)=>(ml(t,e+"",r),r);const _o=class extends Ze{constructor(t,e={}){super(t),this.isReflector=!0,this.type="Reflector",this.camera=new De;const r=this,n=e.color!==void 0?new Ee(e.color):new Ee(8355711),o=e.textureWidth||512,a=e.textureHeight||512,s=e.clipBias||0,i=e.shader||_o.ReflectorShader,d=e.multisample!==void 0?e.multisample:4,f=new Ur,v=new Z,x=new Z,w=new Z,E=new wt,g=new Z(0,0,-1),M=new $e,m=new Z,R=new Z,P=new $e,T=new wt,O=this.camera,S=new Xo(o,a,{samples:d,type:Jo}),h=new Mt({uniforms:Rn.clone(i.uniforms),fragmentShader:i.fragmentShader,vertexShader:i.vertexShader});h.uniforms.tDiffuse.value=S.texture,h.uniforms.color.value=n,h.uniforms.textureMatrix.value=T,this.material=h,this.onBeforeRender=function(_,p,u){if(x.setFromMatrixPosition(r.matrixWorld),w.setFromMatrixPosition(u.matrixWorld),E.extractRotation(r.matrixWorld),v.set(0,0,1),v.applyMatrix4(E),m.subVectors(x,w),m.dot(v)>0)return;m.reflect(v).negate(),m.add(x),E.extractRotation(u.matrixWorld),g.set(0,0,-1),g.applyMatrix4(E),g.add(w),R.subVectors(x,g),R.reflect(v).negate(),R.add(x),O.position.copy(m),O.up.set(0,1,0),O.up.applyMatrix4(E),O.up.reflect(v),O.lookAt(R),O.far=u.far,O.updateMatrixWorld(),O.projectionMatrix.copy(u.projectionMatrix),T.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),T.multiply(O.projectionMatrix),T.multiply(O.matrixWorldInverse),T.multiply(r.matrixWorld),f.setFromNormalAndCoplanarPoint(v,x),f.applyMatrix4(O.matrixWorldInverse),M.set(f.normal.x,f.normal.y,f.normal.z,f.constant);const l=O.projectionMatrix;P.x=(Math.sign(M.x)+l.elements[8])/l.elements[0],P.y=(Math.sign(M.y)+l.elements[9])/l.elements[5],P.z=-1,P.w=(1+l.elements[10])/l.elements[14],M.multiplyScalar(2/M.dot(P)),l.elements[2]=M.x,l.elements[6]=M.y,l.elements[10]=M.z+1-s,l.elements[14]=M.w,r.visible=!1;const b=_.getRenderTarget(),A=_.xr.enabled,N=_.shadowMap.autoUpdate,B=_.toneMapping;let U=!1;"outputColorSpace"in _?U=_.outputColorSpace==="srgb":U=_.outputEncoding===3001,_.xr.enabled=!1,_.shadowMap.autoUpdate=!1,"outputColorSpace"in _?_.outputColorSpace="srgb-linear":_.outputEncoding=3e3,_.toneMapping=jr,_.setRenderTarget(S),_.state.buffers.depth.setMask(!0),_.autoClear===!1&&_.clear(),_.render(p,O),_.xr.enabled=A,_.shadowMap.autoUpdate=N,_.toneMapping=B,"outputColorSpace"in _?_.outputColorSpace=U?"srgb":"srgb-linear":_.outputEncoding=U?3001:3e3,_.setRenderTarget(b);const D=u.viewport;D!==void 0&&_.state.viewport(D),r.visible=!0},this.getRenderTarget=function(){return S},this.dispose=function(){S.dispose(),r.material.dispose()}}};let An=_o;gl(An,"ReflectorShader",{uniforms:{color:{value:null},tDiffuse:{value:null},textureMatrix:{value:null}},vertexShader:`
		uniform mat4 textureMatrix;
		varying vec4 vUv;

		#include <common>
		#include <logdepthbuf_pars_vertex>

		void main() {

			vUv = textureMatrix * vec4( position, 1.0 );

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

			#include <logdepthbuf_vertex>

		}`,fragmentShader:`
		uniform vec3 color;
		uniform sampler2D tDiffuse;
		varying vec4 vUv;

		#include <logdepthbuf_pars_fragment>

		float blendOverlay( float base, float blend ) {

			return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );

		}

		vec3 blendOverlay( vec3 base, vec3 blend ) {

			return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );

		}

		void main() {

			#include <logdepthbuf_fragment>

			vec4 base = texture2DProj( tDiffuse, vUv );
			gl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );

			#include <tonemapping_fragment>
			#include <${Un>=154?"colorspace_fragment":"encodings_fragment"}>

		}`});var vl=Object.defineProperty,yl=(t,e,r)=>e in t?vl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Mo=(t,e,r)=>(yl(t,typeof e!="symbol"?e+"":e,r),r);const Kt=new Yo,bl=new Float32Array([-1,-1,0,0,0,1,-1,0,1,0,1,1,0,1,1,-1,1,0,0,1]),To=new Go(bl,5);Kt.setIndex([0,1,2,0,2,3]);Kt.setAttribute("position",new Br(To,3,0,!1));Kt.setAttribute("uv",new Br(To,2,3,!1));const In=class extends Ze{constructor(){super(In.Geometry,new Nr({opacity:0,transparent:!0})),this.isLensflare=!0,this.type="Lensflare",this.frustumCulled=!1,this.renderOrder=1/0;const t=new Z,e=new Z,r=new Hn(new Uint8Array(16*16*3),16,16,vn);r.minFilter=dt,r.magFilter=dt,r.wrapS=ht,r.wrapT=ht;const n=new Hn(new Uint8Array(16*16*3),16,16,vn);n.minFilter=dt,n.magFilter=dt,n.wrapS=ht,n.wrapT=ht;const o=In.Geometry,a=new en({uniforms:{scale:{value:null},screenPosition:{value:null}},vertexShader:`

				precision highp float;

				uniform vec3 screenPosition;
				uniform vec2 scale;

				attribute vec3 position;

				void main() {

					gl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );

				}`,fragmentShader:`

				precision highp float;

				void main() {

					gl_FragColor = vec4( 1.0, 0.0, 1.0, 1.0 );

				}`,depthTest:!0,depthWrite:!1,transparent:!1}),s=new en({uniforms:{map:{value:r},scale:{value:null},screenPosition:{value:null}},vertexShader:`

				precision highp float;

				uniform vec3 screenPosition;
				uniform vec2 scale;

				attribute vec3 position;
				attribute vec2 uv;

				varying vec2 vUV;

				void main() {

					vUV = uv;

					gl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );

				}`,fragmentShader:`

				precision highp float;

				uniform sampler2D map;

				varying vec2 vUV;

				void main() {

					gl_FragColor = texture2D( map, vUV );

				}`,depthTest:!1,depthWrite:!1,transparent:!1}),i=new Ze(o,a),d=[],f=Eo.Shader,v=new en({uniforms:{map:{value:null},occlusionMap:{value:n},color:{value:new Ee(16777215)},scale:{value:new ve},screenPosition:{value:new Z}},vertexShader:f.vertexShader,fragmentShader:f.fragmentShader,blending:ea,transparent:!0,depthWrite:!1}),x=new Ze(o,v);this.addElement=function(m){d.push(m)};const w=new ve,E=new ve,g=new ta,M=new $e;this.onBeforeRender=function(m,R,P){m.getCurrentViewport(M);const T=M.w/M.z,O=M.z/2,S=M.w/2;let h=16/M.w;if(w.set(h*T,h),g.min.set(M.x,M.y),g.max.set(M.x+(M.z-16),M.y+(M.w-16)),e.setFromMatrixPosition(this.matrixWorld),e.applyMatrix4(P.matrixWorldInverse),!(e.z>0)&&(t.copy(e).applyMatrix4(P.projectionMatrix),E.x=M.x+t.x*O+O-8,E.y=M.y+t.y*S+S-8,g.containsPoint(E))){m.copyFramebufferToTexture(E,r);let _=a.uniforms;_.scale.value=w,_.screenPosition.value=t,m.renderBufferDirect(P,null,o,a,i,null),m.copyFramebufferToTexture(E,n),_=s.uniforms,_.scale.value=w,_.screenPosition.value=t,m.renderBufferDirect(P,null,o,s,i,null);const p=-t.x*2,u=-t.y*2;for(let l=0,b=d.length;l<b;l++){const A=d[l],N=v.uniforms;N.color.value.copy(A.color),N.map.value=A.texture,N.screenPosition.value.x=t.x+p*A.distance,N.screenPosition.value.y=t.y+u*A.distance,h=A.size/M.w;const B=M.w/M.z;N.scale.value.set(h*B,h),v.uniformsNeedUpdate=!0,m.renderBufferDirect(P,null,o,v,x,null)}}},this.dispose=function(){a.dispose(),s.dispose(),v.dispose(),r.dispose(),n.dispose();for(let m=0,R=d.length;m<R;m++)d[m].texture.dispose()}}};let wl=In;Mo(wl,"Geometry",Kt);class Eo{constructor(e,r=1,n=0,o=new Ee(16777215)){this.texture=e,this.size=r,this.distance=n,this.color=o}}Mo(Eo,"Shader",{uniforms:{map:{value:null},occlusionMap:{value:null},color:{value:null},scale:{value:null},screenPosition:{value:null}},vertexShader:`

		precision highp float;

		uniform vec3 screenPosition;
		uniform vec2 scale;

		uniform sampler2D occlusionMap;

		attribute vec3 position;
		attribute vec2 uv;

		varying vec2 vUV;
		varying float vVisibility;

		void main() {

			vUV = uv;

			vec2 pos = position.xy;

			vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );
			visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );
			visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );
			visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );
			visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );
			visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );
			visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );
			visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );
			visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );

			vVisibility =        visibility.r / 9.0;
			vVisibility *= 1.0 - visibility.g / 9.0;
			vVisibility *=       visibility.b / 9.0;

			gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );

		}`,fragmentShader:`

		precision highp float;

		uniform sampler2D map;
		uniform vec3 color;

		varying vec2 vUV;
		varying float vVisibility;

		void main() {

			vec4 texture = texture2D( map, vUV );
			texture.a *= vVisibility;
			gl_FragColor = texture;
			gl_FragColor.rgb *= color;

		}`});var xl=Object.defineProperty,_l=(t,e,r)=>e in t?xl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ao=(t,e,r)=>(_l(t,typeof e!="symbol"?e+"":e,r),r);const Lt={uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new Z},up:{value:new Z(0,1,0)}},vertexShader:`
      uniform vec3 sunPosition;
      uniform float rayleigh;
      uniform float turbidity;
      uniform float mieCoefficient;
      uniform vec3 up;

      varying vec3 vWorldPosition;
      varying vec3 vSunDirection;
      varying float vSunfade;
      varying vec3 vBetaR;
      varying vec3 vBetaM;
      varying float vSunE;

      // constants for atmospheric scattering
      const float e = 2.71828182845904523536028747135266249775724709369995957;
      const float pi = 3.141592653589793238462643383279502884197169;

      // wavelength of used primaries, according to preetham
      const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );
      // this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:
      // (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))
      const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );

      // mie stuff
      // K coefficient for the primaries
      const float v = 4.0;
      const vec3 K = vec3( 0.686, 0.678, 0.666 );
      // MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K
      const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );

      // earth shadow hack
      // cutoffAngle = pi / 1.95;
      const float cutoffAngle = 1.6110731556870734;
      const float steepness = 1.5;
      const float EE = 1000.0;

      float sunIntensity( float zenithAngleCos ) {
        zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );
        return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );
      }

      vec3 totalMie( float T ) {
        float c = ( 0.2 * T ) * 10E-18;
        return 0.434 * c * MieConst;
      }

      void main() {

        vec4 worldPosition = modelMatrix * vec4( position, 1.0 );
        vWorldPosition = worldPosition.xyz;

        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        gl_Position.z = gl_Position.w; // set z to camera.far

        vSunDirection = normalize( sunPosition );

        vSunE = sunIntensity( dot( vSunDirection, up ) );

        vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );

        float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );

      // extinction (absorbtion + out scattering)
      // rayleigh coefficients
        vBetaR = totalRayleigh * rayleighCoefficient;

      // mie coefficients
        vBetaM = totalMie( turbidity ) * mieCoefficient;

      }
    `,fragmentShader:`
      varying vec3 vWorldPosition;
      varying vec3 vSunDirection;
      varying float vSunfade;
      varying vec3 vBetaR;
      varying vec3 vBetaM;
      varying float vSunE;

      uniform float mieDirectionalG;
      uniform vec3 up;

      const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );

      // constants for atmospheric scattering
      const float pi = 3.141592653589793238462643383279502884197169;

      const float n = 1.0003; // refractive index of air
      const float N = 2.545E25; // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)

      // optical length at zenith for molecules
      const float rayleighZenithLength = 8.4E3;
      const float mieZenithLength = 1.25E3;
      // 66 arc seconds -> degrees, and the cosine of that
      const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;

      // 3.0 / ( 16.0 * pi )
      const float THREE_OVER_SIXTEENPI = 0.05968310365946075;
      // 1.0 / ( 4.0 * pi )
      const float ONE_OVER_FOURPI = 0.07957747154594767;

      float rayleighPhase( float cosTheta ) {
        return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );
      }

      float hgPhase( float cosTheta, float g ) {
        float g2 = pow( g, 2.0 );
        float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );
        return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );
      }

      void main() {

        vec3 direction = normalize( vWorldPosition - cameraPos );

      // optical length
      // cutoff angle at 90 to avoid singularity in next formula.
        float zenithAngle = acos( max( 0.0, dot( up, direction ) ) );
        float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );
        float sR = rayleighZenithLength * inverse;
        float sM = mieZenithLength * inverse;

      // combined extinction factor
        vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );

      // in scattering
        float cosTheta = dot( direction, vSunDirection );

        float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );
        vec3 betaRTheta = vBetaR * rPhase;

        float mPhase = hgPhase( cosTheta, mieDirectionalG );
        vec3 betaMTheta = vBetaM * mPhase;

        vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );
        Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );

      // nightsky
        float theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]
        float phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]
        vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );
        vec3 L0 = vec3( 0.1 ) * Fex;

      // composition + solar disc
        float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );
        L0 += ( vSunE * 19000.0 * Fex ) * sundisk;

        vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );

        vec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );

        gl_FragColor = vec4( retColor, 1.0 );

      #include <tonemapping_fragment>
      #include <${Un>=154?"colorspace_fragment":"encodings_fragment"}>

      }
    `},Io=new Mt({name:"SkyShader",fragmentShader:Lt.fragmentShader,vertexShader:Lt.vertexShader,uniforms:Rn.clone(Lt.uniforms),side:Ho,depthWrite:!1});class Po extends Ze{constructor(){super(new Zo(1,1,1),Io)}}Ao(Po,"SkyShader",Lt);Ao(Po,"material",Io);new $o;new Z;new Vr(0,0,0,"YXZ");new Z;var Ml=Object.defineProperty,Tl=(t,e,r)=>e in t?Ml(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Y=(t,e,r)=>(Tl(t,typeof e!="symbol"?e+"":e,r),r);const Dt=new Wo,mr=new Ur,El=Math.cos(70*(Math.PI/180)),gr=(t,e)=>(t%e+e)%e;class Al extends sa{constructor(e,r){super(),Y(this,"object"),Y(this,"domElement"),Y(this,"enabled",!0),Y(this,"target",new Z),Y(this,"minDistance",0),Y(this,"maxDistance",1/0),Y(this,"minZoom",0),Y(this,"maxZoom",1/0),Y(this,"minPolarAngle",0),Y(this,"maxPolarAngle",Math.PI),Y(this,"minAzimuthAngle",-1/0),Y(this,"maxAzimuthAngle",1/0),Y(this,"enableDamping",!1),Y(this,"dampingFactor",.05),Y(this,"enableZoom",!0),Y(this,"zoomSpeed",1),Y(this,"enableRotate",!0),Y(this,"rotateSpeed",1),Y(this,"enablePan",!0),Y(this,"panSpeed",1),Y(this,"screenSpacePanning",!0),Y(this,"keyPanSpeed",7),Y(this,"zoomToCursor",!1),Y(this,"autoRotate",!1),Y(this,"autoRotateSpeed",2),Y(this,"reverseOrbit",!1),Y(this,"reverseHorizontalOrbit",!1),Y(this,"reverseVerticalOrbit",!1),Y(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),Y(this,"mouseButtons",{LEFT:Fe.ROTATE,MIDDLE:Fe.DOLLY,RIGHT:Fe.PAN}),Y(this,"touches",{ONE:Ye.ROTATE,TWO:Ye.DOLLY_PAN}),Y(this,"target0"),Y(this,"position0"),Y(this,"zoom0"),Y(this,"_domElementKeyEvents",null),Y(this,"getPolarAngle"),Y(this,"getAzimuthalAngle"),Y(this,"setPolarAngle"),Y(this,"setAzimuthalAngle"),Y(this,"getDistance"),Y(this,"getZoomScale"),Y(this,"listenToKeyEvents"),Y(this,"stopListenToKeyEvents"),Y(this,"saveState"),Y(this,"reset"),Y(this,"update"),Y(this,"connect"),Y(this,"dispose"),Y(this,"dollyIn"),Y(this,"dollyOut"),Y(this,"getScale"),Y(this,"setScale"),this.object=e,this.domElement=r,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>v.phi,this.getAzimuthalAngle=()=>v.theta,this.setPolarAngle=C=>{let V=gr(C,2*Math.PI),$=v.phi;$<0&&($+=2*Math.PI),V<0&&(V+=2*Math.PI);let ie=Math.abs(V-$);2*Math.PI-ie<ie&&(V<$?V+=2*Math.PI:$+=2*Math.PI),x.phi=V-$,n.update()},this.setAzimuthalAngle=C=>{let V=gr(C,2*Math.PI),$=v.theta;$<0&&($+=2*Math.PI),V<0&&(V+=2*Math.PI);let ie=Math.abs(V-$);2*Math.PI-ie<ie&&(V<$?V+=2*Math.PI:$+=2*Math.PI),x.theta=V-$,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=C=>{C.addEventListener("keydown",at),this._domElementKeyEvents=C},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",at),this._domElementKeyEvents=null},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(o),n.update(),d=i.NONE},this.update=(()=>{const C=new Z,V=new Z(0,1,0),$=new Wn().setFromUnitVectors(e.up,V),ie=$.clone().invert(),Ae=new Z,Ce=new Wn,Pt=2*Math.PI;return function(){const Gn=n.object.position;$.setFromUnitVectors(e.up,V),ie.copy($).invert(),C.copy(Gn).sub(n.target),C.applyQuaternion($),v.setFromVector3(C),n.autoRotate&&d===i.NONE&&B(A()),n.enableDamping?(v.theta+=x.theta*n.dampingFactor,v.phi+=x.phi*n.dampingFactor):(v.theta+=x.theta,v.phi+=x.phi);let Ue=n.minAzimuthAngle,ze=n.maxAzimuthAngle;isFinite(Ue)&&isFinite(ze)&&(Ue<-Math.PI?Ue+=Pt:Ue>Math.PI&&(Ue-=Pt),ze<-Math.PI?ze+=Pt:ze>Math.PI&&(ze-=Pt),Ue<=ze?v.theta=Math.max(Ue,Math.min(ze,v.theta)):v.theta=v.theta>(Ue+ze)/2?Math.max(Ue,v.theta):Math.min(ze,v.theta)),v.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,v.phi)),v.makeSafe(),n.enableDamping===!0?n.target.addScaledVector(E,n.dampingFactor):n.target.add(E),n.zoomToCursor&&u||n.object.isOrthographicCamera?v.radius=de(v.radius):v.radius=de(v.radius*w),C.setFromSpherical(v),C.applyQuaternion(ie),Gn.copy(n.target).add(C),n.object.matrixAutoUpdate||n.object.updateMatrix(),n.object.lookAt(n.target),n.enableDamping===!0?(x.theta*=1-n.dampingFactor,x.phi*=1-n.dampingFactor,E.multiplyScalar(1-n.dampingFactor)):(x.set(0,0,0),E.set(0,0,0));let st=!1;if(n.zoomToCursor&&u){let lt=null;if(n.object instanceof De&&n.object.isPerspectiveCamera){const ut=C.length();lt=de(ut*w);const Ot=ut-lt;n.object.position.addScaledVector(_,Ot),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){const ut=new Z(p.x,p.y,0);ut.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/w)),n.object.updateProjectionMatrix(),st=!0;const Ot=new Z(p.x,p.y,0);Ot.unproject(n.object),n.object.position.sub(Ot).add(ut),n.object.updateMatrixWorld(),lt=C.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;lt!==null&&(n.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(lt).add(n.object.position):(Dt.origin.copy(n.object.position),Dt.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(Dt.direction))<El?e.lookAt(n.target):(mr.setFromNormalAndCoplanarPoint(n.object.up,n.target),Dt.intersectPlane(mr,n.target))))}else n.object instanceof gt&&n.object.isOrthographicCamera&&(st=w!==1,st&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/w)),n.object.updateProjectionMatrix()));return w=1,u=!1,st||Ae.distanceToSquared(n.object.position)>f||8*(1-Ce.dot(n.object.quaternion))>f?(n.dispatchEvent(o),Ae.copy(n.object.position),Ce.copy(n.object.quaternion),st=!1,!0):!1}})(),this.connect=C=>{n.domElement=C,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",Vn),n.domElement.addEventListener("pointerdown",ce),n.domElement.addEventListener("pointercancel",ke),n.domElement.addEventListener("wheel",It)},this.dispose=()=>{var C,V,$,ie,Ae,Ce;n.domElement&&(n.domElement.style.touchAction="auto"),(C=n.domElement)==null||C.removeEventListener("contextmenu",Vn),(V=n.domElement)==null||V.removeEventListener("pointerdown",ce),($=n.domElement)==null||$.removeEventListener("pointercancel",ke),(ie=n.domElement)==null||ie.removeEventListener("wheel",It),(Ae=n.domElement)==null||Ae.ownerDocument.removeEventListener("pointermove",Oe),(Ce=n.domElement)==null||Ce.ownerDocument.removeEventListener("pointerup",ke),n._domElementKeyEvents!==null&&n._domElementKeyEvents.removeEventListener("keydown",at)};const n=this,o={type:"change"},a={type:"start"},s={type:"end"},i={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let d=i.NONE;const f=1e-6,v=new $n,x=new $n;let w=1;const E=new Z,g=new ve,M=new ve,m=new ve,R=new ve,P=new ve,T=new ve,O=new ve,S=new ve,h=new ve,_=new Z,p=new ve;let u=!1;const l=[],b={};function A(){return 2*Math.PI/60/60*n.autoRotateSpeed}function N(){return Math.pow(.95,n.zoomSpeed)}function B(C){n.reverseOrbit||n.reverseHorizontalOrbit?x.theta+=C:x.theta-=C}function U(C){n.reverseOrbit||n.reverseVerticalOrbit?x.phi+=C:x.phi-=C}const D=(()=>{const C=new Z;return function(V,$){C.setFromMatrixColumn($,0),C.multiplyScalar(-V),E.add(C)}})(),J=(()=>{const C=new Z;return function(V,$){n.screenSpacePanning===!0?C.setFromMatrixColumn($,1):(C.setFromMatrixColumn($,0),C.crossVectors(n.object.up,C)),C.multiplyScalar(V),E.add(C)}})(),Q=(()=>{const C=new Z;return function(V,$){const ie=n.domElement;if(ie&&n.object instanceof De&&n.object.isPerspectiveCamera){const Ae=n.object.position;C.copy(Ae).sub(n.target);let Ce=C.length();Ce*=Math.tan(n.object.fov/2*Math.PI/180),D(2*V*Ce/ie.clientHeight,n.object.matrix),J(2*$*Ce/ie.clientHeight,n.object.matrix)}else ie&&n.object instanceof gt&&n.object.isOrthographicCamera?(D(V*(n.object.right-n.object.left)/n.object.zoom/ie.clientWidth,n.object.matrix),J($*(n.object.top-n.object.bottom)/n.object.zoom/ie.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function H(C){n.object instanceof De&&n.object.isPerspectiveCamera||n.object instanceof gt&&n.object.isOrthographicCamera?w=C:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function K(C){H(w/C)}function F(C){H(w*C)}function te(C){if(!n.zoomToCursor||!n.domElement)return;u=!0;const V=n.domElement.getBoundingClientRect(),$=C.clientX-V.left,ie=C.clientY-V.top,Ae=V.width,Ce=V.height;p.x=$/Ae*2-1,p.y=-(ie/Ce)*2+1,_.set(p.x,p.y,1).unproject(n.object).sub(n.object.position).normalize()}function de(C){return Math.max(n.minDistance,Math.min(n.maxDistance,C))}function ue(C){g.set(C.clientX,C.clientY)}function pe(C){te(C),O.set(C.clientX,C.clientY)}function we(C){R.set(C.clientX,C.clientY)}function _e(C){M.set(C.clientX,C.clientY),m.subVectors(M,g).multiplyScalar(n.rotateSpeed);const V=n.domElement;V&&(B(2*Math.PI*m.x/V.clientHeight),U(2*Math.PI*m.y/V.clientHeight)),g.copy(M),n.update()}function L(C){S.set(C.clientX,C.clientY),h.subVectors(S,O),h.y>0?K(N()):h.y<0&&F(N()),O.copy(S),n.update()}function c(C){P.set(C.clientX,C.clientY),T.subVectors(P,R).multiplyScalar(n.panSpeed),Q(T.x,T.y),R.copy(P),n.update()}function y(C){te(C),C.deltaY<0?F(N()):C.deltaY>0&&K(N()),n.update()}function I(C){let V=!1;switch(C.code){case n.keys.UP:Q(0,n.keyPanSpeed),V=!0;break;case n.keys.BOTTOM:Q(0,-n.keyPanSpeed),V=!0;break;case n.keys.LEFT:Q(n.keyPanSpeed,0),V=!0;break;case n.keys.RIGHT:Q(-n.keyPanSpeed,0),V=!0;break}V&&(C.preventDefault(),n.update())}function k(){if(l.length==1)g.set(l[0].pageX,l[0].pageY);else{const C=.5*(l[0].pageX+l[1].pageX),V=.5*(l[0].pageY+l[1].pageY);g.set(C,V)}}function j(){if(l.length==1)R.set(l[0].pageX,l[0].pageY);else{const C=.5*(l[0].pageX+l[1].pageX),V=.5*(l[0].pageY+l[1].pageY);R.set(C,V)}}function z(){const C=l[0].pageX-l[1].pageX,V=l[0].pageY-l[1].pageY,$=Math.sqrt(C*C+V*V);O.set(0,$)}function G(){n.enableZoom&&z(),n.enablePan&&j()}function re(){n.enableZoom&&z(),n.enableRotate&&k()}function se(C){if(l.length==1)M.set(C.pageX,C.pageY);else{const $=Jt(C),ie=.5*(C.pageX+$.x),Ae=.5*(C.pageY+$.y);M.set(ie,Ae)}m.subVectors(M,g).multiplyScalar(n.rotateSpeed);const V=n.domElement;V&&(B(2*Math.PI*m.x/V.clientHeight),U(2*Math.PI*m.y/V.clientHeight)),g.copy(M)}function X(C){if(l.length==1)P.set(C.pageX,C.pageY);else{const V=Jt(C),$=.5*(C.pageX+V.x),ie=.5*(C.pageY+V.y);P.set($,ie)}T.subVectors(P,R).multiplyScalar(n.panSpeed),Q(T.x,T.y),R.copy(P)}function oe(C){const V=Jt(C),$=C.pageX-V.x,ie=C.pageY-V.y,Ae=Math.sqrt($*$+ie*ie);S.set(0,Ae),h.set(0,Math.pow(S.y/O.y,n.zoomSpeed)),K(h.y),O.copy(S)}function he(C){n.enableZoom&&oe(C),n.enablePan&&X(C)}function ae(C){n.enableZoom&&oe(C),n.enableRotate&&se(C)}function ce(C){var V,$;n.enabled!==!1&&(l.length===0&&((V=n.domElement)==null||V.ownerDocument.addEventListener("pointermove",Oe),($=n.domElement)==null||$.ownerDocument.addEventListener("pointerup",ke)),So(C),C.pointerType==="touch"?Be(C):Zt(C))}function Oe(C){n.enabled!==!1&&(C.pointerType==="touch"?it(C):Xt(C))}function ke(C){var V,$,ie;jo(C),l.length===0&&((V=n.domElement)==null||V.releasePointerCapture(C.pointerId),($=n.domElement)==null||$.ownerDocument.removeEventListener("pointermove",Oe),(ie=n.domElement)==null||ie.ownerDocument.removeEventListener("pointerup",ke)),n.dispatchEvent(s),d=i.NONE}function Zt(C){let V;switch(C.button){case 0:V=n.mouseButtons.LEFT;break;case 1:V=n.mouseButtons.MIDDLE;break;case 2:V=n.mouseButtons.RIGHT;break;default:V=-1}switch(V){case Fe.DOLLY:if(n.enableZoom===!1)return;pe(C),d=i.DOLLY;break;case Fe.ROTATE:if(C.ctrlKey||C.metaKey||C.shiftKey){if(n.enablePan===!1)return;we(C),d=i.PAN}else{if(n.enableRotate===!1)return;ue(C),d=i.ROTATE}break;case Fe.PAN:if(C.ctrlKey||C.metaKey||C.shiftKey){if(n.enableRotate===!1)return;ue(C),d=i.ROTATE}else{if(n.enablePan===!1)return;we(C),d=i.PAN}break;default:d=i.NONE}d!==i.NONE&&n.dispatchEvent(a)}function Xt(C){if(n.enabled!==!1)switch(d){case i.ROTATE:if(n.enableRotate===!1)return;_e(C);break;case i.DOLLY:if(n.enableZoom===!1)return;L(C);break;case i.PAN:if(n.enablePan===!1)return;c(C);break}}function It(C){n.enabled===!1||n.enableZoom===!1||d!==i.NONE&&d!==i.ROTATE||(C.preventDefault(),n.dispatchEvent(a),y(C),n.dispatchEvent(s))}function at(C){n.enabled===!1||n.enablePan===!1||I(C)}function Be(C){switch(Yn(C),l.length){case 1:switch(n.touches.ONE){case Ye.ROTATE:if(n.enableRotate===!1)return;k(),d=i.TOUCH_ROTATE;break;case Ye.PAN:if(n.enablePan===!1)return;j(),d=i.TOUCH_PAN;break;default:d=i.NONE}break;case 2:switch(n.touches.TWO){case Ye.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;G(),d=i.TOUCH_DOLLY_PAN;break;case Ye.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;re(),d=i.TOUCH_DOLLY_ROTATE;break;default:d=i.NONE}break;default:d=i.NONE}d!==i.NONE&&n.dispatchEvent(a)}function it(C){switch(Yn(C),d){case i.TOUCH_ROTATE:if(n.enableRotate===!1)return;se(C),n.update();break;case i.TOUCH_PAN:if(n.enablePan===!1)return;X(C),n.update();break;case i.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;he(C),n.update();break;case i.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;ae(C),n.update();break;default:d=i.NONE}}function Vn(C){n.enabled!==!1&&C.preventDefault()}function So(C){l.push(C)}function jo(C){delete b[C.pointerId];for(let V=0;V<l.length;V++)if(l[V].pointerId==C.pointerId){l.splice(V,1);return}}function Yn(C){let V=b[C.pointerId];V===void 0&&(V=new ve,b[C.pointerId]=V),V.set(C.pageX,C.pageY)}function Jt(C){const V=C.pointerId===l[0].pointerId?l[1]:l[0];return b[V.pointerId]}this.dollyIn=(C=N())=>{F(C),n.update()},this.dollyOut=(C=N())=>{K(C),n.update()},this.getScale=()=>w,this.setScale=C=>{H(C),n.update()},this.getZoomScale=()=>N(),r!==void 0&&this.connect(r),this.update()}}new wt;new Z;class vr extends ra{constructor(e,r={}){const{bevelEnabled:n=!1,bevelSize:o=8,bevelThickness:a=10,font:s,height:i=50,size:d=100,lineHeight:f=1,letterSpacing:v=0,...x}=r;if(s===void 0)super();else{const w=s.generateShapes(e,d,{lineHeight:f,letterSpacing:v});super(w,{...x,bevelEnabled:n,bevelSize:o,bevelThickness:a,depth:i})}this.type="TextGeometry"}}new Vr;new Z;var Il=Object.defineProperty,Pl=(t,e,r)=>e in t?Il(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,zn=(t,e,r)=>(Pl(t,typeof e!="symbol"?e+"":e,r),r);class Ol extends oa{constructor(e){super(e)}load(e,r,n,o){const a=new aa(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,s=>{if(typeof s!="string")throw new Error("unsupported data type");const i=JSON.parse(s),d=this.parse(i);r&&r(d)},n,o)}loadAsync(e,r){return super.loadAsync(e,r)}parse(e){return new Fn(e)}}class Fn{constructor(e){zn(this,"data"),this.data=e}generateShapes(e,r=100,n){const o=[],a={letterSpacing:0,lineHeight:1,...n},s=Rl(e,r,this.data,a);for(let i=0,d=s.length;i<d;i++)Array.prototype.push.apply(o,s[i].toShapes(!1));return o}}zn(Fn,"isFont");zn(Fn,"type");function Rl(t,e,r,n){const o=Array.from(t),a=e/r.resolution,s=(r.boundingBox.yMax-r.boundingBox.yMin+r.underlineThickness)*a,i=[];let d=0,f=0;for(let v=0;v<o.length;v++){const x=o[v];if(x===`
`)d=0,f-=s*n.lineHeight;else{const w=Cl(x,a,d,f,r);w&&(d+=w.offsetX+n.letterSpacing,i.push(w.path))}}return i}function Cl(t,e,r,n,o){const a=o.glyphs[t]||o.glyphs["?"];if(!a){console.error('THREE.Font: character "'+t+'" does not exists in font family '+o.familyName+".");return}const s=new ia;let i,d,f,v,x,w,E,g;if(a.o){const M=a._cachedOutline||(a._cachedOutline=a.o.split(" "));for(let m=0,R=M.length;m<R;)switch(M[m++]){case"m":i=parseInt(M[m++])*e+r,d=parseInt(M[m++])*e+n,s.moveTo(i,d);break;case"l":i=parseInt(M[m++])*e+r,d=parseInt(M[m++])*e+n,s.lineTo(i,d);break;case"q":f=parseInt(M[m++])*e+r,v=parseInt(M[m++])*e+n,x=parseInt(M[m++])*e+r,w=parseInt(M[m++])*e+n,s.quadraticCurveTo(x,w,f,v);break;case"b":f=parseInt(M[m++])*e+r,v=parseInt(M[m++])*e+n,x=parseInt(M[m++])*e+r,w=parseInt(M[m++])*e+n,E=parseInt(M[m++])*e+r,g=parseInt(M[m++])*e+n,s.bezierCurveTo(x,w,E,g,f,v);break}}return{offsetX:a.ha*e,path:s}}new zr;new Z;new $e;new Z;new Z;new $e;new $e;new $e;new Z;new wt;new qo;new Z;new zr;new Ko;new $e;He.clamp;He.lerp;go({screenspace:!1,color:new Ee("black"),opacity:1,thickness:.05,size:new ve(1,1)},`#include <common>
   #include <morphtarget_pars_vertex>
   #include <skinning_pars_vertex>
   uniform float thickness;
   uniform bool screenspace;
   uniform vec2 size;
   void main() {
     #if defined (USE_SKINNING)
       #include <beginnormal_vertex>
       #include <morphnormal_vertex>
       #include <skinbase_vertex>
       #include <skinnormal_vertex>
       #include <defaultnormal_vertex>
     #endif
     #include <begin_vertex>
     #include <morphtarget_vertex>
     #include <skinning_vertex>
     #include <project_vertex>
     vec4 tNormal = vec4(normal, 0.0);
     vec4 tPosition = vec4(transformed, 1.0);
     #ifdef USE_INSTANCING
       tNormal = instanceMatrix * tNormal;
       tPosition = instanceMatrix * tPosition;
     #endif
     if (screenspace) {
       vec3 newPosition = tPosition.xyz + tNormal.xyz * thickness;
       gl_Position = projectionMatrix * modelViewMatrix * vec4(newPosition, 1.0); 
     } else {
       vec4 clipPosition = projectionMatrix * modelViewMatrix * tPosition;
       vec4 clipNormal = projectionMatrix * modelViewMatrix * tNormal;
       vec2 offset = normalize(clipNormal.xy) * thickness / size * clipPosition.w * 2.0;
       clipPosition.xy += offset;
       gl_Position = clipPosition;
     }
   }`,`uniform vec3 color;
   uniform float opacity;
   void main(){
     gl_FragColor = vec4(color, opacity);
     #include <tonemapping_fragment>
     #include <colorspace_fragment>
   }`);const Sl=["args","material-uniforms-color-value"];An.ReflectorShader;const jl=["args","center"],kl=Xe({__name:"Text3D",props:{font:{},text:{},size:{default:.5},height:{default:.2},curveSegments:{default:5},bevelEnabled:{type:Boolean,default:!0},bevelThickness:{default:.05},bevelSize:{default:.02},bevelOffset:{default:0},bevelSegments:{default:4},center:{type:Boolean,default:!1},needUpdates:{type:Boolean,default:!1}},async setup(t,{expose:e}){let r,n;const o=t,{center:a,font:s,text:i,needUpdates:d,size:f,height:v,curveSegments:x,bevelEnabled:w,bevelThickness:E,bevelSize:g,bevelOffset:M,bevelSegments:m}=Tt(o),{extend:R,invalidate:P}=ot();be(o,()=>P()),R({TextGeometry:vr});const T=new Ol,O=Sn(),S=ye(()=>{var u;return i!=null&&i.value?i.value:O.default?(u=O.default()[0].children)==null?void 0:u.trim():d.value?"":"TresJS"}),h=ne();e({instance:h});const _=([r,n]=Kr(()=>new Promise((u,l)=>{try{typeof s.value=="string"?T.load(s.value,b=>{u(b)}):u(s.value)}catch(b){l(console.error("cientos",b))}})),r=await r,n(),r),p=ye(()=>({font:_,size:me(f),height:me(v),curveSegments:me(x),bevelEnabled:me(w),bevelThickness:me(E),bevelSize:me(g),bevelOffset:me(M),bevelSegments:me(m)}));return Qe(()=>{h.value&&d.value&&(h.value.geometry.dispose(),h.value.geometry=new vr(S.value,p.value),a.value&&h.value.geometry.center())}),(u,l)=>q(s)?(Ie(),Se("TresMesh",{key:0,ref_key:"text3DRef",ref:h},[S.value?(Ie(),Se("TresTextGeometry",{key:0,args:[S.value,p.value],center:q(a)},null,8,jl)):Yt("",!0),Wr(u.$slots,"default")],512)):Yt("",!0)}});new Z;new Z;new Z;var pn;/Mac/.test((pn=globalThis?.navigator)===null||pn===void 0?void 0:pn.platform);const Dl=["target","auto-rotate","auto-rotate-speed","enable-damping","damping-factor","enable-pan","key-pan-speed","keys","max-azimuth-angle","min-azimuth-angle","max-polar-angle","min-polar-angle","min-distance","max-distance","min-zoom","max-zoom","touches","enable-zoom","zoom-speed","enable-rotate","rotate-speed","mouse-buttons","args"],pu=Xe({__name:"OrbitControls",props:{makeDefault:{type:Boolean,default:!1},camera:{},domElement:{},target:{default:()=>[0,0,0]},enableDamping:{type:Boolean,default:!0},dampingFactor:{default:.05},autoRotate:{type:Boolean,default:!1},autoRotateSpeed:{default:2},enablePan:{type:Boolean,default:!0},keyPanSpeed:{default:7},keys:{},maxAzimuthAngle:{default:Number.POSITIVE_INFINITY},minAzimuthAngle:{default:Number.NEGATIVE_INFINITY},maxPolarAngle:{default:Math.PI},minPolarAngle:{default:0},minDistance:{default:0},maxDistance:{default:Number.POSITIVE_INFINITY},minZoom:{default:0},maxZoom:{default:Number.POSITIVE_INFINITY},touches:{default:()=>({ONE:Ye.ROTATE,TWO:Ye.DOLLY_PAN})},enableZoom:{type:Boolean,default:!0},zoomSpeed:{default:1},enableRotate:{type:Boolean,default:!0},rotateSpeed:{default:1},mouseButtons:{default:()=>({LEFT:Fe.ROTATE,MIDDLE:Fe.DOLLY,RIGHT:Fe.PAN})}},emits:["change","start","end"],setup(t,{expose:e,emit:r}){const n=t,o=r,{makeDefault:a,autoRotate:s,autoRotateSpeed:i,enableDamping:d,dampingFactor:f,enablePan:v,keyPanSpeed:x,maxAzimuthAngle:w,minAzimuthAngle:E,maxPolarAngle:g,minPolarAngle:M,minDistance:m,maxDistance:R,minZoom:P,maxZoom:T,enableZoom:O,zoomSpeed:S,enableRotate:h,touches:_,rotateSpeed:p,target:u,mouseButtons:l}=Tt(n),{camera:b,renderer:A,extend:N,controls:B,invalidate:U}=ot(),D=ne(null);N({OrbitControls:Al}),be(D,H=>{J(),H&&a.value?B.value=H:B.value=null});function J(){sn(D.value,"change",()=>{o("change",D.value),U()}),sn(D.value,"start",()=>o("start",D.value)),sn(D.value,"end",()=>o("end",D.value))}const{onBeforeRender:Q}=uo();return Q(({invalidate:H})=>{D.value&&(d.value||s.value)&&(D.value.update(),s.value&&H())}),We(()=>{D.value&&D.value.dispose()}),e({instance:D}),(H,K)=>(H.camera||q(b))&&(H.domElement||q(A))?(Ie(),Se("TresOrbitControls",{key:0,ref_key:"controlsRef",ref:D,target:q(u),"auto-rotate":q(s),"auto-rotate-speed":q(i),"enable-damping":q(d),"damping-factor":q(f),"enable-pan":q(v),"key-pan-speed":q(x),keys:H.keys,"max-azimuth-angle":q(w),"min-azimuth-angle":q(E),"max-polar-angle":q(g),"min-polar-angle":q(M),"min-distance":q(m),"max-distance":q(R),"min-zoom":q(P),"max-zoom":q(T),touches:q(_),"enable-zoom":q(O),"zoom-speed":q(S),"enable-rotate":q(h),"rotate-speed":q(p),"mouse-buttons":q(l),args:[H.camera||q(b),H.domElement||q(A).domElement]},null,8,Dl)):Yt("",!0)}});function Nt(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var yr={exports:{}},br;function Nl(){return br||(br=1,function(t,e){(function(r){t.exports=r()})(function(){return function r(n,o,a){function s(f,v){if(!o[f]){if(!n[f]){var x=typeof Nt=="function"&&Nt;if(!v&&x)return x(f,!0);if(i)return i(f,!0);throw new Error("Cannot find module '"+f+"'")}v=o[f]={exports:{}},n[f][0].call(v.exports,function(w){var E=n[f][1][w];return s(E||w)},v,v.exports,r,n,o,a)}return o[f].exports}for(var i=typeof Nt=="function"&&Nt,d=0;d<a.length;d++)s(a[d]);return s}({1:[function(r,n,o){(function(a,s,i,d,f,v,x,w,E){var g=r("crypto");function M(h,_){_=P(h,_);var p;return(p=_.algorithm!=="passthrough"?g.createHash(_.algorithm):new S).write===void 0&&(p.write=p.update,p.end=p.update),O(_,p).dispatch(h),p.update||p.end(""),p.digest?p.digest(_.encoding==="buffer"?void 0:_.encoding):(h=p.read(),_.encoding!=="buffer"?h.toString(_.encoding):h)}(o=n.exports=M).sha1=function(h){return M(h)},o.keys=function(h){return M(h,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},o.MD5=function(h){return M(h,{algorithm:"md5",encoding:"hex"})},o.keysMD5=function(h){return M(h,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var m=g.getHashes?g.getHashes().slice():["sha1","md5"],R=(m.push("passthrough"),["buffer","hex","binary","base64"]);function P(h,_){var p={};if(p.algorithm=(_=_||{}).algorithm||"sha1",p.encoding=_.encoding||"hex",p.excludeValues=!!_.excludeValues,p.algorithm=p.algorithm.toLowerCase(),p.encoding=p.encoding.toLowerCase(),p.ignoreUnknown=_.ignoreUnknown===!0,p.respectType=_.respectType!==!1,p.respectFunctionNames=_.respectFunctionNames!==!1,p.respectFunctionProperties=_.respectFunctionProperties!==!1,p.unorderedArrays=_.unorderedArrays===!0,p.unorderedSets=_.unorderedSets!==!1,p.unorderedObjects=_.unorderedObjects!==!1,p.replacer=_.replacer||void 0,p.excludeKeys=_.excludeKeys||void 0,h===void 0)throw new Error("Object argument required.");for(var u=0;u<m.length;++u)m[u].toLowerCase()===p.algorithm.toLowerCase()&&(p.algorithm=m[u]);if(m.indexOf(p.algorithm)===-1)throw new Error('Algorithm "'+p.algorithm+'"  not supported. supported values: '+m.join(", "));if(R.indexOf(p.encoding)===-1&&p.algorithm!=="passthrough")throw new Error('Encoding "'+p.encoding+'"  not supported. supported values: '+R.join(", "));return p}function T(h){if(typeof h=="function")return/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(h))!=null}function O(h,_,p){p=p||[];function u(l){return _.update?_.update(l,"utf8"):_.write(l,"utf8")}return{dispatch:function(l){return this["_"+((l=h.replacer?h.replacer(l):l)===null?"null":typeof l)](l)},_object:function(l){var b,A=Object.prototype.toString.call(l),N=/\[object (.*)\]/i.exec(A);if(N=(N=N?N[1]:"unknown:["+A+"]").toLowerCase(),0<=(A=p.indexOf(l)))return this.dispatch("[CIRCULAR:"+A+"]");if(p.push(l),i!==void 0&&i.isBuffer&&i.isBuffer(l))return u("buffer:"),u(l);if(N==="object"||N==="function"||N==="asyncfunction")return A=Object.keys(l),h.unorderedObjects&&(A=A.sort()),h.respectType===!1||T(l)||A.splice(0,0,"prototype","__proto__","constructor"),h.excludeKeys&&(A=A.filter(function(B){return!h.excludeKeys(B)})),u("object:"+A.length+":"),b=this,A.forEach(function(B){b.dispatch(B),u(":"),h.excludeValues||b.dispatch(l[B]),u(",")});if(!this["_"+N]){if(h.ignoreUnknown)return u("["+N+"]");throw new Error('Unknown object type "'+N+'"')}this["_"+N](l)},_array:function(l,B){B=B!==void 0?B:h.unorderedArrays!==!1;var A=this;if(u("array:"+l.length+":"),!B||l.length<=1)return l.forEach(function(U){return A.dispatch(U)});var N=[],B=l.map(function(U){var D=new S,J=p.slice();return O(h,D,J).dispatch(U),N=N.concat(J.slice(p.length)),D.read().toString()});return p=p.concat(N),B.sort(),this._array(B,!1)},_date:function(l){return u("date:"+l.toJSON())},_symbol:function(l){return u("symbol:"+l.toString())},_error:function(l){return u("error:"+l.toString())},_boolean:function(l){return u("bool:"+l.toString())},_string:function(l){u("string:"+l.length+":"),u(l.toString())},_function:function(l){u("fn:"),T(l)?this.dispatch("[native]"):this.dispatch(l.toString()),h.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(l.name)),h.respectFunctionProperties&&this._object(l)},_number:function(l){return u("number:"+l.toString())},_xml:function(l){return u("xml:"+l.toString())},_null:function(){return u("Null")},_undefined:function(){return u("Undefined")},_regexp:function(l){return u("regex:"+l.toString())},_uint8array:function(l){return u("uint8array:"),this.dispatch(Array.prototype.slice.call(l))},_uint8clampedarray:function(l){return u("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(l))},_int8array:function(l){return u("int8array:"),this.dispatch(Array.prototype.slice.call(l))},_uint16array:function(l){return u("uint16array:"),this.dispatch(Array.prototype.slice.call(l))},_int16array:function(l){return u("int16array:"),this.dispatch(Array.prototype.slice.call(l))},_uint32array:function(l){return u("uint32array:"),this.dispatch(Array.prototype.slice.call(l))},_int32array:function(l){return u("int32array:"),this.dispatch(Array.prototype.slice.call(l))},_float32array:function(l){return u("float32array:"),this.dispatch(Array.prototype.slice.call(l))},_float64array:function(l){return u("float64array:"),this.dispatch(Array.prototype.slice.call(l))},_arraybuffer:function(l){return u("arraybuffer:"),this.dispatch(new Uint8Array(l))},_url:function(l){return u("url:"+l.toString())},_map:function(l){return u("map:"),l=Array.from(l),this._array(l,h.unorderedSets!==!1)},_set:function(l){return u("set:"),l=Array.from(l),this._array(l,h.unorderedSets!==!1)},_file:function(l){return u("file:"),this.dispatch([l.name,l.size,l.type,l.lastModfied])},_blob:function(){if(h.ignoreUnknown)return u("[blob]");throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){return u("domwindow")},_bigint:function(l){return u("bigint:"+l.toString())},_process:function(){return u("process")},_timer:function(){return u("timer")},_pipe:function(){return u("pipe")},_tcp:function(){return u("tcp")},_udp:function(){return u("udp")},_tty:function(){return u("tty")},_statwatcher:function(){return u("statwatcher")},_securecontext:function(){return u("securecontext")},_connection:function(){return u("connection")},_zlib:function(){return u("zlib")},_context:function(){return u("context")},_nodescript:function(){return u("nodescript")},_httpparser:function(){return u("httpparser")},_dataview:function(){return u("dataview")},_signal:function(){return u("signal")},_fsevent:function(){return u("fsevent")},_tlswrap:function(){return u("tlswrap")}}}function S(){return{buf:"",write:function(h){this.buf+=h},end:function(h){this.buf+=h},read:function(){return this.buf}}}o.writeToStream=function(h,_,p){return p===void 0&&(p=_,_={}),O(_=P(h,_),p).dispatch(h)}}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_9a5aa49d.js","/")},{buffer:3,crypto:5,lYpoI2:11}],2:[function(r,n,o){(function(a,s,i,d,f,v,x,w,E){(function(g){var M=typeof Uint8Array<"u"?Uint8Array:Array,m=43,R=47,P=48,T=97,O=65,S=45,h=95;function _(p){return p=p.charCodeAt(0),p===m||p===S?62:p===R||p===h?63:p<P?-1:p<P+10?p-P+26+26:p<O+26?p-O:p<T+26?p-T+26:void 0}g.toByteArray=function(p){var u,l;if(0<p.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var b=p.length,b=p.charAt(b-2)==="="?2:p.charAt(b-1)==="="?1:0,A=new M(3*p.length/4-b),N=0<b?p.length-4:p.length,B=0;function U(D){A[B++]=D}for(u=0;u<N;u+=4,0)U((16711680&(l=_(p.charAt(u))<<18|_(p.charAt(u+1))<<12|_(p.charAt(u+2))<<6|_(p.charAt(u+3))))>>16),U((65280&l)>>8),U(255&l);return b==2?U(255&(l=_(p.charAt(u))<<2|_(p.charAt(u+1))>>4)):b==1&&(U((l=_(p.charAt(u))<<10|_(p.charAt(u+1))<<4|_(p.charAt(u+2))>>2)>>8&255),U(255&l)),A},g.fromByteArray=function(p){var u,l,b,A,N=p.length%3,B="";function U(D){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(D)}for(u=0,b=p.length-N;u<b;u+=3)l=(p[u]<<16)+(p[u+1]<<8)+p[u+2],B+=U((A=l)>>18&63)+U(A>>12&63)+U(A>>6&63)+U(63&A);switch(N){case 1:B=(B+=U((l=p[p.length-1])>>2))+U(l<<4&63)+"==";break;case 2:B=(B=(B+=U((l=(p[p.length-2]<<8)+p[p.length-1])>>10))+U(l>>4&63))+U(l<<2&63)+"="}return B}})(o===void 0?this.base64js={}:o)}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:11}],3:[function(r,n,o){(function(a,s,m,d,f,v,x,w,E){var g=r("base64-js"),M=r("ieee754");function m(c,y,I){if(!(this instanceof m))return new m(c,y,I);var k,j,z,G,re=typeof c;if(y==="base64"&&re=="string")for(c=(G=c).trim?G.trim():G.replace(/^\s+|\s+$/g,"");c.length%4!=0;)c+="=";if(re=="number")k=Q(c);else if(re=="string")k=m.byteLength(c,y);else{if(re!="object")throw new Error("First argument needs to be a number, array or string.");k=Q(c.length)}if(m._useTypedArrays?j=m._augment(new Uint8Array(k)):((j=this).length=k,j._isBuffer=!0),m._useTypedArrays&&typeof c.byteLength=="number")j._set(c);else if(H(G=c)||m.isBuffer(G)||G&&typeof G=="object"&&typeof G.length=="number")for(z=0;z<k;z++)m.isBuffer(c)?j[z]=c.readUInt8(z):j[z]=c[z];else if(re=="string")j.write(c,0,y);else if(re=="number"&&!m._useTypedArrays&&!I)for(z=0;z<k;z++)j[z]=0;return j}function R(c,y,I,k){return m._charsWritten=de(function(j){for(var z=[],G=0;G<j.length;G++)z.push(255&j.charCodeAt(G));return z}(y),c,I,k)}function P(c,y,I,k){return m._charsWritten=de(function(j){for(var z,G,re=[],se=0;se<j.length;se++)G=j.charCodeAt(se),z=G>>8,G=G%256,re.push(G),re.push(z);return re}(y),c,I,k)}function T(c,y,I){var k="";I=Math.min(c.length,I);for(var j=y;j<I;j++)k+=String.fromCharCode(c[j]);return k}function O(c,y,I,z){z||(L(typeof I=="boolean","missing or invalid endian"),L(y!=null,"missing offset"),L(y+1<c.length,"Trying to read beyond buffer length"));var j,z=c.length;if(!(z<=y))return I?(j=c[y],y+1<z&&(j|=c[y+1]<<8)):(j=c[y]<<8,y+1<z&&(j|=c[y+1])),j}function S(c,y,I,z){z||(L(typeof I=="boolean","missing or invalid endian"),L(y!=null,"missing offset"),L(y+3<c.length,"Trying to read beyond buffer length"));var j,z=c.length;if(!(z<=y))return I?(y+2<z&&(j=c[y+2]<<16),y+1<z&&(j|=c[y+1]<<8),j|=c[y],y+3<z&&(j+=c[y+3]<<24>>>0)):(y+1<z&&(j=c[y+1]<<16),y+2<z&&(j|=c[y+2]<<8),y+3<z&&(j|=c[y+3]),j+=c[y]<<24>>>0),j}function h(c,y,I,k){if(k||(L(typeof I=="boolean","missing or invalid endian"),L(y!=null,"missing offset"),L(y+1<c.length,"Trying to read beyond buffer length")),!(c.length<=y))return k=O(c,y,I,!0),32768&k?-1*(65535-k+1):k}function _(c,y,I,k){if(k||(L(typeof I=="boolean","missing or invalid endian"),L(y!=null,"missing offset"),L(y+3<c.length,"Trying to read beyond buffer length")),!(c.length<=y))return k=S(c,y,I,!0),2147483648&k?-1*(4294967295-k+1):k}function p(c,y,I,k){return k||(L(typeof I=="boolean","missing or invalid endian"),L(y+3<c.length,"Trying to read beyond buffer length")),M.read(c,y,I,23,4)}function u(c,y,I,k){return k||(L(typeof I=="boolean","missing or invalid endian"),L(y+7<c.length,"Trying to read beyond buffer length")),M.read(c,y,I,52,8)}function l(c,y,I,k,j){if(j||(L(y!=null,"missing value"),L(typeof k=="boolean","missing or invalid endian"),L(I!=null,"missing offset"),L(I+1<c.length,"trying to write beyond buffer length"),pe(y,65535)),j=c.length,!(j<=I))for(var z=0,G=Math.min(j-I,2);z<G;z++)c[I+z]=(y&255<<8*(k?z:1-z))>>>8*(k?z:1-z)}function b(c,y,I,k,j){if(j||(L(y!=null,"missing value"),L(typeof k=="boolean","missing or invalid endian"),L(I!=null,"missing offset"),L(I+3<c.length,"trying to write beyond buffer length"),pe(y,4294967295)),j=c.length,!(j<=I))for(var z=0,G=Math.min(j-I,4);z<G;z++)c[I+z]=y>>>8*(k?z:3-z)&255}function A(c,y,I,k,j){j||(L(y!=null,"missing value"),L(typeof k=="boolean","missing or invalid endian"),L(I!=null,"missing offset"),L(I+1<c.length,"Trying to write beyond buffer length"),we(y,32767,-32768)),c.length<=I||l(c,0<=y?y:65535+y+1,I,k,j)}function N(c,y,I,k,j){j||(L(y!=null,"missing value"),L(typeof k=="boolean","missing or invalid endian"),L(I!=null,"missing offset"),L(I+3<c.length,"Trying to write beyond buffer length"),we(y,2147483647,-2147483648)),c.length<=I||b(c,0<=y?y:4294967295+y+1,I,k,j)}function B(c,y,I,k,j){j||(L(y!=null,"missing value"),L(typeof k=="boolean","missing or invalid endian"),L(I!=null,"missing offset"),L(I+3<c.length,"Trying to write beyond buffer length"),_e(y,34028234663852886e22,-34028234663852886e22)),c.length<=I||M.write(c,y,I,k,23,4)}function U(c,y,I,k,j){j||(L(y!=null,"missing value"),L(typeof k=="boolean","missing or invalid endian"),L(I!=null,"missing offset"),L(I+7<c.length,"Trying to write beyond buffer length"),_e(y,17976931348623157e292,-17976931348623157e292)),c.length<=I||M.write(c,y,I,k,52,8)}o.Buffer=m,o.SlowBuffer=m,o.INSPECT_MAX_BYTES=50,m.poolSize=8192,m._useTypedArrays=function(){try{var c=new ArrayBuffer(0),y=new Uint8Array(c);return y.foo=function(){return 42},y.foo()===42&&typeof y.subarray=="function"}catch{return!1}}(),m.isEncoding=function(c){switch(String(c).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},m.isBuffer=function(c){return!(c==null||!c._isBuffer)},m.byteLength=function(c,y){var I;switch(c+="",y||"utf8"){case"hex":I=c.length/2;break;case"utf8":case"utf-8":I=F(c).length;break;case"ascii":case"binary":case"raw":I=c.length;break;case"base64":I=te(c).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":I=2*c.length;break;default:throw new Error("Unknown encoding")}return I},m.concat=function(c,y){if(L(H(c),`Usage: Buffer.concat(list, [totalLength])
list should be an Array.`),c.length===0)return new m(0);if(c.length===1)return c[0];if(typeof y!="number")for(j=y=0;j<c.length;j++)y+=c[j].length;for(var I=new m(y),k=0,j=0;j<c.length;j++){var z=c[j];z.copy(I,k),k+=z.length}return I},m.prototype.write=function(c,y,I,k){isFinite(y)?isFinite(I)||(k=I,I=void 0):(se=k,k=y,y=I,I=se),y=Number(y)||0;var j,z,G,re,se=this.length-y;switch((!I||se<(I=Number(I)))&&(I=se),k=String(k||"utf8").toLowerCase()){case"hex":j=function(X,oe,he,ae){he=Number(he)||0;var ce=X.length-he;(!ae||ce<(ae=Number(ae)))&&(ae=ce),L((ce=oe.length)%2==0,"Invalid hex string"),ce/2<ae&&(ae=ce/2);for(var Oe=0;Oe<ae;Oe++){var ke=parseInt(oe.substr(2*Oe,2),16);L(!isNaN(ke),"Invalid hex string"),X[he+Oe]=ke}return m._charsWritten=2*Oe,Oe}(this,c,y,I);break;case"utf8":case"utf-8":z=this,G=y,re=I,j=m._charsWritten=de(F(c),z,G,re);break;case"ascii":case"binary":j=R(this,c,y,I);break;case"base64":z=this,G=y,re=I,j=m._charsWritten=de(te(c),z,G,re);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":j=P(this,c,y,I);break;default:throw new Error("Unknown encoding")}return j},m.prototype.toString=function(c,y,I){var k,j,z,G,re=this;if(c=String(c||"utf8").toLowerCase(),y=Number(y)||0,(I=I!==void 0?Number(I):re.length)===y)return"";switch(c){case"hex":k=function(se,X,oe){var he=se.length;(!X||X<0)&&(X=0),(!oe||oe<0||he<oe)&&(oe=he);for(var ae="",ce=X;ce<oe;ce++)ae+=K(se[ce]);return ae}(re,y,I);break;case"utf8":case"utf-8":k=function(se,X,oe){var he="",ae="";oe=Math.min(se.length,oe);for(var ce=X;ce<oe;ce++)se[ce]<=127?(he+=ue(ae)+String.fromCharCode(se[ce]),ae=""):ae+="%"+se[ce].toString(16);return he+ue(ae)}(re,y,I);break;case"ascii":case"binary":k=T(re,y,I);break;case"base64":j=re,G=I,k=(z=y)===0&&G===j.length?g.fromByteArray(j):g.fromByteArray(j.slice(z,G));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":k=function(se,X,oe){for(var he=se.slice(X,oe),ae="",ce=0;ce<he.length;ce+=2)ae+=String.fromCharCode(he[ce]+256*he[ce+1]);return ae}(re,y,I);break;default:throw new Error("Unknown encoding")}return k},m.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},m.prototype.copy=function(c,y,I,k){if(y=y||0,(k=k||k===0?k:this.length)!==(I=I||0)&&c.length!==0&&this.length!==0){L(I<=k,"sourceEnd < sourceStart"),L(0<=y&&y<c.length,"targetStart out of bounds"),L(0<=I&&I<this.length,"sourceStart out of bounds"),L(0<=k&&k<=this.length,"sourceEnd out of bounds"),k>this.length&&(k=this.length);var j=(k=c.length-y<k-I?c.length-y+I:k)-I;if(j<100||!m._useTypedArrays)for(var z=0;z<j;z++)c[z+y]=this[z+I];else c._set(this.subarray(I,I+j),y)}},m.prototype.slice=function(c,y){var I=this.length;if(c=J(c,I,0),y=J(y,I,I),m._useTypedArrays)return m._augment(this.subarray(c,y));for(var k=y-c,j=new m(k,void 0,!0),z=0;z<k;z++)j[z]=this[z+c];return j},m.prototype.get=function(c){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(c)},m.prototype.set=function(c,y){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(c,y)},m.prototype.readUInt8=function(c,y){if(y||(L(c!=null,"missing offset"),L(c<this.length,"Trying to read beyond buffer length")),!(c>=this.length))return this[c]},m.prototype.readUInt16LE=function(c,y){return O(this,c,!0,y)},m.prototype.readUInt16BE=function(c,y){return O(this,c,!1,y)},m.prototype.readUInt32LE=function(c,y){return S(this,c,!0,y)},m.prototype.readUInt32BE=function(c,y){return S(this,c,!1,y)},m.prototype.readInt8=function(c,y){if(y||(L(c!=null,"missing offset"),L(c<this.length,"Trying to read beyond buffer length")),!(c>=this.length))return 128&this[c]?-1*(255-this[c]+1):this[c]},m.prototype.readInt16LE=function(c,y){return h(this,c,!0,y)},m.prototype.readInt16BE=function(c,y){return h(this,c,!1,y)},m.prototype.readInt32LE=function(c,y){return _(this,c,!0,y)},m.prototype.readInt32BE=function(c,y){return _(this,c,!1,y)},m.prototype.readFloatLE=function(c,y){return p(this,c,!0,y)},m.prototype.readFloatBE=function(c,y){return p(this,c,!1,y)},m.prototype.readDoubleLE=function(c,y){return u(this,c,!0,y)},m.prototype.readDoubleBE=function(c,y){return u(this,c,!1,y)},m.prototype.writeUInt8=function(c,y,I){I||(L(c!=null,"missing value"),L(y!=null,"missing offset"),L(y<this.length,"trying to write beyond buffer length"),pe(c,255)),y>=this.length||(this[y]=c)},m.prototype.writeUInt16LE=function(c,y,I){l(this,c,y,!0,I)},m.prototype.writeUInt16BE=function(c,y,I){l(this,c,y,!1,I)},m.prototype.writeUInt32LE=function(c,y,I){b(this,c,y,!0,I)},m.prototype.writeUInt32BE=function(c,y,I){b(this,c,y,!1,I)},m.prototype.writeInt8=function(c,y,I){I||(L(c!=null,"missing value"),L(y!=null,"missing offset"),L(y<this.length,"Trying to write beyond buffer length"),we(c,127,-128)),y>=this.length||(0<=c?this.writeUInt8(c,y,I):this.writeUInt8(255+c+1,y,I))},m.prototype.writeInt16LE=function(c,y,I){A(this,c,y,!0,I)},m.prototype.writeInt16BE=function(c,y,I){A(this,c,y,!1,I)},m.prototype.writeInt32LE=function(c,y,I){N(this,c,y,!0,I)},m.prototype.writeInt32BE=function(c,y,I){N(this,c,y,!1,I)},m.prototype.writeFloatLE=function(c,y,I){B(this,c,y,!0,I)},m.prototype.writeFloatBE=function(c,y,I){B(this,c,y,!1,I)},m.prototype.writeDoubleLE=function(c,y,I){U(this,c,y,!0,I)},m.prototype.writeDoubleBE=function(c,y,I){U(this,c,y,!1,I)},m.prototype.fill=function(c,y,I){if(y=y||0,I=I||this.length,L(typeof(c=typeof(c=c||0)=="string"?c.charCodeAt(0):c)=="number"&&!isNaN(c),"value is not a number"),L(y<=I,"end < start"),I!==y&&this.length!==0){L(0<=y&&y<this.length,"start out of bounds"),L(0<=I&&I<=this.length,"end out of bounds");for(var k=y;k<I;k++)this[k]=c}},m.prototype.inspect=function(){for(var c=[],y=this.length,I=0;I<y;I++)if(c[I]=K(this[I]),I===o.INSPECT_MAX_BYTES){c[I+1]="...";break}return"<Buffer "+c.join(" ")+">"},m.prototype.toArrayBuffer=function(){if(typeof Uint8Array>"u")throw new Error("Buffer.toArrayBuffer not supported in this browser");if(m._useTypedArrays)return new m(this).buffer;for(var c=new Uint8Array(this.length),y=0,I=c.length;y<I;y+=1)c[y]=this[y];return c.buffer};var D=m.prototype;function J(c,y,I){return typeof c!="number"?I:y<=(c=~~c)?y:0<=c||0<=(c+=y)?c:0}function Q(c){return(c=~~Math.ceil(+c))<0?0:c}function H(c){return(Array.isArray||function(y){return Object.prototype.toString.call(y)==="[object Array]"})(c)}function K(c){return c<16?"0"+c.toString(16):c.toString(16)}function F(c){for(var y=[],I=0;I<c.length;I++){var k=c.charCodeAt(I);if(k<=127)y.push(c.charCodeAt(I));else for(var j=I,z=(55296<=k&&k<=57343&&I++,encodeURIComponent(c.slice(j,I+1)).substr(1).split("%")),G=0;G<z.length;G++)y.push(parseInt(z[G],16))}return y}function te(c){return g.toByteArray(c)}function de(c,y,I,k){for(var j=0;j<k&&!(j+I>=y.length||j>=c.length);j++)y[j+I]=c[j];return j}function ue(c){try{return decodeURIComponent(c)}catch{return"�"}}function pe(c,y){L(typeof c=="number","cannot write a non-number as a number"),L(0<=c,"specified a negative value for writing an unsigned value"),L(c<=y,"value is larger than maximum value for type"),L(Math.floor(c)===c,"value has a fractional component")}function we(c,y,I){L(typeof c=="number","cannot write a non-number as a number"),L(c<=y,"value larger than maximum allowed value"),L(I<=c,"value smaller than minimum allowed value"),L(Math.floor(c)===c,"value has a fractional component")}function _e(c,y,I){L(typeof c=="number","cannot write a non-number as a number"),L(c<=y,"value larger than maximum allowed value"),L(I<=c,"value smaller than minimum allowed value")}function L(c,y){if(!c)throw new Error(y||"Failed assertion")}m._augment=function(c){return c._isBuffer=!0,c._get=c.get,c._set=c.set,c.get=D.get,c.set=D.set,c.write=D.write,c.toString=D.toString,c.toLocaleString=D.toString,c.toJSON=D.toJSON,c.copy=D.copy,c.slice=D.slice,c.readUInt8=D.readUInt8,c.readUInt16LE=D.readUInt16LE,c.readUInt16BE=D.readUInt16BE,c.readUInt32LE=D.readUInt32LE,c.readUInt32BE=D.readUInt32BE,c.readInt8=D.readInt8,c.readInt16LE=D.readInt16LE,c.readInt16BE=D.readInt16BE,c.readInt32LE=D.readInt32LE,c.readInt32BE=D.readInt32BE,c.readFloatLE=D.readFloatLE,c.readFloatBE=D.readFloatBE,c.readDoubleLE=D.readDoubleLE,c.readDoubleBE=D.readDoubleBE,c.writeUInt8=D.writeUInt8,c.writeUInt16LE=D.writeUInt16LE,c.writeUInt16BE=D.writeUInt16BE,c.writeUInt32LE=D.writeUInt32LE,c.writeUInt32BE=D.writeUInt32BE,c.writeInt8=D.writeInt8,c.writeInt16LE=D.writeInt16LE,c.writeInt16BE=D.writeInt16BE,c.writeInt32LE=D.writeInt32LE,c.writeInt32BE=D.writeInt32BE,c.writeFloatLE=D.writeFloatLE,c.writeFloatBE=D.writeFloatBE,c.writeDoubleLE=D.writeDoubleLE,c.writeDoubleBE=D.writeDoubleBE,c.fill=D.fill,c.inspect=D.inspect,c.toArrayBuffer=D.toArrayBuffer,c}}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:10,lYpoI2:11}],4:[function(r,n,o){(function(a,s,g,d,f,v,x,w,E){var g=r("buffer").Buffer,M=4,m=new g(M);m.fill(0),n.exports={hash:function(R,P,T,O){for(var S=P(function(l,b){l.length%M!=0&&(A=l.length+(M-l.length%M),l=g.concat([l,m],A));for(var A,N=[],B=b?l.readInt32BE:l.readInt32LE,U=0;U<l.length;U+=M)N.push(B.call(l,U));return N}(R=g.isBuffer(R)?R:new g(R),O),8*R.length),P=O,h=new g(T),_=P?h.writeInt32BE:h.writeInt32LE,p=0;p<S.length;p++)_.call(h,S[p],4*p,!0);return h}}}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],5:[function(r,n,o){(function(a,s,g,d,f,v,x,w,E){var g=r("buffer").Buffer,M=r("./sha"),m=r("./sha256"),R=r("./rng"),P={sha1:M,sha256:m,md5:r("./md5")},T=64,O=new g(T);function S(l,b){var A=P[l=l||"sha1"],N=[];return A||h("algorithm:",l,"is not yet supported"),{update:function(B){return g.isBuffer(B)||(B=new g(B)),N.push(B),B.length,this},digest:function(B){var U=g.concat(N),U=b?function(D,J,Q){g.isBuffer(J)||(J=new g(J)),g.isBuffer(Q)||(Q=new g(Q)),J.length>T?J=D(J):J.length<T&&(J=g.concat([J,O],T));for(var H=new g(T),K=new g(T),F=0;F<T;F++)H[F]=54^J[F],K[F]=92^J[F];return Q=D(g.concat([H,Q])),D(g.concat([K,Q]))}(A,b,U):A(U);return N=null,B?U.toString(B):U}}}function h(){var l=[].slice.call(arguments).join(" ");throw new Error([l,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join(`
`))}O.fill(0),o.createHash=function(l){return S(l)},o.createHmac=S,o.randomBytes=function(l,b){if(!b||!b.call)return new g(R(l));try{b.call(this,void 0,new g(R(l)))}catch(A){b(A)}};var _,p=["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],u=function(l){o[l]=function(){h("sorry,",l,"is not implemented yet")}};for(_ in p)u(p[_])}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:11}],6:[function(r,n,o){(function(a,s,i,d,f,v,x,w,E){var g=r("./helpers");function M(h,_){h[_>>5]|=128<<_%32,h[14+(_+64>>>9<<4)]=_;for(var p=1732584193,u=-271733879,l=-1732584194,b=271733878,A=0;A<h.length;A+=16){var N=p,B=u,U=l,D=b,p=R(p,u,l,b,h[A+0],7,-680876936),b=R(b,p,u,l,h[A+1],12,-389564586),l=R(l,b,p,u,h[A+2],17,606105819),u=R(u,l,b,p,h[A+3],22,-1044525330);p=R(p,u,l,b,h[A+4],7,-176418897),b=R(b,p,u,l,h[A+5],12,1200080426),l=R(l,b,p,u,h[A+6],17,-1473231341),u=R(u,l,b,p,h[A+7],22,-45705983),p=R(p,u,l,b,h[A+8],7,1770035416),b=R(b,p,u,l,h[A+9],12,-1958414417),l=R(l,b,p,u,h[A+10],17,-42063),u=R(u,l,b,p,h[A+11],22,-1990404162),p=R(p,u,l,b,h[A+12],7,1804603682),b=R(b,p,u,l,h[A+13],12,-40341101),l=R(l,b,p,u,h[A+14],17,-1502002290),p=P(p,u=R(u,l,b,p,h[A+15],22,1236535329),l,b,h[A+1],5,-165796510),b=P(b,p,u,l,h[A+6],9,-1069501632),l=P(l,b,p,u,h[A+11],14,643717713),u=P(u,l,b,p,h[A+0],20,-373897302),p=P(p,u,l,b,h[A+5],5,-701558691),b=P(b,p,u,l,h[A+10],9,38016083),l=P(l,b,p,u,h[A+15],14,-660478335),u=P(u,l,b,p,h[A+4],20,-405537848),p=P(p,u,l,b,h[A+9],5,568446438),b=P(b,p,u,l,h[A+14],9,-1019803690),l=P(l,b,p,u,h[A+3],14,-187363961),u=P(u,l,b,p,h[A+8],20,1163531501),p=P(p,u,l,b,h[A+13],5,-1444681467),b=P(b,p,u,l,h[A+2],9,-51403784),l=P(l,b,p,u,h[A+7],14,1735328473),p=T(p,u=P(u,l,b,p,h[A+12],20,-1926607734),l,b,h[A+5],4,-378558),b=T(b,p,u,l,h[A+8],11,-2022574463),l=T(l,b,p,u,h[A+11],16,1839030562),u=T(u,l,b,p,h[A+14],23,-35309556),p=T(p,u,l,b,h[A+1],4,-1530992060),b=T(b,p,u,l,h[A+4],11,1272893353),l=T(l,b,p,u,h[A+7],16,-155497632),u=T(u,l,b,p,h[A+10],23,-1094730640),p=T(p,u,l,b,h[A+13],4,681279174),b=T(b,p,u,l,h[A+0],11,-358537222),l=T(l,b,p,u,h[A+3],16,-722521979),u=T(u,l,b,p,h[A+6],23,76029189),p=T(p,u,l,b,h[A+9],4,-640364487),b=T(b,p,u,l,h[A+12],11,-421815835),l=T(l,b,p,u,h[A+15],16,530742520),p=O(p,u=T(u,l,b,p,h[A+2],23,-995338651),l,b,h[A+0],6,-198630844),b=O(b,p,u,l,h[A+7],10,1126891415),l=O(l,b,p,u,h[A+14],15,-1416354905),u=O(u,l,b,p,h[A+5],21,-57434055),p=O(p,u,l,b,h[A+12],6,1700485571),b=O(b,p,u,l,h[A+3],10,-1894986606),l=O(l,b,p,u,h[A+10],15,-1051523),u=O(u,l,b,p,h[A+1],21,-2054922799),p=O(p,u,l,b,h[A+8],6,1873313359),b=O(b,p,u,l,h[A+15],10,-30611744),l=O(l,b,p,u,h[A+6],15,-1560198380),u=O(u,l,b,p,h[A+13],21,1309151649),p=O(p,u,l,b,h[A+4],6,-145523070),b=O(b,p,u,l,h[A+11],10,-1120210379),l=O(l,b,p,u,h[A+2],15,718787259),u=O(u,l,b,p,h[A+9],21,-343485551),p=S(p,N),u=S(u,B),l=S(l,U),b=S(b,D)}return Array(p,u,l,b)}function m(h,_,p,u,l,b){return S((_=S(S(_,h),S(u,b)))<<l|_>>>32-l,p)}function R(h,_,p,u,l,b,A){return m(_&p|~_&u,h,_,l,b,A)}function P(h,_,p,u,l,b,A){return m(_&u|p&~u,h,_,l,b,A)}function T(h,_,p,u,l,b,A){return m(_^p^u,h,_,l,b,A)}function O(h,_,p,u,l,b,A){return m(p^(_|~u),h,_,l,b,A)}function S(h,_){var p=(65535&h)+(65535&_);return(h>>16)+(_>>16)+(p>>16)<<16|65535&p}n.exports=function(h){return g.hash(h,M,16)}}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],7:[function(r,n,o){(function(a,s,i,d,f,v,x,w,E){n.exports=function(g){for(var M,m=new Array(g),R=0;R<g;R++)!(3&R)&&(M=4294967296*Math.random()),m[R]=M>>>((3&R)<<3)&255;return m}}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],8:[function(r,n,o){(function(a,s,i,d,f,v,x,w,E){var g=r("./helpers");function M(P,T){P[T>>5]|=128<<24-T%32,P[15+(T+64>>9<<4)]=T;for(var O,S,h,_=Array(80),p=1732584193,u=-271733879,l=-1732584194,b=271733878,A=-1009589776,N=0;N<P.length;N+=16){for(var B=p,U=u,D=l,J=b,Q=A,H=0;H<80;H++){_[H]=H<16?P[N+H]:R(_[H-3]^_[H-8]^_[H-14]^_[H-16],1);var K=m(m(R(p,5),(K=u,S=l,h=b,(O=H)<20?K&S|~K&h:!(O<40)&&O<60?K&S|K&h|S&h:K^S^h)),m(m(A,_[H]),(O=H)<20?1518500249:O<40?1859775393:O<60?-1894007588:-899497514)),A=b,b=l,l=R(u,30),u=p,p=K}p=m(p,B),u=m(u,U),l=m(l,D),b=m(b,J),A=m(A,Q)}return Array(p,u,l,b,A)}function m(P,T){var O=(65535&P)+(65535&T);return(P>>16)+(T>>16)+(O>>16)<<16|65535&O}function R(P,T){return P<<T|P>>>32-T}n.exports=function(P){return g.hash(P,M,20,!0)}}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],9:[function(r,n,o){(function(a,s,i,d,f,v,x,w,E){function g(T,O){var S=(65535&T)+(65535&O);return(T>>16)+(O>>16)+(S>>16)<<16|65535&S}function M(T,O){var S,h=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),_=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),p=new Array(64);T[O>>5]|=128<<24-O%32,T[15+(O+64>>9<<4)]=O;for(var u,l,b=0;b<T.length;b+=16){for(var A=_[0],N=_[1],B=_[2],U=_[3],D=_[4],J=_[5],Q=_[6],H=_[7],K=0;K<64;K++)p[K]=K<16?T[K+b]:g(g(g((l=p[K-2],R(l,17)^R(l,19)^P(l,10)),p[K-7]),(l=p[K-15],R(l,7)^R(l,18)^P(l,3))),p[K-16]),S=g(g(g(g(H,R(l=D,6)^R(l,11)^R(l,25)),D&J^~D&Q),h[K]),p[K]),u=g(R(u=A,2)^R(u,13)^R(u,22),A&N^A&B^N&B),H=Q,Q=J,J=D,D=g(U,S),U=B,B=N,N=A,A=g(S,u);_[0]=g(A,_[0]),_[1]=g(N,_[1]),_[2]=g(B,_[2]),_[3]=g(U,_[3]),_[4]=g(D,_[4]),_[5]=g(J,_[5]),_[6]=g(Q,_[6]),_[7]=g(H,_[7])}return _}var m=r("./helpers"),R=function(T,O){return T>>>O|T<<32-O},P=function(T,O){return T>>>O};n.exports=function(T){return m.hash(T,M,32,!0)}}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],10:[function(r,n,o){(function(a,s,i,d,f,v,x,w,E){o.read=function(g,M,m,R,b){var T,O,S=8*b-R-1,h=(1<<S)-1,_=h>>1,p=-7,u=m?b-1:0,l=m?-1:1,b=g[M+u];for(u+=l,T=b&(1<<-p)-1,b>>=-p,p+=S;0<p;T=256*T+g[M+u],u+=l,p-=8);for(O=T&(1<<-p)-1,T>>=-p,p+=R;0<p;O=256*O+g[M+u],u+=l,p-=8);if(T===0)T=1-_;else{if(T===h)return O?NaN:1/0*(b?-1:1);O+=Math.pow(2,R),T-=_}return(b?-1:1)*O*Math.pow(2,T-R)},o.write=function(g,M,m,R,P,A){var O,S,h=8*A-P-1,_=(1<<h)-1,p=_>>1,u=P===23?Math.pow(2,-24)-Math.pow(2,-77):0,l=R?0:A-1,b=R?1:-1,A=M<0||M===0&&1/M<0?1:0;for(M=Math.abs(M),isNaN(M)||M===1/0?(S=isNaN(M)?1:0,O=_):(O=Math.floor(Math.log(M)/Math.LN2),M*(R=Math.pow(2,-O))<1&&(O--,R*=2),2<=(M+=1<=O+p?u/R:u*Math.pow(2,1-p))*R&&(O++,R/=2),_<=O+p?(S=0,O=_):1<=O+p?(S=(M*R-1)*Math.pow(2,P),O+=p):(S=M*Math.pow(2,p-1)*Math.pow(2,P),O=0));8<=P;g[m+l]=255&S,l+=b,S/=256,P-=8);for(O=O<<P|S,h+=P;0<h;g[m+l]=255&O,l+=b,O/=256,h-=8);g[m+l-b]|=128*A}}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/ieee754/index.js","/node_modules/gulp-browserify/node_modules/ieee754")},{buffer:3,lYpoI2:11}],11:[function(r,n,o){(function(a,s,i,d,f,v,x,w,E){var g,M,m;function R(){}(a=n.exports={}).nextTick=(M=typeof window<"u"&&window.setImmediate,m=typeof window<"u"&&window.postMessage&&window.addEventListener,M?function(P){return window.setImmediate(P)}:m?(g=[],window.addEventListener("message",function(P){var T=P.source;T!==window&&T!==null||P.data!=="process-tick"||(P.stopPropagation(),0<g.length&&g.shift()())},!0),function(P){g.push(P),window.postMessage("process-tick","*")}):function(P){setTimeout(P,0)}),a.title="browser",a.browser=!0,a.env={},a.argv=[],a.on=R,a.addListener=R,a.once=R,a.off=R,a.removeListener=R,a.removeAllListeners=R,a.emit=R,a.binding=function(P){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(P){throw new Error("process.chdir is not supported")}}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:11}]},{},[1])(1)})}(yr)),yr.exports}Nl();var wr,xr;function Oo(){return xr||(xr=1,wr=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]),wr}var _r,Mr;function Bl(){return Mr||(Mr=1,_r=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]),_r}var Tr,Er;function Ro(){return Er||(Er=1,Tr=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]),Tr}var dn,Ar;function Ul(){if(Ar)return dn;Ar=1;var t=Oo();return dn=t.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"]),dn}var hn,Ir;function zl(){if(Ir)return hn;Ir=1;var t=Ro();return t=t.slice().filter(function(e){return!/^(gl\_|texture)/.test(e)}),hn=t.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"]),hn}var mn,Pr;function Fl(){if(Pr)return mn;Pr=1,mn=O;var t=Oo(),e=Bl(),r=Ro(),n=Ul(),o=zl(),a=999,s=9999,i=0,d=1,f=2,v=3,x=4,w=5,E=6,g=7,M=8,m=9,R=10,P=11,T=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"];function O(S){var h=0,_=0,p=a,u,l,b=[],A=[],N=1,B=0,U=0,D=!1,J=!1,Q="",H;S=S||{};var K=r,F=t;S.version==="300 es"&&(K=o,F=n);for(var te={},de={},h=0;h<K.length;h++)te[K[h]]=!0;for(var h=0;h<F.length;h++)de[F[h]]=!0;return function(X){return A=[],X!==null?pe(X):we()};function ue(X){X.length&&A.push({type:T[p],data:X,position:U,line:N,column:B})}function pe(X){h=0,X.toString&&(X=X.toString()),Q+=X.replace(/\r\n/g,`
`),H=Q.length;for(var oe;u=Q[h],h<H;){switch(oe=h,p){case i:h=I();break;case d:h=y();break;case f:h=c();break;case v:h=k();break;case x:h=G();break;case P:h=z();break;case w:h=re();break;case s:h=se();break;case m:h=L();break;case a:h=_e();break}if(oe!==h)switch(Q[oe]){case`
`:B=0,++N;break;default:++B;break}}return _+=h,Q=Q.slice(h),A}function we(X){return b.length&&ue(b.join("")),p=R,ue("(eof)"),A}function _e(){return b=b.length?[]:b,l==="/"&&u==="*"?(U=_+h-1,p=i,l=u,h+1):l==="/"&&u==="/"?(U=_+h-1,p=d,l=u,h+1):u==="#"?(p=f,U=_+h,h):/\s/.test(u)?(p=m,U=_+h,h):(D=/\d/.test(u),J=/[^\w_]/.test(u),U=_+h,p=D?x:J?v:s,h)}function L(){return/[^\s]/g.test(u)?(ue(b.join("")),p=a,h):(b.push(u),l=u,h+1)}function c(){return(u==="\r"||u===`
`)&&l!=="\\"?(ue(b.join("")),p=a,h):(b.push(u),l=u,h+1)}function y(){return c()}function I(){return u==="/"&&l==="*"?(b.push(u),ue(b.join("")),p=a,h+1):(b.push(u),l=u,h+1)}function k(){if(l==="."&&/\d/.test(u))return p=w,h;if(l==="/"&&u==="*")return p=i,h;if(l==="/"&&u==="/")return p=d,h;if(u==="."&&b.length){for(;j(b););return p=w,h}if(u===";"||u===")"||u==="("){if(b.length)for(;j(b););return ue(u),p=a,h+1}var X=b.length===2&&u!=="=";if(/[\w_\d\s]/.test(u)||X){for(;j(b););return p=a,h}return b.push(u),l=u,h+1}function j(X){var oe=0,he,ae;do{if(he=e.indexOf(X.slice(0,X.length+oe).join("")),ae=e[he],he===-1){if(oe--+X.length>0)continue;ae=X.slice(0,1).join("")}return ue(ae),U+=ae.length,b=b.slice(ae.length),b.length}while(!0)}function z(){return/[^a-fA-F0-9]/.test(u)?(ue(b.join("")),p=a,h):(b.push(u),l=u,h+1)}function G(){return u==="."||/[eE]/.test(u)?(b.push(u),p=w,l=u,h+1):u==="x"&&b.length===1&&b[0]==="0"?(p=P,b.push(u),l=u,h+1):/[^\d]/.test(u)?(ue(b.join("")),p=a,h):(b.push(u),l=u,h+1)}function re(){return u==="f"&&(b.push(u),l=u,h+=1),/[eE]/.test(u)||(u==="-"||u==="+")&&/[eE]/.test(l)?(b.push(u),l=u,h+1):/[^\d]/.test(u)?(ue(b.join("")),p=a,h):(b.push(u),l=u,h+1)}function se(){if(/[^\d\w_]/.test(u)){var X=b.join("");return de[X]?p=M:te[X]?p=g:p=E,ue(b.join("")),p=a,h}return b.push(u),l=u,h+1}}return mn}var gn,Or;function Ll(){if(Or)return gn;Or=1;var t=Fl();gn=e;function e(r,n){var o=t(n),a=[];return a=a.concat(o(r)),a=a.concat(o(null)),a}return gn}Ll();function Vl(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Yl(t){var e=Vl(t,"string");return typeof e=="symbol"?e:String(e)}function le(t,e,r){return e=Yl(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var W={position:"csm_Position",positionRaw:"csm_PositionRaw",pointSize:"csm_PointSize",fragColor:"csm_FragColor",diffuseColor:"csm_DiffuseColor",normal:"csm_Normal",roughness:"csm_Roughness",metalness:"csm_Metalness",emissive:"csm_Emissive",ao:"csm_AO",bump:"csm_Bump",depthAlpha:"csm_DepthAlpha"},Me,tt;Me={},le(Me,"".concat(W.normal),{"#include <beginnormal_vertex>":`
    vec3 objectNormal = `.concat(W.normal,`;
    #ifdef USE_TANGENT
	    vec3 objectTangent = vec3( tangent.xyz );
    #endif
    `)}),le(Me,"".concat(W.position),{"#include <begin_vertex>":`
    vec3 transformed = `.concat(W.position,`;
  `)}),le(Me,"".concat(W.positionRaw),{"#include <begin_vertex>":`
    vec4 csm_internal_positionUnprojected = `.concat(W.positionRaw,`;
    mat4x4 csm_internal_unprojectMatrix = projectionMatrix * modelViewMatrix;
    #ifdef USE_INSTANCING
      csm_internal_unprojectMatrix = csm_internal_unprojectMatrix * instanceMatrix;
    #endif
    csm_internal_positionUnprojected = inverse(csm_internal_unprojectMatrix) * csm_internal_positionUnprojected;
    vec3 transformed = csm_internal_positionUnprojected.xyz;
  `)}),le(Me,"".concat(W.pointSize),{"gl_PointSize = size;":`
    gl_PointSize = `.concat(W.pointSize,`;
    `)}),le(Me,"".concat(W.diffuseColor),{"#include <color_fragment>":`
    #include <color_fragment>
    diffuseColor = `.concat(W.diffuseColor,`;
  `)}),le(Me,"".concat(W.fragColor),{"#include <dithering_fragment>":`
    #include <dithering_fragment>
    gl_FragColor  = `.concat(W.fragColor,`;
  `)}),le(Me,"".concat(W.emissive),{"vec3 totalEmissiveRadiance = emissive;":`
    vec3 totalEmissiveRadiance = `.concat(W.emissive,`;
    `)}),le(Me,"".concat(W.roughness),{"#include <roughnessmap_fragment>":`
    #include <roughnessmap_fragment>
    roughnessFactor = `.concat(W.roughness,`;
    `)}),le(Me,"".concat(W.metalness),{"#include <metalnessmap_fragment>":`
    #include <metalnessmap_fragment>
    metalnessFactor = `.concat(W.metalness,`;
    `)}),le(Me,"".concat(W.ao),{"#include <aomap_fragment>":`
    #include <aomap_fragment>
    reflectedLight.indirectDiffuse *= 1. - `.concat(W.ao,`;
    `)}),le(Me,"".concat(W.bump),{"#include <normal_fragment_maps>":`
    #include <normal_fragment_maps>

    vec3 csm_internal_orthogonal = `.concat(W.bump," - (dot(").concat(W.bump,`, normal) * normal);
    vec3 csm_internal_projectedbump = mat3(csm_internal_vModelViewMatrix) * csm_internal_orthogonal;
    normal = normalize(normal - csm_internal_projectedbump);
    `)}),le(Me,"".concat(W.depthAlpha),{"gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );":`
      gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity * `.concat(W.depthAlpha,` );
    `),"gl_FragColor = packDepthToRGBA( fragCoordZ );":`
      gl_FragColor = packDepthToRGBA( fragCoordZ );
      gl_FragColor.a *= `.concat(W.depthAlpha,`;
    `)});tt={},le(tt,"".concat(W.position),{"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );":`
    gl_Position = projectionMatrix * modelViewMatrix * vec4( `.concat(W.position,`, 1.0 );
  `)}),le(tt,"".concat(W.positionRaw),{"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );":`
    gl_Position = `.concat(W.position,`;
  `)}),le(tt,"".concat(W.diffuseColor),{"gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );":`
    gl_FragColor = `.concat(W.diffuseColor,`;
  `)}),le(tt,"".concat(W.fragColor),{"gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );":`
    gl_FragColor = `.concat(W.fragColor,`;
  `)});var Te;Te={},le(Te,"".concat(W.position),"*"),le(Te,"".concat(W.positionRaw),"*"),le(Te,"".concat(W.normal),"*"),le(Te,"".concat(W.pointSize),["PointsMaterial"]),le(Te,"".concat(W.diffuseColor),"*"),le(Te,"".concat(W.fragColor),"*"),le(Te,"".concat(W.emissive),["MeshStandardMaterial","MeshPhysicalMaterial"]),le(Te,"".concat(W.roughness),["MeshStandardMaterial","MeshPhysicalMaterial"]),le(Te,"".concat(W.metalness),["MeshStandardMaterial","MeshPhysicalMaterial"]),le(Te,"".concat(W.ao),["MeshStandardMaterial","MeshPhysicalMaterial","MeshBasicMaterial","MeshLambertMaterial","MeshPhongMaterial","MeshToonMaterial"]),le(Te,"".concat(W.bump),["MeshLambertMaterial","MeshMatcapMaterial","MeshNormalMaterial","MeshPhongMaterial","MeshPhysicalMaterial","MeshStandardMaterial","MeshToonMaterial","ShadowMaterial"]),le(Te,"".concat(W.depthAlpha),"*");var Gl=`void main() {
  gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
}`,Hl=`#include <common>

void main() {
  vec2 center = vec2(0., 1.);
  float rotation = 0.0;

  
  
  float size = 0.03;

  vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
  vec2 scale;
  scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
  scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

  bool isPerspective = isPerspectiveMatrix( projectionMatrix );
  if ( isPerspective ) scale *= - mvPosition.z;

  vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
  vec2 rotatedPosition;
  rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
  rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
  mvPosition.xy += rotatedPosition;

  gl_Position = projectionMatrix * mvPosition;
}`;const At=new Z(0,0,0),Ln=new Z(0,0,0),$l=new Z(0,0,0);function Rr(t,e,r){const n=At.setFromMatrixPosition(t.matrixWorld);n.project(e);const o=r.width/2,a=r.height/2;return[(Number.isNaN(n.x)?0:n.x)*o+o,-(n.y*a)+a,n.z]}function Wl(t,e){const r=At.setFromMatrixPosition(t.matrixWorld),n=Ln.setFromMatrixPosition(e.matrixWorld),o=r.sub(n),a=e.getWorldDirection($l);return o.angleTo(a)>Math.PI/2}function ql(t,e,r,n){const o=At.setFromMatrixPosition(t.matrixWorld),a=o.clone();a.project(e),r.setFromCamera(new ve(a.x,a.y),e);const s=r.intersectObjects(n,!0);if(s.length>0){const i=s[0].distance;return o.distanceTo(r.ray.origin)<i}return!0}function Kl(t,e){if(e instanceof gt)return e.zoom;if(e instanceof De){const r=At.setFromMatrixPosition(t.matrixWorld),n=Ln.setFromMatrixPosition(e.matrixWorld),o=e.fov*Math.PI/180,a=r.distanceTo(n);return 1/(2*Math.tan(o/2)*a)}else return 1}function Zl(t,e,r){if(e instanceof De||e instanceof gt){const n=At.setFromMatrixPosition(t.matrixWorld),o=Ln.setFromMatrixPosition(e.matrixWorld),a=n.distanceTo(o),s=(r[1]-r[0])/(e.far-e.near),i=r[1]-s*e.far;return Math.round(s*a+i)}}const Pn=t=>Math.abs(t)<1e-10?0:t;function Co(t,e,r=""){let n="matrix3d(";for(let o=0;o!==16;o++)n+=Pn(e[o]*t.elements[o])+(o!==15?",":")");return r+n}const Xl=(t=>e=>Co(e,t))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),Jl=(t=>(e,r)=>Co(e,t(r),"translate(-50%,-50%)"))(t=>[1/t,1/t,1/t,1,-1/t,-1/t,-1/t,-1,1/t,1/t,1/t,1,1,1,1,1]),Ql=["geometry","material"];new Fr;var On={exports:{}},eu=On.exports,Cr;function tu(){return Cr||(Cr=1,function(t,e){(function(r,n){t.exports=n()})(eu,function(){var r=function(){function n(E){return s.appendChild(E.dom),E}function o(E){for(var g=0;g<s.children.length;g++)s.children[g].style.display=g===E?"block":"none";a=E}var a=0,s=document.createElement("div");s.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",s.addEventListener("click",function(E){E.preventDefault(),o(++a%s.children.length)},!1);var i=(performance||Date).now(),d=i,f=0,v=n(new r.Panel("FPS","#0ff","#002")),x=n(new r.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var w=n(new r.Panel("MB","#f08","#201"));return o(0),{REVISION:16,dom:s,addPanel:n,showPanel:o,begin:function(){i=(performance||Date).now()},end:function(){f++;var E=(performance||Date).now();if(x.update(E-i,200),E>d+1e3&&(v.update(1e3*f/(E-d),100),d=E,f=0,w)){var g=performance.memory;w.update(g.usedJSHeapSize/1048576,g.jsHeapSizeLimit/1048576)}return E},update:function(){i=this.end()},domElement:s,setMode:o}};return r.Panel=function(n,o,a){var s=1/0,i=0,d=Math.round,f=d(window.devicePixelRatio||1),v=80*f,x=48*f,w=3*f,E=2*f,g=3*f,M=15*f,m=74*f,R=30*f,P=document.createElement("canvas");P.width=v,P.height=x,P.style.cssText="width:80px;height:48px";var T=P.getContext("2d");return T.font="bold "+9*f+"px Helvetica,Arial,sans-serif",T.textBaseline="top",T.fillStyle=a,T.fillRect(0,0,v,x),T.fillStyle=o,T.fillText(n,w,E),T.fillRect(g,M,m,R),T.fillStyle=a,T.globalAlpha=.9,T.fillRect(g,M,m,R),{dom:P,update:function(O,S){s=Math.min(s,O),i=Math.max(i,O),T.fillStyle=a,T.globalAlpha=1,T.fillRect(0,0,v,M),T.fillStyle=o,T.fillText(d(O)+" "+n+" ("+d(s)+"-"+d(i)+")",w,E),T.drawImage(P,g+f,M,m-f,R,g,M,m-f,R),T.fillRect(g+m-f,M,f,R),T.fillStyle=a,T.globalAlpha=.9,T.fillRect(g+m-f,M,f,d((1-O/S)*R))}}},r})}(On)),On.exports}tu();const nu={key:0,args:[0,1,64]},ru={key:1,args:[.5,1,64]},ou={key:2},au=["tone-mapped","map","side","color"];new Ee(16777215);const iu=["matcap"],su={__name:"text",async setup(t){let e,r;const n=([e,r]=Kr(()=>Hi(["https://raw.githubusercontent.com/Tresjs/assets/main/textures/matcaps/7.png"])),e=await e,r(),e);return(o,a)=>(Ie(),qr(q(kl),{position:[-1,0,0],ref:"textRef",font:"https://raw.githubusercontent.com/Tresjs/assets/main/fonts/FiraCodeRegular.json"},{default:Ta(()=>[a[0]||(a[0]=Ea(" Three js text loader ")),jn("TresMeshMatcapMaterial",{matcap:q(n)},null,8,iu)]),_:1,__:[0]},512))}},du=Object.freeze(Object.defineProperty({__proto__:null,default:su},Symbol.toStringTag,{value:"Module"}));export{fu as V,su as _,pu as a,du as t};
