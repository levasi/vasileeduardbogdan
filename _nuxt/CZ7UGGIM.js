import{Z as be,$ as te,a0 as we,X as St,G as F,a1 as oe,k as se,a2 as At,p as H,r as M,I as D,M as Fe,U as kt,V as Lt,n as It,H as Bt,a3 as Dt,a4 as ve,l as z,N as ye,E as Oe,K as Rt,c as it,O as J,o as me,a5 as Ft,W as zt,a6 as $t,a7 as de,F as Ut,i as Nt,a8 as at,B as lt,w as ut,J as Vt,a9 as Wt,aa as Ht,a as Ce,q as Gt}from"./DofYlvBU.js";import{S as ct,P as Se,aE as Yt,W as Pe,N as dt,aR as qt,n as pt,q as Qt,C as ne,av as ft,Z as vt,aS as Jt,a5 as Xt,aT as Kt,_ as Zt,h as Ee,V as en,aU as tn,M as nn,Y as rn,a as on,r as sn}from"./BCBTOiXd.js";import{E as qe}from"./gR-v9Ok7.js";import{O as an}from"./HPw_EJD-.js";import{T as ln}from"./BZMZzGTJ.js";const ae="<div></div>",Me=new WeakMap;function un(e){if(Me.has(e))return Me.get(e);const t={...e};return t.render?t.render=(n,r,o,a,i,l)=>{if(a.mounted$??n.mounted$){const u=e.render?.bind(n)(n,r,o,a,i,l);return u.children===null||typeof u.children=="string"?be(u):te(u)}return we(n._.vnode.el,ae)}:t.template&&=`
      <template v-if="mounted$">${e.template}</template>
      <template v-else>${ae}</template>
    `,t.setup=(n,r)=>{const o=St(),a=F(o.isHydrating===!1),i=oe();if(o.isHydrating){const u={...i.attrs},s=cn(i);for(const d in u)delete i.attrs[d];se(()=>{Object.assign(i.attrs,u),i.vnode.dirs=s})}se(()=>{a.value=!0});const l=e.setup?.(n,r)||{};return At(l)?Promise.resolve(l).then(u=>typeof u!="function"?(u||={},u.mounted$=a,u):(...s)=>{if(a.value||!o.isHydrating){const d=u(...s);return d.children===null||typeof d.children=="string"?be(d):te(d)}return we(i?.vnode.el,ae)}):typeof l=="function"?(...u)=>{if(a.value){const s=l(...u);return s.children===null||typeof s.children=="string"?be(s,r.attrs):te(s,r.attrs)}return we(i?.vnode.el,ae)}:Object.assign(l,{mounted$:a})},Me.set(e,t),t}function cn(e){if(!e||!e.vnode.dirs)return null;const t=e.vnode.dirs;return e.vnode.dirs=null,t}function $(e){return kt()?(Lt(e),!0):!1}function B(){const e=new Set,t=o=>{e.delete(o)};return{on:o=>{e.add(o);const a=()=>t(o);return $(a),{off:a}},off:t,trigger:(...o)=>Promise.all(Array.from(e).map(a=>a(...o)))}}function j(e){return typeof e=="function"?e():H(e)}const Ae=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const dn=e=>e!=null,pn=Object.prototype.toString,fn=e=>pn.call(e)==="[object Object]",ke=()=>{};function vn(e,t){function n(...r){return new Promise((o,a)=>{Promise.resolve(e(()=>t.apply(this,r),{fn:t,thisArg:this,args:r})).then(o).catch(a)})}return n}function mn(e,t={}){let n,r,o=ke;const a=l=>{clearTimeout(l),o(),o=ke};return l=>{const u=j(e),s=j(t.maxWait);return n&&a(n),u<=0||s!==void 0&&s<=0?(r&&(a(r),r=null),Promise.resolve(l())):new Promise((d,p)=>{o=t.rejectOnCancel?p:d,s&&!r&&(r=setTimeout(()=>{n&&a(n),r=null,d(l())},s)),n=setTimeout(()=>{r&&a(r),r=null,d(l())},u)})}}function hn(e,t,n=!1){return t.reduce((r,o)=>(o in e&&(!n||e[o]!==void 0)&&(r[o]=e[o]),r),{})}function gn(e){return oe()}function yn(e,t=200,n={}){return vn(mn(t,n),e)}function Qe(e,t=200,n={}){const r=M(e.value),o=yn(()=>{r.value=e.value},t,n);return D(e,()=>o()),r}function _n(e,t={}){if(!Fe(e))return Bt(e);const n=Array.isArray(e.value)?Array.from({length:e.value.length}):{};for(const r in e.value)n[r]=Dt(()=>({get(){return e.value[r]},set(o){var a;if((a=j(t.replaceRef))!=null?a:!0)if(Array.isArray(e.value)){const l=[...e.value];l[r]=o,e.value=l}else{const l={...e.value,[r]:o};Object.setPrototypeOf(l,Object.getPrototypeOf(e.value)),e.value=l}else e.value[r]=o}}));return n}function ze(e,t=!0,n){gn()?se(e,n):t?e():It(e)}function bn(e,t=1e3,n={}){const{immediate:r=!0,immediateCallback:o=!1}=n;let a=null;const i=M(!1);function l(){a&&(clearInterval(a),a=null)}function u(){i.value=!1,l()}function s(){const d=j(t);d<=0||(i.value=!0,o&&e(),l(),i.value&&(a=setInterval(e,d)))}if(r&&Ae&&s(),Fe(t)||typeof t=="function"){const d=D(t,()=>{i.value&&Ae&&s()});$(d)}return $(u),{isActive:i,pause:u,resume:s}}const V=Ae?window:void 0;function R(e){var t;const n=j(e);return(t=n?.$el)!=null?t:n}function ie(...e){let t,n,r,o;if(typeof e[0]=="string"||Array.isArray(e[0])?([n,r,o]=e,t=V):[t,n,r,o]=e,!t)return ke;Array.isArray(n)||(n=[n]),Array.isArray(r)||(r=[r]);const a=[],i=()=>{a.forEach(d=>d()),a.length=0},l=(d,p,c,m)=>(d.addEventListener(p,c,m),()=>d.removeEventListener(p,c,m)),u=D(()=>[R(t),j(o)],([d,p])=>{if(i(),!d)return;const c=fn(p)?{...p}:p;a.push(...n.flatMap(m=>r.map(_=>l(d,m,_,c))))},{immediate:!0,flush:"post"}),s=()=>{u(),i()};return $(s),s}function wn(){const e=M(!1),t=oe();return t&&se(()=>{e.value=!0},t),e}function _e(e){const t=wn();return z(()=>(t.value,!!e()))}function Cn(e,t,n={}){const{window:r=V,...o}=n;let a;const i=_e(()=>r&&"MutationObserver"in r),l=()=>{a&&(a.disconnect(),a=void 0)},u=z(()=>{const c=j(e),m=(Array.isArray(c)?c:[c]).map(R).filter(dn);return new Set(m)}),s=D(()=>u.value,c=>{l(),i.value&&c.size&&(a=new MutationObserver(t),c.forEach(m=>a.observe(m,o)))},{immediate:!0,flush:"post"}),d=()=>a?.takeRecords(),p=()=>{s(),l()};return $(p),{isSupported:i,stop:p,takeRecords:d}}function $e(e,t={}){const{immediate:n=!0,fpsLimit:r=void 0,window:o=V}=t,a=M(!1),i=r?1e3/r:null;let l=0,u=null;function s(c){if(!a.value||!o)return;l||(l=c);const m=c-l;if(i&&m<i){u=o.requestAnimationFrame(s);return}l=c,e({delta:m,timestamp:c}),u=o.requestAnimationFrame(s)}function d(){!a.value&&o&&(a.value=!0,l=0,u=o.requestAnimationFrame(s))}function p(){a.value=!1,u!=null&&o&&(o.cancelAnimationFrame(u),u=null)}return n&&d(),$(p),{isActive:ve(a),pause:p,resume:d}}function Pn(e,t={}){const{window:n=V}=t,r=_e(()=>n&&"matchMedia"in n&&typeof n.matchMedia=="function");let o;const a=M(!1),i=s=>{a.value=s.matches},l=()=>{o&&("removeEventListener"in o?o.removeEventListener("change",i):o.removeListener(i))},u=ye(()=>{r.value&&(l(),o=n.matchMedia(j(e)),"addEventListener"in o?o.addEventListener("change",i):o.addListener(i),a.value=o.matches)});return $(()=>{u(),l(),o=void 0}),a}function En(e={}){const{window:t=V}=e,n=M(1);if(t){let r=function(){n.value=t.devicePixelRatio,o(),a=t.matchMedia(`(resolution: ${n.value}dppx)`),a.addEventListener("change",r,{once:!0})},o=function(){a?.removeEventListener("change",r)},a;r(),$(o)}return{pixelRatio:n}}function mt(e,t,n={}){const{window:r=V,...o}=n;let a;const i=_e(()=>r&&"ResizeObserver"in r),l=()=>{a&&(a.disconnect(),a=void 0)},u=z(()=>{const p=j(e);return Array.isArray(p)?p.map(c=>R(c)):[R(p)]}),s=D(u,p=>{if(l(),i.value&&r){a=new ResizeObserver(t);for(const c of p)c&&a.observe(c,o)}},{immediate:!0,flush:"post"}),d=()=>{l(),s()};return $(d),{isSupported:i,stop:d}}function Mn(e,t={}){const{reset:n=!0,windowResize:r=!0,windowScroll:o=!0,immediate:a=!0,updateTiming:i="sync"}=t,l=M(0),u=M(0),s=M(0),d=M(0),p=M(0),c=M(0),m=M(0),_=M(0);function v(){const P=R(e);if(!P){n&&(l.value=0,u.value=0,s.value=0,d.value=0,p.value=0,c.value=0,m.value=0,_.value=0);return}const g=P.getBoundingClientRect();l.value=g.height,u.value=g.bottom,s.value=g.left,d.value=g.right,p.value=g.top,c.value=g.width,m.value=g.x,_.value=g.y}function f(){i==="sync"?v():i==="next-frame"&&requestAnimationFrame(()=>v())}return mt(e,f),D(()=>R(e),P=>!P&&f()),Cn(e,f,{attributeFilter:["style","class"]}),o&&ie("scroll",f,{capture:!0,passive:!0}),r&&ie("resize",f,{passive:!0}),ze(()=>{a&&f()}),{height:l,bottom:u,left:s,right:d,top:p,width:c,x:m,y:_,update:f}}function xn(e,t={width:0,height:0},n={}){const{window:r=V,box:o="content-box"}=n,a=z(()=>{var p,c;return(c=(p=R(e))==null?void 0:p.namespaceURI)==null?void 0:c.includes("svg")}),i=M(t.width),l=M(t.height),{stop:u}=mt(e,([p])=>{const c=o==="border-box"?p.borderBoxSize:o==="content-box"?p.contentBoxSize:p.devicePixelContentBoxSize;if(r&&a.value){const m=R(e);if(m){const _=m.getBoundingClientRect();i.value=_.width,l.value=_.height}}else if(c){const m=Array.isArray(c)?c:[c];i.value=m.reduce((_,{inlineSize:v})=>_+v,0),l.value=m.reduce((_,{blockSize:v})=>_+v,0)}else i.value=p.contentRect.width,l.value=p.contentRect.height},n);ze(()=>{const p=R(e);p&&(i.value="offsetWidth"in p?p.offsetWidth:t.width,l.value="offsetHeight"in p?p.offsetHeight:t.height)});const s=D(()=>R(e),p=>{i.value=p?t.width:0,l.value=p?t.height:0});function d(){u(),s()}return{width:i,height:l,stop:d}}function Tn(e){var t;const n=M(0);if(typeof performance>"u")return n;const r=(t=e?.every)!=null?t:10;let o=performance.now(),a=0;return $e(()=>{if(a+=1,a>=r){const i=performance.now(),l=i-o;n.value=Math.round(1e3/(l/a)),o=i,a=0}}),n}function jn(e={}){const t=M(),n=_e(()=>typeof performance<"u"&&"memory"in performance);if(n.value){const{interval:r=1e3}=e;bn(()=>{t.value=performance.memory},r,{immediate:e.immediate,immediateCallback:e.immediateCallback})}return{isSupported:n,memory:t}}const ht={x:0,y:0,pointerId:0,pressure:0,tiltX:0,tiltY:0,width:0,height:0,twist:0,pointerType:null},On=Object.keys(ht);function Sn(e={}){const{target:t=V}=e,n=M(!1),r=M(e.initialValue||{});Object.assign(r.value,ht,r.value);const o=a=>{n.value=!0,!(e.pointerTypes&&!e.pointerTypes.includes(a.pointerType))&&(r.value=hn(a,On,!1))};if(t){const a={passive:!0};ie(t,["pointerdown","pointermove","pointerup"],o,a),ie(t,"pointerleave",()=>n.value=!1,a)}return{..._n(r),isInside:n}}function An(e={}){const{window:t=V,initialWidth:n=Number.POSITIVE_INFINITY,initialHeight:r=Number.POSITIVE_INFINITY,listenOrientation:o=!0,includeScrollbar:a=!0,type:i="inner"}=e,l=M(n),u=M(r),s=()=>{t&&(i==="outer"?(l.value=t.outerWidth,u.value=t.outerHeight):a?(l.value=t.innerWidth,u.value=t.innerHeight):(l.value=t.document.documentElement.clientWidth,u.value=t.document.documentElement.clientHeight))};if(s(),ze(s),ie("resize",s,{passive:!0}),o){const d=Pn("(orientation: portrait)");D(d,()=>s())}return{width:l,height:u}}var kn=Object.defineProperty,Ln=(e,t,n)=>t in e?kn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Je=(e,t,n)=>Ln(e,typeof t!="symbol"?t+"":t,n);const In="@tresjs/core",Bn="module",Dn="4.3.1",Rn="pnpm@9.1.4",Fn="Declarative ThreeJS using Vue Components",zn="Alvaro Saburido <hola@alvarosaburido.dev> (https://github.com/alvarosabu/)",$n="MIT",Un={type:"git",url:"git+https://github.com/Tresjs/tres.git"},Nn=["vue","3d","threejs","three","threejs-vue"],Vn=!1,Wn={".":{types:"./dist/index.d.ts",import:"./dist/tres.js",require:"./dist/tres.umd.cjs"},"./components":{types:"./dist/src/components/index.d.ts"},"./composables":{types:"./dist/src/composables/index.d.ts"},"./types":{types:"./dist/src/types/index.d.ts"},"./utils":{types:"./dist/src/utils/index.d.ts"},"./*":"./*"},Hn="./dist/tres.js",Gn="./dist/tres.js",Yn="./dist/index.d.ts",qn=["*.d.ts","dist"],Qn={access:"public"},Jn={dev:"cd playground/vue && npm run dev","dev:nuxt":"cd playground/nuxt && npm run dev",build:"vite build",test:"vitest","test:ci":"vitest run","test:ui":"vitest --ui --coverage.enabled=true",release:"release-it",coverage:"vitest run --coverage",lint:"eslint .","lint:fix":"eslint . --fix","docs:dev":"vitepress dev docs","docs:build":"vitepress build docs","docs:serve":"vitepress serve docs","docs:preview":"vitepress preview docs","docs:contributors":"esno scripts/update-contributors.ts"},Xn={three:">=0.133",vue:">=3.4"},Kn={"@alvarosabu/utils":"^3.2.0","@vue/devtools-api":"^6.6.3","@vueuse/core":"^11.1.0"},Zn={"@release-it/conventional-changelog":"^9.0.0","@stackblitz/sdk":"^1.11.0","@tresjs/cientos":"4.0.3","@tresjs/eslint-config":"^1.4.0","@types/three":"^0.169.0","@typescript-eslint/eslint-plugin":"^8.8.1","@typescript-eslint/parser":"^8.8.1","@vitejs/plugin-vue":"^5.1.4","@vitest/coverage-c8":"^0.33.0","@vitest/coverage-v8":"^2.1.2","@vitest/ui":"^2.1.2","@vue/test-utils":"^2.4.6",eslint:"^9.12.0","eslint-plugin-vue":"^9.29.0",esno:"^4.8.0",gsap:"^3.12.5",husky:"^9.1.6",jsdom:"^25.0.1",kolorist:"^1.8.0",ohmyfetch:"^0.4.21",pathe:"^1.1.2","release-it":"^17.8.2","rollup-plugin-analyzer":"^4.0.0","rollup-plugin-copy":"^3.5.0","rollup-plugin-visualizer":"^5.12.0",sponsorkit:"^0.15.5",three:"^0.169.0",unocss:"^0.63.4",unplugin:"^1.14.1","unplugin-vue-components":"^0.27.4",vite:"^5.4.8","vite-plugin-banner":"^0.8.0","vite-plugin-dts":"4.2.4","vite-plugin-inspect":"^0.8.7","vite-plugin-require-transform":"^1.0.21","vite-svg-loader":"^5.1.0",vitepress:"1.4.0",vitest:"^2.1.2",vue:"3.5.12","vue-demi":"^0.14.10"},er={name:In,type:Bn,version:Dn,packageManager:Rn,description:Fn,author:zn,license:$n,repository:Un,keywords:Nn,sideEffects:Vn,exports:Wn,main:Hn,module:Gn,types:Yn,files:qn,publishConfig:Qn,scripts:Jn,peerDependencies:Xn,dependencies:Kn,devDependencies:Zn};class tr extends on{constructor(...t){super(...t),Je(this,"type","HightlightMesh"),Je(this,"createTime"),this.createTime=Date.now()}onBeforeRender(){const t=(Date.now()-this.createTime)/1e3,n=1+.07*Math.sin(2.5*t);this.scale.set(n,n,n)}}function Le(e){return typeof e>"u"}function he(e){return Array.isArray(e)}function nr(e){return typeof e=="number"}function gt(e){return typeof e=="string"}function q(e){return typeof e=="function"}function W(e){return e===Object(e)&&!he(e)&&!q(e)}function G(e){return W(e)&&"isObject3D"in e&&!!e.isObject3D}function Xe(e){return W(e)&&"isCamera"in e&&!!e.isCamera}function rr(e){return W(e)&&"isBufferGeometry"in e&&!!e.isBufferGeometry}function or(e){return W(e)&&"isMaterial"in e&&!!e.isMaterial}function sr(e){return W(e)&&"isLight"in e&&!!e.isLight}function ir(e){return W(e)&&"isFog"in e&&!!e.isFog}function ar(e){return W(e)&&"isScene"in e&&!!e.isScene}function le(e){return G(e)||rr(e)||or(e)||ir(e)}function lr(e){return W(e)&&!!e.isPrimitive}const yt=(e,t)=>{for(const n of Object.keys(t))t[n]instanceof Object&&Object.assign(t[n],yt(e[n],t[n]));return Object.assign(e||{},t),e},ur="html,body,base,head,link,meta,style,title,address,article,aside,footer,header,hgroup,h1,h2,h3,h4,h5,h6,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,summary,template,blockquote,iframe,tfoot",cr=fr(ur);function Ke(e){return e&&e.nodeType===1}function ue(e){return e.replace(/-([a-z])/g,(t,n)=>n.toUpperCase())}const dr=/\B([A-Z])/g;function pr(e){return e.replace(dr,"-$1").toLowerCase()}function fr(e,t){const n=Object.create(null),r=e.split(",");for(let o=0;o<r.length;o++)n[r[o]]=!0;return o=>!!n[o]}const Ze=(e,t)=>{if(!t)return;const n=Array.isArray(t)?t:t.match(/([^[.\]])+/g);return n?.reduce((r,o)=>r&&r[o],e)},vr=(e,t,n)=>{const r=Array.isArray(t)?t:t.match(/([^[.\]])+/g);r&&r.reduce((o,a,i)=>(o[a]===void 0&&(o[a]={}),i===r.length-1&&(o[a]=n),o[a]),e)};function _t(e,t){if(Ke(e)&&Ke(t)){const o=e.attributes,a=t.attributes;return o.length!==a.length?!1:Array.from(o).every(({name:i,value:l})=>t.getAttribute(i)===l)}if(e===t)return!0;if(e===null||typeof e!="object"||t===null||typeof t!="object")return!1;const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const o of n)if(!r.includes(o)||!_t(e[o],t[o]))return!1;return!0}function mr(e,t){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!_t(e[n],t[n]))return!1;return!0}function hr(e,t,n,r){const o=u=>{if(u.uuid===t)return u;for(const s of u.children){const d=o(s);if(d)return d}},a=o(e);if(!a){console.warn("Object with UUID not found in the scene.");return}let i=a;for(let u=0;u<n.length-1;u++)if(i[n[u]]!==void 0)i=i[n[u]];else{console.warn(`Property path is not valid: ${n.join(".")}`);return}const l=n[n.length-1];i[l]!==void 0?i[l]=r:console.warn(`Property path is not valid: ${n.join(".")}`)}function gr(e){const t=new nn({color:11003607,transparent:!0,opacity:.2,depthTest:!1,side:rn});return new tr(e.geometry.clone(),t)}function yr(e){return"map"in e}function et(e){yr(e)&&e.map&&e.map.dispose(),e.dispose()}function bt(e){var t,n;if(e.parent&&((t=e.removeFromParent)==null||t.call(e)),delete e.__tres,[...e.children].forEach(r=>bt(r)),!(e instanceof ct)){const r=e;e&&((n=e.dispose)==null||n.call(e)),r.geometry&&(r.geometry.dispose(),delete r.geometry),Array.isArray(r.material)?(r.material.forEach(o=>et(o)),delete r.material):r.material&&(et(r.material),delete r.material)}}function _r(e,t){let n=0;for(let r=0;r<e.length;r++)t(e[r],r)&&(e[n]=e[r],n++);return e.length=n,e}function Ie(e,t){let n=e;if(t.includes("-")){const r=t.split("-");let o=r.shift();for(;n&&r.length;)o in n?(n=n[o],o=r.shift()):o=tt(o,r.shift());return{target:n,key:tt(o,...r)}}else return{target:n,key:t}}function tt(...e){return e.map((t,n)=>n===0?t:t.charAt(0).toUpperCase()+t.slice(1)).join("")}const nt=/-\d+$/;function br(e,t,n){if(gt(n)){if(nt.test(n)){const a=n.replace(nt,""),{target:i,key:l}=Ie(e,a);if(!Array.isArray(i[l])){const u=i[l],s=[];s.__tresDetach=()=>{s.every(d=>Le(d))&&(i[l]=u)},i[l]=s}}const{target:r,key:o}=Ie(e,n);t.__tres.previousAttach=r[o],r[o]=X(t)}else t.__tres.previousAttach=n(e,t)}function wr(e,t,n){var r,o,a;if(gt(n)){const{target:i,key:l}=Ie(e,n),u=t.__tres.previousAttach;u===void 0?delete i[l]:i[l]=u,"__tresDetach"in i&&i.__tresDetach()}else(o=(r=t.__tres)==null?void 0:r.previousAttach)==null||o.call(r,e,t);(a=t.__tres)==null||delete a.previousAttach}function Y(e,t,n){const r=e;return r.__tres={type:"unknown",eventCount:0,root:n,handlers:{},memoizedProps:{},objects:[],parent:null,previousAttach:null,...t},r.__tres.attach||(r.isMaterial?r.__tres.attach="material":r.isBufferGeometry?r.__tres.attach="geometry":r.isFog&&(r.__tres.attach="fog")),r}function wt(e){var t;const n=(t=e?.__tres)==null?void 0:t.root;n&&n.render&&n.render.canBeInvalidated.value&&n.invalidate()}function Cr(e,t,n){var r;if(!q(e.setPixelRatio))return;let o=0;if(he(n)&&n.length>=2){const[a,i]=n;o=vt.clamp(t,a,i)}else nr(n)?o=n:o=t;o!==((r=e.getPixelRatio)==null?void 0:r.call(e))&&e.setPixelRatio(o)}function Pr(e,t,n,r,o){const a=[...t.__tres.objects],i=X(t);if(e=X(e),i===e)return!0;const l=Y(e,t.__tres??{},o),u=t.parent??t.__tres.parent??null,s={...t.__tres.memoizedProps};delete s.object;for(const d of a)Ct(d,o),Pt(d,o);i.__tres.objects=[],r.remove(t);for(const[d,p]of Object.entries(s))r.patchProp(l,d,l[d],p);n(e),r.insert(t,u);for(const d of a)r.insert(d,t);return!0}function X(e){return lr(e)?(e.object.__tres=e.__tres,e.object):e}function Ct(e,t){var n,r,o,a;const i=((n=e.__tres)==null?void 0:n.parent)||t.scene.value;e.__tres&&(e.__tres.parent=null),i&&i.__tres&&"objects"in i.__tres&&_r(i.__tres.objects,l=>l!==e),(r=e.__tres)!=null&&r.attach?wr(i,e,e.__tres.attach):((a=(o=e.parent)==null?void 0:o.remove)==null||a.call(o,X(e)),e.parent=null)}function Pt(e,t){var n;(n=e.traverse)==null||n.call(e,r=>{var o;t.deregisterCamera(r),(o=t.eventManager)==null||o.deregisterPointerMissedObject(r)}),t.deregisterCamera(e),wt(e)}const Er=({sizes:e})=>{const t=M([]),n=z(()=>t.value[0]),r=i=>{const l=i instanceof Kt?i:t.value.find(s=>s.uuid===i);if(!l)return;const u=t.value.filter(({uuid:s})=>s!==l.uuid);t.value=[l,...u]},o=(i,l=!1)=>{if(Xe(i)){const u=i;if(t.value.some(({uuid:s})=>s===u.uuid))return;l?r(u):t.value.push(u)}},a=i=>{if(Xe(i)){const l=i;t.value=t.value.filter(({uuid:u})=>u!==l.uuid)}};return ye(()=>{e.aspectRatio.value&&t.value.forEach(i=>{!i.manual&&(i instanceof Se||Mr(i))&&(i instanceof Se?i.aspect=e.aspectRatio.value:(i.left=e.width.value*-.5,i.right=e.width.value*.5,i.top=e.height.value*.5,i.bottom=e.height.value*-.5),i.updateProjectionMatrix())})}),J(()=>{t.value=[]}),{camera:n,cameras:t,registerCamera:o,deregisterCamera:a,setCameraActive:r}};function Mr(e){return e.hasOwnProperty("isOrthographicCamera")&&e.isOrthographicCamera}const ge="[TresJS ▲ ■ ●] ";function xr(...e){typeof e[0]=="string"?e[0]=ge+e[0]:e.unshift(ge),console.error(...e)}function Tr(...e){typeof e[0]=="string"?e[0]=ge+e[0]:e.unshift(ge),console.warn(...e)}function jr(e,t){}function Ue(){return{logError:xr,logWarning:Tr,logMessage:jr}}const Be=M({}),De=e=>Object.assign(Be.value,e);function xe(){const e=new Map,t=new Set;let n=0,r=!1;const o=()=>{const i=Array.from(e.entries()).sort((l,u)=>{const s=l[1].priority-u[1].priority;return s===0?l[1].addI-u[1].addI:s});t.clear(),i.forEach(l=>t.add(l[0]))},a=i=>{e.delete(i),t.delete(i)};return{on:(i,l=0)=>{e.set(i,{priority:l,addI:n++});const u=()=>a(i);return $(u),r=!0,{off:u}},off:a,trigger:(...i)=>{r&&(o(),r=!1),t.forEach(l=>l(...i))},dispose:()=>{e.clear(),t.clear()},get count(){return e.size}}}function Or(){let e=!0,t=!0,n=!1;const r=new ft(!1),o=M(r.running),a=M(!1);let i;const l=vt.generateUUID();let u=null;const s=xe(),d=xe(),p=xe();T();let c={};function m(E){c=E}function _(E,S,h=0){switch(S){case"before":return s.on(E,h);case"render":return u||(u=E),d.dispose(),d.on(E);case"after":return p.on(E,h)}}function v(){t&&(t=!1,T(),C())}function f(){t=!0,T(),cancelAnimationFrame(i)}function P(){n=!1,T()}function g(){n=!0,T()}function b(){a.value=!0}function x(){a.value=!1}function C(){if(!e){i=requestAnimationFrame(C);return}const E=r.getDelta(),S=r.getElapsedTime(),h={camera:H(c.camera),scene:H(c.scene),renderer:H(c.renderer),raycaster:H(c.raycaster),controls:H(c.controls),invalidate:c.invalidate,advance:c.advance},w={delta:E,elapsed:S,clock:r,...h};o.value&&s.trigger(w),a.value||(d.count?d.trigger(w):u&&u(w)),o.value&&p.trigger(w),i=requestAnimationFrame(C)}function T(){const E=!t&&!n;r.running!==E&&(r.running?r.stop():r.start()),o.value=r.running}return{loopId:l,register:(E,S,h)=>_(E,S,h),start:v,stop:f,pause:g,resume:P,pauseRender:b,resumeRender:x,isRenderPaused:a,isActive:o,setContext:m,setReady:E=>e=E}}function Ne(e){let t=0;return e.traverse(n=>{if(n.isMesh&&n.geometry&&n.type!=="HightlightMesh"){const r=n.geometry,o=r.attributes.position.count*3*Float32Array.BYTES_PER_ELEMENT,a=r.index?r.index.count*Uint32Array.BYTES_PER_ELEMENT:0,i=r.attributes.normal?r.attributes.normal.count*3*Float32Array.BYTES_PER_ELEMENT:0,l=r.attributes.uv?r.attributes.uv.count*2*Float32Array.BYTES_PER_ELEMENT:0,u=o+a+i+l;t+=u}}),t}function Sr(e){return(e/1024).toFixed(2)}const Ar=Number.parseInt(Zt.replace("dev",""));function kr(e){return e instanceof ne?e:Array.isArray(e)?new ne(...e):new ne(e)}const ce={realistic:{shadows:!0,physicallyCorrectLights:!0,outputColorSpace:Qt,toneMapping:pt,toneMappingExposure:3,shadowMap:{enabled:!0,type:qt}},flat:{toneMapping:dt,toneMappingExposure:1}};function Lr({canvas:e,options:t,contextParts:{sizes:n,render:r,invalidate:o,advance:a}}){const i=z(()=>({alpha:j(t.alpha)??!0,depth:j(t.depth),canvas:R(e),context:j(t.context),stencil:j(t.stencil),antialias:j(t.antialias)??!0,precision:j(t.precision),powerPreference:j(t.powerPreference),premultipliedAlpha:j(t.premultipliedAlpha),preserveDrawingBuffer:j(t.preserveDrawingBuffer),logarithmicDepthBuffer:j(t.logarithmicDepthBuffer),failIfMajorPerformanceCaveat:j(t.failIfMajorPerformanceCaveat)})),l=F(new Pe(i.value));function u(){t.renderMode==="on-demand"&&o()}D(i,()=>{l.value.dispose(),l.value=new Pe(i.value),u()}),D([n.width,n.height],()=>{l.value.setSize(n.width.value,n.height.value),u()},{immediate:!0}),D(()=>t.clearColor,u);const{pixelRatio:s}=En(),{logError:d}=Ue(),p=(()=>{const m=new Pe,_={shadowMap:{enabled:m.shadowMap.enabled,type:m.shadowMap.type},toneMapping:m.toneMapping,toneMappingExposure:m.toneMappingExposure,outputColorSpace:m.outputColorSpace};return m.dispose(),_})(),c=j(t.renderMode);return c==="on-demand"&&o(),c==="manual"&&setTimeout(()=>{a()},100),ye(()=>{const m=j(t.preset);m&&(m in ce||d(`Renderer Preset must be one of these: ${Object.keys(ce).join(", ")}`),yt(l.value,ce[m])),Cr(l.value,s.value,j(t.dpr)),c==="always"&&(r.frames.value=Math.max(1,r.frames.value));const _=(P,g)=>{const b=j(P),x=()=>{if(m)return Ze(ce[m],g)};if(b!==void 0)return b;const C=x();return C!==void 0?C:Ze(p,g)},v=(P,g)=>vr(l.value,g,_(P,g));v(t.shadows,"shadowMap.enabled"),v(t.toneMapping??pt,"toneMapping"),v(t.shadowMapType,"shadowMap.type"),Ar<150&&v(!t.useLegacyLights,"physicallyCorrectLights"),v(t.outputColorSpace,"outputColorSpace"),v(t.toneMappingExposure,"toneMappingExposure");const f=_(t.clearColor,"clearColor");f&&l.value.setClearColor(f?kr(f):new ne(0))}),J(()=>{l.value.dispose(),l.value.forceContextLoss()}),{renderer:l}}function Ir(e,t,n=10){const r=j(e)?An():xn(z(()=>j(t).parentElement)),o=ve(Qe(r.width,n)),a=ve(Qe(r.height,n)),i=z(()=>o.value/a.value);return{height:a,width:o,aspectRatio:i}}const Br=(e,t)=>{const n=z(()=>t.renderer.value.domElement),r=F([]),{x:o,y:a}=Sn({target:n});let i=0;const{width:l,height:u,top:s,left:d}=Mn(n),p=({x:y,y:O})=>{if(n.value)return{x:(y-d.value)/l.value*2-1,y:-((O-s.value)/u.value)*2+1}},c=({x:y,y:O})=>{if(t.camera.value)return t.raycaster.value.setFromCamera(new Ee(y,O),t.camera.value),r.value=t.raycaster.value.intersectObjects(e.value,!0),r.value},m=y=>{const O=p({x:y?.clientX??o.value,y:y?.clientY??a.value});return O?c(O)||[]:[]},_=B(),v=B(),f=B(),P=B(),g=B(),b=B(),x=B(),C=B();function T(y){const O={};for(const N in y)typeof N!="function"&&(O[N]=y[N]);return O}const E=(y,O)=>{var N,K,Ye;const jt=T(O),Ot=new en(O?.clientX,O?.clientY,0).unproject((N=t.camera)==null?void 0:N.value);y.trigger({...jt,intersections:r.value,unprojectedPoint:Ot,ray:(K=t.raycaster)==null?void 0:K.value.ray,camera:(Ye=t.camera)==null?void 0:Ye.value,sourceEvent:O,delta:i,stopPropagating:!1})};let S;const h=y=>{m(y),E(f,y),S=y},w=()=>{S&&h(S)};let A,k,L;const U=y=>{var O;A=(O=r.value[0])==null?void 0:O.object,i=0,k=new Ee(y?.clientX??o.value,y?.clientY??a.value),E(g,y)};let I,Q=!1;const Ve=y=>{var O,N,K;y instanceof PointerEvent&&(r.value.length===0&&E(b,y),A===((O=r.value[0])==null?void 0:O.object)&&(L=new Ee(y?.clientX??o.value,y?.clientY??a.value),i=k?.distanceTo(L),y.button===0?(E(_,y),I===((N=r.value[0])==null?void 0:N.object)?Q=!0:(I=(K=r.value[0])==null?void 0:K.object,Q=!1)):y.button===2&&E(x,y)),E(P,y))},We=y=>{Q&&(E(v,y),I=void 0,Q=!1)},He=y=>E(f,y),Ge=y=>E(C,y);return n.value.addEventListener("pointerup",Ve),n.value.addEventListener("pointerdown",U),n.value.addEventListener("pointermove",h),n.value.addEventListener("pointerleave",He),n.value.addEventListener("dblclick",We),n.value.addEventListener("wheel",Ge),J(()=>{n!=null&&n.value&&(n.value.removeEventListener("pointerup",Ve),n.value.removeEventListener("pointerdown",U),n.value.removeEventListener("pointermove",h),n.value.removeEventListener("pointerleave",He),n.value.removeEventListener("dblclick",We),n.value.removeEventListener("wheel",Ge))}),{intersects:r,onClick:y=>_.on(y).off,onDblClick:y=>v.on(y).off,onContextMenu:y=>x.on(y).off,onPointerMove:y=>f.on(y).off,onPointerUp:y=>P.on(y).off,onPointerDown:y=>g.on(y).off,onPointerMissed:y=>b.on(y).off,onWheel:y=>C.on(y).off,forceUpdate:w}};function Te(e,t){if(Array.isArray(e))for(const n of e)n(t);typeof e=="function"&&e(t)}function Dr(e,t,n){var r;const o=F(),a=F();e&&(o.value=e),t&&(a.value=t);const i=h=>{var w;return((w=h.__tres)==null?void 0:w.eventCount)>0},l=h=>{var w;return((w=h.children)==null?void 0:w.some(A=>l(A)))||i(h)},u=F(((r=o.value)==null?void 0:r.children).filter(l)||[]);function s(h,w){const A=[],k=()=>w.stopPropagating=!0;w.stopPropagation=k;for(const L of w?.intersections){if(w.stopPropagating)return;w={...w,...L};const{object:U}=L;w.eventObject=U,Te(U[h],w),A.push(U);let I=U.parent;for(;I!==null&&!w.stopPropagating&&!A.includes(I);)w.eventObject=I,Te(I[h],w),A.push(I),I=I.parent;const Q=pr(h.slice(2));n(Q,{intersection:L,event:w})}}const{onClick:d,onDblClick:p,onContextMenu:c,onPointerMove:m,onPointerDown:_,onPointerUp:v,onPointerMissed:f,onWheel:P,forceUpdate:g}=Br(u,t);v(h=>s("onPointerUp",h)),_(h=>s("onPointerDown",h)),d(h=>s("onClick",h)),p(h=>s("onDoubleClick",h)),c(h=>s("onContextMenu",h)),P(h=>s("onWheel",h));let b=[];m(h=>{const w=h.intersections.map(({object:k})=>k),A=h.intersections;b.forEach(({object:k})=>{w.includes(k)||(h.intersections=b,s("onPointerLeave",h),s("onPointerOut",h))}),h.intersections=A,h.intersections.forEach(({object:k})=>{b.includes(k)||(s("onPointerEnter",h),s("onPointerOver",h))}),s("onPointerMove",h),b=h.intersections});const x=[];f(h=>{const w=()=>h.stopPropagating=!0;h.stopPropagation=w,x.forEach(A=>{h.stopPropagating||(h.eventObject=A,Te(A.onPointerMissed,h))}),n("pointer-missed",{event:h})});function C(h){le(h)&&G(h)&&u.value.push(h)}function T(h){if(le(h)&&G(h)){const w=u.value.indexOf(h);w>-1&&u.value.splice(w,1)}}function E(h){le(h)&&G(h)&&h.onPointerMissed&&x.push(h)}function S(h){if(le(h)&&G(h)){const w=x.indexOf(h);w>-1&&x.splice(w,1)}}return t.eventManager={forceUpdate:g,registerObject:C,deregisterObject:T,registerPointerMissedObject:E,deregisterPointerMissedObject:S},{forceUpdate:g,registerObject:C,deregisterObject:T,registerPointerMissedObject:E,deregisterPointerMissedObject:S}}function Rr(e,t,n=100){n=n<=0?100:n;const r=B(),o=new Set;let a=!1,i=!1,l=null;function u(){l&&clearTimeout(l),!i&&!a&&e()?(r.trigger(t),o.forEach(p=>p()),o.clear(),a=!0):!i&&!a&&(l=setTimeout(u,n))}function s(){i=!0,l&&clearTimeout(l)}u();const d=(p,...c)=>{p(...c)};return{on:p=>{if(a)return d(p,t),{off:()=>{}};{const c=r.on(p);return o.add(c.off),r.on(p)}},off:r.off,trigger:r.trigger,cancel:s}}const je=new WeakMap;function Fr(e){if(e=e||$r(),je.has(e))return je.get(e);const t=100,n=Date.now(),r=Rr(()=>{if(Date.now()-n>=t)return!0;{const o=e.renderer.value,a=o?.domElement||{width:0,height:0};return!!(o&&a.width>0&&a.height>0)}},e);return je.set(e,r),r}function zr({scene:e,canvas:t,windowSize:n,rendererOptions:r,emit:o}){const a=F(e),i=Ir(n,t),{camera:l,cameras:u,registerCamera:s,deregisterCamera:d,setCameraActive:p}=Er({sizes:i}),c={mode:M(r.renderMode||"always"),priority:M(0),frames:M(0),maxFrames:60,canBeInvalidated:z(()=>c.mode.value==="on-demand"&&c.frames.value===0)};function m(L=1){r.renderMode==="on-demand"&&(c.frames.value=Math.min(c.maxFrames,c.frames.value+L))}function _(){r.renderMode==="manual"&&(c.frames.value=1)}const{renderer:v}=Lr({canvas:t,options:r,contextParts:{sizes:i,render:c,invalidate:m,advance:_}}),f={sizes:i,scene:a,camera:l,cameras:ve(u),renderer:v,raycaster:F(new Yt),controls:M(null),perf:{maxFrames:160,fps:{value:0,accumulator:[]},memory:{currentMem:0,allocatedMem:0,accumulator:[]}},render:c,advance:_,extend:De,invalidate:m,registerCamera:s,setCameraActive:p,deregisterCamera:d,loop:Or()};de("useTres",f),f.scene.value.__tres={root:f},f.loop.register(()=>{l.value&&c.frames.value>0&&(v.value.render(e,l.value),o("render",f.renderer.value)),c.priority.value=0,c.mode.value==="always"?c.frames.value=1:c.frames.value=Math.max(0,c.frames.value-1)},"render");const{on:P,cancel:g}=Fr(f);f.loop.setReady(!1),f.loop.start(),P(()=>{o("ready",f),f.loop.setReady(!0),Dr(e,f,o)}),J(()=>{g(),f.loop.stop()});const b=100,x=Tn({every:b}),{isSupported:C,memory:T}=jn({interval:b}),E=160;let S=performance.now();const h=({timestamp:L})=>{f.scene.value&&(f.perf.memory.allocatedMem=Ne(f.scene.value)),L-S>=b&&(S=L,f.perf.fps.accumulator.push(x.value),f.perf.fps.accumulator.length>E&&f.perf.fps.accumulator.shift(),f.perf.fps.value=x.value,C.value&&T.value&&(f.perf.memory.accumulator.push(T.value.usedJSHeapSize/1024/1024),f.perf.memory.accumulator.length>E&&f.perf.memory.accumulator.shift(),f.perf.memory.currentMem=f.perf.memory.accumulator.reduce((U,I)=>U+I,0)/f.perf.memory.accumulator.length))};let w=0;const A=1,{pause:k}=$e(({delta:L})=>{window.__TRES__DEVTOOLS__&&(h({timestamp:performance.now()}),w+=L,w>=A&&(window.__TRES__DEVTOOLS__.cb(f),w=0))},{immediate:!0});return J(()=>{k()}),f}function $r(){const e=Nt("useTres");if(!e)throw new Error("useTresContext must be used together with useTresContextProvider");return e}const Ur=B(),Nr=B(),Et=B(),re=new ft;let pe=0,fe=0;$e(()=>{Ur.trigger({delta:pe,elapsed:fe,clock:re}),Nr.trigger({delta:pe,elapsed:fe,clock:re}),Et.trigger({delta:pe,elapsed:fe,clock:re})},{immediate:!1});Et.on(()=>{pe=re.getDelta(),fe=re.getElapsedTime()});function Vr(e,t={},n={}){let r=e;const o=l=>{r=l};let a=new Proxy({},{});const i={has(l,u){return u in t||u in r},get(l,u,s){return u in t?t[u](r):r[u]},set(l,u,s){return n[u]?n[u](s,r,a,o):r[u]=s,!0}};return a=new Proxy({},i),a}const{logError:rt}=Ue(),ot=["onClick","onContextMenu","onPointerMove","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut","onDoubleClick","onPointerDown","onPointerUp","onPointerCancel","onPointerMissed","onLostPointerCapture","onWheel"],Wr=e=>{const t=e.scene.value;function n(s,d,p,c){if(c||(c={}),c.args||(c.args=[]),s==="template"||cr(s))return null;let m=s.replace("Tres",""),_;if(s==="primitive"){(!W(c.object)||Fe(c.object))&&rt("Tres primitives need an 'object' prop, whose value is an object or shallowRef<object>"),m=c.object.type;const v={};_=Vr(c.object,{object:f=>f,isPrimitive:()=>!0,__tres:()=>v},{object:(f,P,g,b)=>{Pr(f,g,b,{patchProp:a,remove:o,insert:r},e)},__tres:f=>{Object.assign(v,f)}})}else{const v=Be.value[m];v||rt(`${m} is not defined on the THREE namespace. Use extend to add it to the catalog.`),_=new v(...c.args)}return _?(_.isCamera&&(c!=null&&c.position||_.position.set(3,3,3),c!=null&&c.lookAt||_.lookAt(0,0,0)),_=Y(_,{..._.__tres,type:m,memoizedProps:c,eventCount:0,primitive:s==="primitive",attach:c.attach},e),_):null}function r(s,d){var p,c,m;if(!s)return;d=d||t;const _=s.__tres?s:Y(s,{},e),v=d.__tres?d:Y(d,{},e);s=X(_),d=X(v),s.__tres&&((p=s.__tres)==null?void 0:p.eventCount)>0&&((c=e.eventManager)==null||c.registerObject(s)),e.registerCamera(s),(m=e.eventManager)==null||m.registerPointerMissedObject(s),_.__tres.attach?br(v,_,_.__tres.attach):G(s)&&G(v)&&(v.add(s),s.dispatchEvent({type:"added"})),_.__tres.parent=v,v.__tres.objects&&!v.__tres.objects.includes(_)&&v.__tres.objects.push(_)}function o(s,d){var p,c,m,_;if(!s)return;s!=null&&s.__tres&&((p=s.__tres)==null?void 0:p.eventCount)>0&&((c=e.eventManager)==null||c.deregisterObject(s)),d=Le(d)?"default":d;const v=(m=s.__tres)==null?void 0:m.dispose;Le(v)||(v===null?d=!1:d=v);const f=(_=s.__tres)==null?void 0:_.primitive,P=d==="default"?!f:!!d;if(s.__tres&&"objects"in s.__tres&&[...s.__tres.objects].forEach(g=>o(g,d)),P&&s.children&&[...s.children].forEach(g=>o(g,d)),Ct(s,e),Pt(s,e),P&&!ar(s)){if(q(d))d(s);else if(q(s.dispose))try{s.dispose()}catch{}}"__tres"in s&&delete s.__tres}function a(s,d,p,c){var m,_;if(!s)return;let v=s,f=d;if(s.__tres&&(s.__tres.memoizedProps[d]=c),d==="attach"){const x=((m=s.__tres)==null?void 0:m.parent)||s.parent;o(s),Y(s,{attach:c},e),x&&r(s,x);return}if(d==="dispose"){s.__tres||(s=Y(s,{},e)),s.__tres.dispose=c;return}if(G(s)&&f==="blocks-pointer-events"){c||c===""?s[f]=c:delete s[f];return}ot.includes(d)&&s.__tres&&(s.__tres.eventCount+=1);let P=ue(f),g=v?.[P];if(f==="args"){const x=s,C=p??[],T=c??[],E=((_=s.__tres)==null?void 0:_.type)||s.type;E&&C.length&&!mr(C,T)&&(v=Object.assign(x,new Be.value[E](...c)));return}if(v.type==="BufferGeometry"){if(f==="args")return;v.setAttribute(ue(f),new Xt(...c));return}if(f.includes("-")&&g===void 0){const x=f.split("-");g=x.reduce((C,T)=>C[ue(T)],v),f=x.pop(),P=f,g!=null&&g.set||(v=x.reduce((C,T)=>C[ue(T)],v))}let b=c;if(b===""&&(b=!0),q(g)){ot.includes(d)||(he(b)?s[P](...b):s[P](b)),P.startsWith("on")&&q(b)&&(v[P]=b);return}!(g!=null&&g.set)&&!q(g)?v[P]=b:g.constructor===b.constructor&&g!=null&&g.copy?g?.copy(b):he(b)?g.set(...b):!g.isColor&&g.setScalar?g.setScalar(b):g.set(b),wt(s)}function i(s){var d;return((d=s?.__tres)==null?void 0:d.parent)||null}function l(s){const d=Y(new Jt,{type:"Comment"},e);return d.name=s,d}function u(s){var d;const p=i(s),c=((d=p?.__tres)==null?void 0:d.objects)||[],m=c.indexOf(s);return m<0||m>=c.length-1?null:c[m+1]}return{insert:r,remove:o,createElement:n,patchProp:a,parentNode:i,createText:()=>{},createComment:l,setText:()=>{},setElementText:()=>{},nextSibling:u,querySelector:()=>{},setScopeId:()=>{},cloneNode:()=>{},insertStaticContent:()=>{}}};function Hr(){return Mt().__VUE_DEVTOOLS_GLOBAL_HOOK__}function Mt(){return typeof navigator<"u"&&typeof window<"u"?window:typeof globalThis<"u"?globalThis:{}}const Gr=typeof Proxy=="function",Yr="devtools-plugin:setup",qr="plugin:settings:set";let Z,Re;function Qr(){var e;return Z!==void 0||(typeof window<"u"&&window.performance?(Z=!0,Re=window.performance):typeof globalThis<"u"&&!((e=globalThis.perf_hooks)===null||e===void 0)&&e.performance?(Z=!0,Re=globalThis.perf_hooks.performance):Z=!1),Z}function Jr(){return Qr()?Re.now():Date.now()}class Xr{constructor(t,n){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=t,this.hook=n;const r={};if(t.settings)for(const i in t.settings){const l=t.settings[i];r[i]=l.defaultValue}const o=`__vue-devtools-plugin-settings__${t.id}`;let a=Object.assign({},r);try{const i=localStorage.getItem(o),l=JSON.parse(i);Object.assign(a,l)}catch{}this.fallbacks={getSettings(){return a},setSettings(i){try{localStorage.setItem(o,JSON.stringify(i))}catch{}a=i},now(){return Jr()}},n&&n.on(qr,(i,l)=>{i===this.plugin.id&&this.fallbacks.setSettings(l)}),this.proxiedOn=new Proxy({},{get:(i,l)=>this.target?this.target.on[l]:(...u)=>{this.onQueue.push({method:l,args:u})}}),this.proxiedTarget=new Proxy({},{get:(i,l)=>this.target?this.target[l]:l==="on"?this.proxiedOn:Object.keys(this.fallbacks).includes(l)?(...u)=>(this.targetQueue.push({method:l,args:u,resolve:()=>{}}),this.fallbacks[l](...u)):(...u)=>new Promise(s=>{this.targetQueue.push({method:l,args:u,resolve:s})})})}async setRealTarget(t){this.target=t;for(const n of this.onQueue)this.target.on[n.method](...n.args);for(const n of this.targetQueue)n.resolve(await this.target[n.method](...n.args))}}function Kr(e,t){const n=e,r=Mt(),o=Hr(),a=Gr&&n.enableEarlyProxy;if(o&&(r.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__||!a))o.emit(Yr,e,t);else{const i=a?new Xr(n,o):null;(r.__VUE_DEVTOOLS_PLUGINS__=r.__VUE_DEVTOOLS_PLUGINS__||[]).push({pluginDescriptor:n,setupFn:t,proxy:i}),i&&t(i.proxiedTarget)}}function Zr(e,t){const n=`▲ ■ ●${e}`;typeof st=="function"?st(n,t):console.log(n)}function st(e,t){throw new Error(e+t)}const xt=e=>{const t={id:e.uuid,label:e.type,children:[],tags:[]};e.name!==""&&t.tags.push({label:e.name,textColor:5750629,backgroundColor:15793395});const n=Ne(e);return n>0&&t.tags.push({label:`${Sr(n)} KB`,textColor:15707189,backgroundColor:16775644,tooltip:"Memory usage"}),e.type.includes("Light")&&(sr(e)&&t.tags.push({label:`${e.intensity}`,textColor:9738662,backgroundColor:16316922,tooltip:"Intensity"}),t.tags.push({label:`#${new ne(e.color).getHexString()}`,textColor:9738662,backgroundColor:16316922,tooltip:"Color"})),e.type.includes("Camera")&&(t.tags.push({label:`${e.fov}°`,textColor:9738662,backgroundColor:16316922,tooltip:"Field of view"}),t.tags.push({label:`x: ${Math.round(e.position.x)} y: ${Math.round(e.position.y)} z: ${Math.round(e.position.z)}`,textColor:9738662,backgroundColor:16316922,tooltip:"Position"})),t};function Tt(e,t,n=""){e.children.forEach(r=>{if(r.type==="HightlightMesh"||n&&!r.type.includes(n)&&!r.name.includes(n))return;const o=xt(r);t.children.push(o),Tt(r,o,n)})}const eo=[],ee="tres:inspector",to=at({sceneGraph:null});function no(e,t){Kr({id:"dev.esm.tres",label:"TresJS 🪐",logo:"https://raw.githubusercontent.com/Tresjs/tres/main/public/favicon.svg",packageName:"tresjs",homepage:"https://tresjs.org",componentStateTypes:eo,app:e},n=>{typeof n.now!="function"&&Zr("You seem to be using an outdated version of Vue Devtools. Are you still using the Beta release instead of the stable one? You can find the links at https://devtools.vuejs.org/guide/installation.html."),n.addInspector({id:ee,label:"TresJS 🪐",icon:"account_tree",treeFilterPlaceholder:"Search instances"}),setInterval(()=>{n.sendInspectorTree(ee)},1e3),setInterval(()=>{n.notifyComponentUpdate()},5e3),n.on.getInspectorTree(a=>{if(a.inspectorId===ee){const i=xt(t.scene.value);Tt(t.scene.value,i,a.filter),to.sceneGraph=i,a.rootNodes=[i]}});let r=null,o=null;n.on.getInspectorState(a=>{var i;if(a.inspectorId===ee){const[l]=t.scene.value.getObjectsByProperty("uuid",a.nodeId);if(!l)return;if(o&&r&&r.parent&&o.remove(r),l.isMesh){const u=gr(l);l.add(u),r=u,o=l}a.state={object:Object.entries(l).map(([u,s])=>u==="children"?{key:u,value:s.filter(d=>d.type!=="HightlightMesh")}:{key:u,value:s,editable:!0}).filter(({key:u})=>u!=="parent")},l.isScene&&(a.state.info={objects:l.children.length,memory:Ne(l),calls:t.renderer.value.info.render.calls,triangles:t.renderer.value.info.render.triangles,points:t.renderer.value.info.render.points,lines:t.renderer.value.info.render.lines},a.state.programs=((i=t.renderer.value.info.programs)==null?void 0:i.map(u=>({key:u.name,value:{...u,vertexShader:u.vertexShader,attributes:u.getAttributes(),uniforms:u.getUniforms()}})))||[])}}),n.on.editInspectorState(a=>{a.inspectorId===ee&&hr(t.scene.value,a.nodeId,a.path,a.state.value)})})}const ro=["data-scene","data-tres"],oo=Oe({__name:"TresCanvas",props:{shadows:{type:Boolean,default:void 0},clearColor:{},toneMapping:{},shadowMapType:{},useLegacyLights:{type:Boolean,default:void 0},outputColorSpace:{},toneMappingExposure:{},renderMode:{default:"always"},dpr:{},camera:{},preset:{},windowSize:{type:Boolean,default:void 0},enableProvideBridge:{type:Boolean,default:!0},context:{},alpha:{type:Boolean,default:void 0},premultipliedAlpha:{type:Boolean},antialias:{type:Boolean,default:void 0},stencil:{type:Boolean,default:void 0},preserveDrawingBuffer:{type:Boolean,default:void 0},powerPreference:{},depth:{type:Boolean,default:void 0},failIfMajorPerformanceCaveat:{type:Boolean,default:void 0},precision:{},logarithmicDepthBuffer:{type:Boolean,default:void 0},reverseDepthBuffer:{type:Boolean}},emits:["render","click","double-click","context-menu","pointer-move","pointer-up","pointer-down","pointer-enter","pointer-leave","pointer-over","pointer-out","pointer-missed","wheel","ready"],setup(e,{expose:t,emit:n}){const r=e,o=n,a=Rt(),{logWarning:i}=Ue(),l=M(),u=F(new ct),s=oe();De(tn);const d=(v,f=!1)=>Oe({setup(){var P;const g=(P=oe())==null?void 0:P.appContext;g&&(g.app=s?.appContext.app);const b={};function x(C){C&&(C.parent&&x(C.parent),C.provides&&Object.assign(b,C.provides))}return s!=null&&s.parent&&r.enableProvideBridge&&(x(s.parent),Reflect.ownKeys(b).forEach(C=>{de(C,b[C])})),de("useTres",v),de("extend",De),typeof window<"u"&&no(g?.app,v),()=>te(Ut,null,f?[]:a.default())}}),p=(v,f=!1)=>{const P=d(v,f),{render:g}=$t(Wr(v));g(te(P),u.value)},c=(v,f=!1)=>{bt(v.scene.value),f&&(v.renderer.value.dispose(),v.renderer.value.renderLists.dispose(),v.renderer.value.forceContextLoss()),u.value.__tres={root:v}},m=F(null);t({context:m,dispose:()=>c(m.value,!0)});const _=()=>{c(m.value),p(m.value,!0)};return se(()=>{const v=l;m.value=zr({scene:u.value,canvas:v,windowSize:r.windowSize??!1,rendererOptions:r,emit:o});const{registerCamera:f,camera:P,cameras:g,deregisterCamera:b}=m.value;p(m.value);const x=()=>{const C=new Se(45,window.innerWidth/window.innerHeight,.1,1e3);C.position.set(3,3,3),C.lookAt(0,0,0),f(C);const T=ye(()=>{g.value.length>=2&&(C.removeFromParent(),b(C),T?.())})};D(()=>r.camera,(C,T)=>{C&&f(C),T&&(T.removeFromParent(),b(T))},{immediate:!0}),P.value||(i("No camera found. Creating a default perspective camera. To have full control over a camera, please add one to the scene."),x())}),J(_),(v,f)=>(me(),it("canvas",{ref_key:"canvas",ref:l,"data-scene":u.value.uuid,class:zt(v.$attrs.class),"data-tres":`tresjs ${H(er).version}`,style:Ft({display:"block",width:"100%",height:"100%",position:v.windowSize?"fixed":"relative",top:0,left:0,pointerEvents:"auto",touchAction:"none",...v.$attrs.style})},null,14,ro))}}),so=Oe({__name:"TresCanvas.client",setup(e){return(t,n)=>(me(),lt(H(oo),null,{default:ut(()=>[Vt(t.$slots,"default")]),_:3}))}}),io=un(so),ao=["args"],vo={__name:"with-react-well",setup(e){qe({TextGeometry:ln}),qe({OrbitControls:an});const t=at({clearColor:"#201919",shadows:!0,alpha:!1,shadowMapType:sn,toneMapping:dt});return(n,r)=>{const o=io;return me(),lt(o,Wt(Ht(t)),{default:ut(()=>[r[0]||(r[0]=Ce("TresMesh",null,[Ce("TresTextGeometry",{args:["TresJS"],center:""})],-1)),r[1]||(r[1]=Ce("TresPerspectiveCamera",{position:[11,11,11],fov:45,near:.1,far:1e3,"look-at":[-8,3,-3]},null,-1)),n.renderer?(me(),it("TresOrbitControls",{key:0,args:[n.camera,n.renderer?.domElement]},null,8,ao)):Gt("",!0)]),_:1,__:[0,1]},16)}}};export{vo as default};
